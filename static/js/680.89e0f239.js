(self["webpackChunkprodect"]=self["webpackChunkprodect"]||[]).push([[680],{3723:function(e,t,i){i(4114),
/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */
function(t,i){e.exports=i()}(0,(function(){return function(){var e={686:function(e,t,i){"use strict";i.d(t,{default:function(){return I}});var n=i(279),o=i.n(n),s=i(370),a=i.n(s),r=i(817),l=i.n(r);function c(e){try{return document.execCommand(e)}catch(t){return!1}}var d=function(e){var t=l()(e);return c("cut"),t},u=d;function p(e){var t="rtl"===document.documentElement.getAttribute("dir"),i=document.createElement("textarea");i.style.fontSize="12pt",i.style.border="0",i.style.padding="0",i.style.margin="0",i.style.position="absolute",i.style[t?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;return i.style.top="".concat(n,"px"),i.setAttribute("readonly",""),i.value=e,i}var h=function(e,t){var i=p(e);t.container.appendChild(i);var n=l()(i);return c("copy"),i.remove(),n},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:document.body},i="";return"string"===typeof e?i=h(e,t):e instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(null===e||void 0===e?void 0:e.type)?i=h(e.value,t):(i=l()(e),c("copy")),i},g=m;function f(e){return f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}var y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.action,i=void 0===t?"copy":t,n=e.container,o=e.target,s=e.text;if("copy"!==i&&"cut"!==i)throw new Error('Invalid "action" value, use either "copy" or "cut"');if(void 0!==o){if(!o||"object"!==f(o)||1!==o.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===i&&o.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===i&&(o.hasAttribute("readonly")||o.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}return s?g(s,{container:n}):o?"cut"===i?u(o):g(o,{container:n}):void 0},b=y;function v(e){return v="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function L(e,t,i){return t&&w(e.prototype,t),i&&w(e,i),e}function x(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}function M(e,t){return M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},M(e,t)}function _(e){var t=S();return function(){var i,n=A(e);if(t){var o=A(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return F(this,i)}}function F(e,t){return!t||"object"!==v(t)&&"function"!==typeof t?C(e):t}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}function E(e,t){var i="data-clipboard-".concat(e);if(t.hasAttribute(i))return t.getAttribute(i)}var T=function(e){x(i,e);var t=_(i);function i(e,n){var o;return k(this,i),o=t.call(this),o.resolveOptions(n),o.listenClick(e),o}return L(i,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"===typeof e.action?e.action:this.defaultAction,this.target="function"===typeof e.target?e.target:this.defaultTarget,this.text="function"===typeof e.text?e.text:this.defaultText,this.container="object"===v(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=a()(e,"click",(function(e){return t.onClick(e)}))}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget,i=this.action(t)||"copy",n=b({action:i,container:this.container,target:this.target(t),text:this.text(t)});this.emit(n?"success":"error",{action:i,text:n,trigger:t,clearSelection:function(){t&&t.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(e){return E("action",e)}},{key:"defaultTarget",value:function(e){var t=E("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return E("text",e)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:document.body};return g(e,t)}},{key:"cut",value:function(e){return u(e)}},{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"===typeof e?[e]:e,i=!!document.queryCommandSupported;return t.forEach((function(e){i=i&&!!document.queryCommandSupported(e)})),i}}]),i}(o()),I=T},828:function(e){var t=9;if("undefined"!==typeof Element&&!Element.prototype.matches){var i=Element.prototype;i.matches=i.matchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector||i.webkitMatchesSelector}function n(e,i){while(e&&e.nodeType!==t){if("function"===typeof e.matches&&e.matches(i))return e;e=e.parentNode}}e.exports=n},438:function(e,t,i){var n=i(828);function o(e,t,i,n,o){var s=a.apply(this,arguments);return e.addEventListener(i,s,o),{destroy:function(){e.removeEventListener(i,s,o)}}}function s(e,t,i,n,s){return"function"===typeof e.addEventListener?o.apply(null,arguments):"function"===typeof i?o.bind(null,document).apply(null,arguments):("string"===typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,(function(e){return o(e,t,i,n,s)})))}function a(e,t,i,o){return function(i){i.delegateTarget=n(i.target,t),i.delegateTarget&&o.call(e,i)}}e.exports=s},879:function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var i=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===i||"[object HTMLCollection]"===i)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"===typeof e||e instanceof String},t.fn=function(e){var t=Object.prototype.toString.call(e);return"[object Function]"===t}},370:function(e,t,i){var n=i(879),o=i(438);function s(e,t,i){if(!e&&!t&&!i)throw new Error("Missing required arguments");if(!n.string(t))throw new TypeError("Second argument must be a String");if(!n.fn(i))throw new TypeError("Third argument must be a Function");if(n.node(e))return a(e,t,i);if(n.nodeList(e))return r(e,t,i);if(n.string(e))return l(e,t,i);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function a(e,t,i){return e.addEventListener(t,i),{destroy:function(){e.removeEventListener(t,i)}}}function r(e,t,i){return Array.prototype.forEach.call(e,(function(e){e.addEventListener(t,i)})),{destroy:function(){Array.prototype.forEach.call(e,(function(e){e.removeEventListener(t,i)}))}}}function l(e,t,i){return o(document.body,e,t,i)}e.exports=s},817:function(e){function t(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var i=e.hasAttribute("readonly");i||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),i||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var n=window.getSelection(),o=document.createRange();o.selectNodeContents(e),n.removeAllRanges(),n.addRange(o),t=n.toString()}return t}e.exports=t},279:function(e){function t(){}t.prototype={on:function(e,t,i){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:i}),this},once:function(e,t,i){var n=this;function o(){n.off(e,o),t.apply(i,arguments)}return o._=t,this.on(e,o,i)},emit:function(e){var t=[].slice.call(arguments,1),i=((this.e||(this.e={}))[e]||[]).slice(),n=0,o=i.length;for(n;n<o;n++)i[n].fn.apply(i[n].ctx,t);return this},off:function(e,t){var i=this.e||(this.e={}),n=i[e],o=[];if(n&&t)for(var s=0,a=n.length;s<a;s++)n[s].fn!==t&&n[s].fn._!==t&&o.push(n[s]);return o.length?i[e]=o:delete i[e],this}},e.exports=t,e.exports.TinyEmitter=t}},t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={exports:{}};return e[n](o,o.exports,i),o.exports}return function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),i(686)}().default}))},2680:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return vc}});i(4114);var n=i(6768),o=i(4232),s=i(144),a=i(5130),r=(i(4603),i(7566),i(8721),i(777));const l=(0,r.nY)("useMeshEditStore",{state:()=>({modelApi:{},selectMesh:{},dragType:""}),getters:{selectMeshUuid:e=>e.selectMesh.uuid},actions:{setModelApi(e){this.modelApi=e},selectMeshAction(e){this.selectMesh=e},changeDragType(e){this.dragType=e}}});(0,r.nY)("useIndexedDBStore",{state:()=>({db:{}}),getters:{},actions:{setDbApi(e){this.db=e}}});var c=i(4844),d=i(4607),u=i(3785),p=i(1219);const h=e=>((0,n.Qi)("data-v-b3d89890"),e=e(),(0,n.jt)(),e),m={class:"edit-box"},g={class:"header"},f=h((()=>(0,n.Lk)("span",null,"背景",-1))),y={class:"icon-name"},b=h((()=>(0,n.Lk)("span",null," 图片",-1))),v={class:"action-txt"},k={class:"check"},w={class:"icon-name"},L=h((()=>(0,n.Lk)("span",null," 颜色",-1))),x={class:"action"},M={class:"check"},_={class:"icon-name"},F=h((()=>(0,n.Lk)("span",null," 全景图",-1))),C={class:"action-txt"},S={class:"check"},A={class:"option"},E={class:"icon-name"},T=h((()=>(0,n.Lk)("span",null,"外部资源",-1))),I={class:"texture-add"},R={class:"icon"},V=h((()=>(0,n.Lk)("span",null,"加载外部全景图",-1))),P={class:"options"},U={class:"option"},z={class:"grid-txt"},H={class:"grid-silder"},W={class:"option"},O={class:"grid-txt"},D={class:"grid-silder"};var G={__name:"EditBackground",setup(e,{expose:t}){const r=l(),h=(0,s.Kh)({visible:!0,type:3,image:i(2223),viewImg:i(4518),color:"#000",blurriness:1,intensity:1}),G=(0,s.KR)(!1),N=(0,s.KR)(3),B=(0,s.KR)(3),j=(0,n.EW)((()=>{const{visible:e}=h;return e?"":"disabled"})),X=c.yD,Y=e=>{switch(Object.assign(h,{type:e,intensity:1,blurriness:1}),e){case 1:r.modelApi.onSetSceneColor(h.color);break;case 2:r.modelApi.onSetSceneImage(h.image);break;case 3:r.modelApi.onSetSceneViewImage(h);break;default:break}},Q=({id:e,url:t})=>{h.image=t,N.value=e,r.modelApi.onSetSceneImage(t)},K=async({id:e,url:t})=>{try{G.value=!0,h.viewImg=t,B.value=e,await r.modelApi.onSetSceneViewImage(h)}finally{G.value=!1,p.nk.success("操作成功")}},Z=async e=>{const t=URL.createObjectURL(e.raw);await r.modelApi.onSetStorageViewImage(t,(0,u.ti)(e.name)),URL.revokeObjectURL(t),p.nk.success("操作成功")},q=e=>{h.color=e,r.modelApi.onSetSceneColor(h.color)},$=()=>{r.modelApi.onSetSceneColor(h.color)},J=()=>{r.modelApi.onSetSceneViewConfig(h)},ee=()=>{const{type:e,visible:t,image:i,viewImg:n}=h;if(!t)return r.modelApi.onSetSceneColor("#000");switch(e){case 1:r.modelApi.onSetSceneColor(h.color);break;case 2:r.modelApi.onSetSceneImage(i);break;case 3:r.modelApi.onSetSceneViewImage(h);break;default:break}};return t({config:h}),(e,t)=>{const i=(0,n.g2)("el-switch"),r=(0,n.g2)("Picture"),l=(0,n.g2)("el-icon"),c=(0,n.g2)("el-space"),u=(0,n.g2)("el-button"),p=(0,n.g2)("Check"),te=(0,n.g2)("el-image"),ie=(0,n.g2)("el-col"),ne=(0,n.g2)("el-row"),oe=(0,n.g2)("el-scrollbar"),se=(0,n.g2)("DataAnalysis"),ae=(0,n.g2)("el-color-picker"),re=(0,n.g2)("CameraFilled"),le=(0,n.g2)("UploadFilled"),ce=(0,n.g2)("el-tooltip"),de=(0,n.g2)("el-upload"),ue=(0,n.g2)("el-slider"),pe=(0,n.gN)("zLoading");return(0,n.bo)(((0,n.uX)(),(0,n.CE)("div",m,[(0,n.Lk)("div",g,[f,(0,n.bF)(i,{modelValue:h.visible,"onUpdate:modelValue":t[0]||(t[0]=e=>h.visible=e),onChange:ee},null,8,["modelValue"])]),(0,n.Lk)("div",{class:(0,o.C4)(["options",j.value])},[(0,n.Lk)("div",{class:"option",onClick:t[1]||(t[1]=e=>Y(2))},[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",y,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(r)])),_:1}),b])),_:1})]),(0,n.Lk)("div",v,[(0,n.bF)(u,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("选择图片")])),_:1})]),(0,n.bo)((0,n.Lk)("div",k,[(0,n.bF)(l,{size:"20px",color:"#2a3ff6"},{default:(0,n.k6)((()=>[(0,n.bF)(p)])),_:1})],512),[[a.aG,2==h.type]])])),_:1})]),(0,n.bo)((0,n.bF)(oe,{"max-height":"250px"},{default:(0,n.k6)((()=>[(0,n.bF)(ne,null,{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,s.R1)(d._4),(e=>((0,n.uX)(),(0,n.Wv)(ie,{style:{textAlign:"center"},span:6,key:e.id},{default:(0,n.k6)((()=>[(0,n.bF)(te,{onClick:t=>Q(e),class:(0,o.C4)(["el-img",N.value==e.id?"active":""]),src:e.url,fit:"cover"},null,8,["onClick","class","src"])])),_:2},1024)))),128))])),_:1})])),_:1},512),[[a.aG,2==h.type]])],2),(0,n.Lk)("div",{class:(0,o.C4)(["options",j.value])},[(0,n.Lk)("div",{class:"option",onClick:t[3]||(t[3]=e=>Y(1))},[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",w,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(se)])),_:1}),L])),_:1})]),(0,n.Lk)("div",x,[(0,n.bF)(ae,{predefine:(0,s.R1)(X),onChange:$,onActiveChange:q,modelValue:h.color,"onUpdate:modelValue":t[2]||(t[2]=e=>h.color=e)},null,8,["predefine","modelValue"])]),(0,n.bo)((0,n.Lk)("div",M,[(0,n.bF)(l,{size:"20px",color:"#2a3ff6"},{default:(0,n.k6)((()=>[(0,n.bF)(p)])),_:1})],512),[[a.aG,1==h.type]])])),_:1})])],2),(0,n.Lk)("div",{class:(0,o.C4)(["options",j.value])},[(0,n.Lk)("div",{class:"option",onClick:t[4]||(t[4]=e=>Y(3))},[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",_,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(re)])),_:1}),F])),_:1})]),(0,n.Lk)("div",C,[(0,n.bF)(u,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("选择图片")])),_:1})]),(0,n.bo)((0,n.Lk)("div",S,[(0,n.bF)(l,{size:"20px",color:"#2a3ff6"},{default:(0,n.k6)((()=>[(0,n.bF)(p)])),_:1})],512),[[a.aG,3==h.type]])])),_:1})]),(0,n.bo)((0,n.bF)(oe,{"max-height":"600px"},{default:(0,n.k6)((()=>[(0,n.bF)(ne,null,{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,s.R1)(d.HJ),(e=>((0,n.uX)(),(0,n.Wv)(ie,{span:6,style:{textAlign:"center"},key:e.id},{default:(0,n.k6)((()=>[(0,n.bF)(te,{onClick:t=>K(e),class:(0,o.C4)(["el-view",B.value==e.id?"active":""]),src:e.url,fit:"cover"},null,8,["onClick","class","src"])])),_:2},1024)))),128))])),_:1}),(0,n.bo)((0,n.bF)(ne,null,{default:(0,n.k6)((()=>[(0,n.bF)(ie,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",A,[(0,n.Lk)("div",E,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[T])),_:1})])])])),_:1}),(0,n.bF)(ie,{span:10,offset:4},{default:(0,n.k6)((()=>[(0,n.bF)(de,{action:"",accept:".jpg,.png,.hdr","show-file-list":!1,"auto-upload":!1,"on-change":Z},{default:(0,n.k6)((()=>[(0,n.Lk)("div",I,[(0,n.Lk)("div",R,[(0,n.bF)(ce,{effect:"dark",content:"该功能仅作预览，数据无法保存",placement:"top"},{default:(0,n.k6)((()=>[(0,n.bF)(l,{size:"60"},{default:(0,n.k6)((()=>[(0,n.bF)(le)])),_:1})])),_:1}),V])])])),_:1})])),_:1})])),_:1},512),[[a.aG,3==h.type]]),(0,n.bo)((0,n.bF)(ne,null,{default:(0,n.k6)((()=>[(0,n.bF)(ie,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",P,[(0,n.Lk)("div",U,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",z,[(0,n.bF)(u,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("强度")])),_:1})])])),_:1}),(0,n.Lk)("div",H,[(0,n.bF)(ue,{"show-input":"",onInput:J,modelValue:h.intensity,"onUpdate:modelValue":t[5]||(t[5]=e=>h.intensity=e),min:0,max:1,step:.01},null,8,["modelValue"])])]),(0,n.Lk)("div",W,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",O,[(0,n.bF)(u,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)(" 模糊")])),_:1})])])),_:1}),(0,n.Lk)("div",D,[(0,n.bF)(ue,{"show-input":"",onInput:J,modelValue:h.blurriness,"onUpdate:modelValue":t[6]||(t[6]=e=>h.blurriness=e),min:0,max:1,step:.01},null,8,["modelValue"])])])])])),_:1})])),_:1},512),[[a.aG,3==h.type]])])),_:1},512),[[a.aG,3==h.type]])],2)])),[[pe,G.value]])}}},N=i(1241);const B=(0,N.A)(G,[["__scopeId","data-v-b3d89890"]]);var j=B,X=i(8776);const Y=e=>((0,n.Qi)("data-v-5a46db3f"),e=e(),(0,n.jt)(),e),Q={class:"edit-box"},K={class:"header"},Z=Y((()=>(0,n.Lk)("span",null,"材质类型",-1))),q={class:"options"},$={class:"option"},J=Y((()=>(0,n.Lk)("span",null,"当前材质类型：",-1))),ee=Y((()=>(0,n.Lk)("div",{class:"header"},[(0,n.Lk)("span",null,"材质")],-1))),te={class:"options"},ie=["onClick"],ne={class:"icon-name"},oe={class:"check"},se=Y((()=>(0,n.Lk)("div",{class:"header"},"材质属性",-1))),ae={class:"option space-between"},re={class:"option"},le={class:"grid-txt"},ce={class:"grid-silder"},de=Y((()=>(0,n.Lk)("div",{class:"header"},"当前材质自带贴图",-1))),ue={class:"options"},pe={key:0,class:"select"},he=Y((()=>(0,n.Lk)("div",{class:"header"},"系统贴图",-1))),me=["onClick"],ge={key:0,class:"select"};var fe={__name:"EditMaterial",setup(e,{expose:t}){const i=l(),{$bus:r}=(0,n.nI)().proxy,h=(0,s.Kh)({meshName:null,color:null,wireframe:!1,depthWrite:!0,opacity:1}),m=(0,s.KR)(!1),g=(0,s.KR)(""),f=(0,s.KR)(null),y=(0,s.KR)(null),b=(0,n.EW)((()=>{const e=v.modelMaterialList.find((e=>e.uuid==v.selectMeshUuid))||{};return e.uuid?"":"disabled"})),v=(0,s.Kh)({modelMaterialList:(0,n.EW)((()=>i.modelApi.modelMaterialList)),originalMaterials:(0,n.EW)((()=>i.modelApi.originalMaterials)),modelApi:(0,n.EW)((()=>i.modelApi)),selectMeshUuid:(0,n.EW)((()=>i.selectMeshUuid))});(0,n.sV)((()=>{r.on("model-update",(()=>{Object.assign(h,{color:null,wireframe:!1,depthWrite:!0,opacity:1})}))})),(0,n.wB)((()=>i.selectMeshUuid),(e=>{const t=v.modelMaterialList.find((t=>t.uuid==e))||{};if(y.value=t.mapId,t.mapId){const{color:e,wireframe:i,depthWrite:n,opacity:o}=t.material,s=new X.Color(e).getStyle();Object.assign(h,{color:s,wireframe:i,depthWrite:n,opacity:o});const a=v.originalMaterials.get(t.uuid);f.value={url:L(t),name:t.name,mapId:a.userData.mapId,material:t.material}}else f.value=null}));const k=e=>{const t=c.oX.find((t=>t.type==e));v.modelApi.onChangeModelMeshType(t)},w=e=>{const{name:t}=e;h.meshName=t;const i=v.modelApi.onChangeModelMeaterial(t),{color:n,wireframe:o,depthWrite:s,opacity:a}=i.material;Object.assign(h,{color:new X.Color(n).getStyle(),wireframe:o,depthWrite:s,opacity:a});const r=v.originalMaterials.get(e.uuid);f.value={url:L(e),name:e.name,mapId:e.mapId,material:r}},L=e=>{const t=v.originalMaterials.get(e.uuid),i=Array.isArray(t)?t:[t];let n;return i.forEach((e=>{if(e.map&&e.map.image){const t=document.createElement("canvas"),{width:i,height:o}=e.map.image;t.width=i,t.height=o;const s=t.getContext("2d");s.drawImage(e.map.image,0,0),n=t.toDataURL("image/png",.5),t.remove()}})),n},x=()=>{v.modelApi.onSetModelMaterial(h)},M=e=>{e.visible=!e.visible,v.modelApi.onSetMeshVisibe(e)},_=e=>{y.value=e.mapId,v.modelApi.onSetModelMap(e),p.nk.success("当前材质贴图修改成功")},F=async e=>{try{m.value=!0,y.value=e.id;const t=v.modelMaterialList.find((e=>e.uuid==i.selectMeshUuid))||{};t.mapId=e.id,v.modelApi.onSetSystemModelMap(e),p.nk.success("当前材质贴图修改成功")}finally{m.value=!1}},C=async e=>{const t=URL.createObjectURL(e.raw);await v.modelApi.onSetStorageModelMap(t,(0,u.ti)(e.name)),URL.revokeObjectURL(t),p.nk.success("当前材质贴图修改成功")},S=()=>{Object.assign(h,{meshName:null,color:"#fff",wireframe:!1,depthWrite:!0,opacity:1}),g.value="",y.value=null,v.modelApi.initModelMaterial()},A=()=>({materialType:g.value,meshList:v.modelApi.onGetEditMeshList()});return t({getMeshConfig:A}),(e,t)=>{const i=(0,n.g2)("el-button"),r=(0,n.g2)("el-option"),l=(0,n.g2)("el-select"),u=(0,n.g2)("el-space"),p=(0,n.g2)("View"),L=(0,n.g2)("el-icon"),A=(0,n.g2)("Hide"),E=(0,n.g2)("Check"),T=(0,n.g2)("el-scrollbar"),I=(0,n.g2)("el-color-picker"),R=(0,n.g2)("WarnTriangleFilled"),V=(0,n.g2)("el-tooltip"),P=(0,n.g2)("el-switch"),U=(0,n.g2)("el-slider"),z=(0,n.g2)("el-image"),H=(0,n.g2)("Select"),W=(0,n.g2)("el-col"),O=(0,n.g2)("el-upload"),D=(0,n.g2)("el-row"),G=(0,n.gN)("zLoading");return(0,n.bo)(((0,n.uX)(),(0,n.CE)("div",Q,[(0,n.Lk)("div",K,[Z,(0,n.bF)(i,{type:"primary",icon:"Refresh",onClick:S},{default:(0,n.k6)((()=>[(0,n.eW)(" 重置 ")])),_:1})]),(0,n.Lk)("div",q,[(0,n.Lk)("div",$,[(0,n.bF)(u,null,{default:(0,n.k6)((()=>[J,(0,n.bF)(l,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),onChange:k,placeholder:"请选择",size:"small",style:{width:"200px"}},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,s.R1)(c.oX),(e=>((0,n.uX)(),(0,n.Wv)(r,{key:e.type,label:`${e.type?e.type:""}(${e.describe})`,value:e.type},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])]),ee,(0,n.Lk)("div",te,[(0,n.bF)(T,{"max-height":"200px"},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(v.modelMaterialList,(e=>((0,n.uX)(),(0,n.CE)("div",{class:(0,o.C4)(["option",v.selectMeshUuid==e.uuid?"option-active":""]),onClick:(0,a.D$)((t=>w(e)),["stop"]),key:e.uuid},[(0,n.bF)(u,null,{default:(0,n.k6)((()=>[e.visible?((0,n.uX)(),(0,n.Wv)(L,{key:0,onClick:t=>M(e),size:"18",color:"#409eff"},{default:(0,n.k6)((()=>[(0,n.bF)(p)])),_:2},1032,["onClick"])):((0,n.uX)(),(0,n.Wv)(L,{key:1,size:"18",onClick:t=>M(e)},{default:(0,n.k6)((()=>[(0,n.bF)(A)])),_:2},1032,["onClick"])),(0,n.Lk)("div",ne,(0,o.v_)(e.name),1),(0,n.bo)((0,n.Lk)("div",oe,[(0,n.bF)(L,{size:"20px",color:"#2a3ff6"},{default:(0,n.k6)((()=>[(0,n.bF)(E)])),_:1})],512),[[a.aG,v.selectMeshUuid==e.uuid]])])),_:2},1024)],10,ie)))),128))])),_:1})]),se,(0,n.Lk)("div",{class:(0,o.C4)(["options",b.value])},[(0,n.Lk)("div",ae,[(0,n.bF)(u,null,{default:(0,n.k6)((()=>[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("材质颜色")])),_:1}),(0,n.bF)(I,{"color-format":"rgb",predefine:(0,s.R1)(c.yD),onChange:x,modelValue:h.color,"onUpdate:modelValue":t[1]||(t[1]=e=>h.color=e)},null,8,["predefine","modelValue"])])),_:1}),(0,n.bF)(u,null,{default:(0,n.k6)((()=>[(0,n.bF)(V,{effect:"dark",content:"注意：深度写入属性不支持模型“导出” ",placement:"top"},{default:(0,n.k6)((()=>[(0,n.bF)(L,null,{default:(0,n.k6)((()=>[(0,n.bF)(R,{size:20,color:"#ffb940"})])),_:1})])),_:1}),(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("深度写入")])),_:1}),(0,n.bF)(P,{onChange:x,modelValue:h.depthWrite,"onUpdate:modelValue":t[2]||(t[2]=e=>h.depthWrite=e)},null,8,["modelValue"])])),_:1}),(0,n.bF)(u,null,{default:(0,n.k6)((()=>[(0,n.bF)(V,{effect:"dark",content:"注意：网格属性不支持模型“导出” ",placement:"top"},{default:(0,n.k6)((()=>[(0,n.bF)(L,null,{default:(0,n.k6)((()=>[(0,n.bF)(R,{size:20,color:"#ffb940"})])),_:1})])),_:1}),(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("网格")])),_:1}),(0,n.bF)(P,{onChange:x,modelValue:h.wireframe,"onUpdate:modelValue":t[3]||(t[3]=e=>h.wireframe=e)},null,8,["modelValue"])])),_:1})]),(0,n.Lk)("div",re,[(0,n.Lk)("div",le,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("透明度 ")])),_:1})]),(0,n.Lk)("div",ce,[(0,n.bF)(U,{"show-input":"",onInput:x,onChange:x,modelValue:h.opacity,"onUpdate:modelValue":t[4]||(t[4]=e=>h.opacity=e),min:0,max:1,step:.01},null,8,["modelValue"])])])],2),de,(0,n.Lk)("div",ue,[(0,n.bF)(T,{"max-height":"140px"},{default:(0,n.k6)((()=>[(0,n.bF)(D,{justify:"center",align:"middle",style:{minHeight:"120px"}},{default:(0,n.k6)((()=>[f.value?((0,n.uX)(),(0,n.Wv)(W,{key:0,span:10,offse:4,style:{textAlign:"center"}},{default:(0,n.k6)((()=>[(0,n.Lk)("div",{onClick:t[5]||(t[5]=e=>_(f.value)),class:(0,o.C4)([y.value==f.value.mapId?"active":"","mesh-image"])},[(0,n.bF)(z,{src:f.value.url,class:"mesh-map",fit:"cover"},null,8,["src"]),y.value==f.value.mapId?((0,n.uX)(),(0,n.CE)("div",pe,[(0,n.bF)(L,{color:"#18c174",size:26},{default:(0,n.k6)((()=>[(0,n.bF)(H)])),_:1})])):(0,n.Q3)("",!0)],2)])),_:1})):(0,n.Q3)("",!0),f.value?((0,n.uX)(),(0,n.Wv)(W,{key:1,span:8,style:{textAlign:"center"}},{default:(0,n.k6)((()=>[(0,n.bF)(O,{action:"",accept:".jpg,.png,.hdr","show-file-list":!1,"auto-upload":!1,"on-change":C},{default:(0,n.k6)((()=>[(0,n.bF)(V,{effect:"dark",content:"该功能仅仅作预览，数据无法保存 ",placement:"top"},{default:(0,n.k6)((()=>[(0,n.bF)(i,{type:"primary",icon:"UploadFilled"},{default:(0,n.k6)((()=>[(0,n.eW)("加载外部贴图")])),_:1})])),_:1})])),_:1})])),_:1})):(0,n.Q3)("",!0)])),_:1})])),_:1})]),he,(0,n.Lk)("div",{class:(0,o.C4)(["options",b.value])},[(0,n.bF)(T,{"max-height":"230px"},{default:(0,n.k6)((()=>[(0,n.bF)(D,null,{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,s.R1)(d.M),(e=>((0,n.uX)(),(0,n.Wv)(W,{span:6,style:{textAlign:"center"},key:e.id},{default:(0,n.k6)((()=>[(0,n.Lk)("div",{onClick:t=>F(e),class:(0,o.C4)(["image-box",y.value==e.id?"active":""])},[(0,n.bF)(z,{src:e.url,class:"el-map",fit:"cover"},null,8,["src"]),y.value==e.id?((0,n.uX)(),(0,n.CE)("div",ge,[(0,n.bF)(L,{color:"#18c174",size:26},{default:(0,n.k6)((()=>[(0,n.bF)(H)])),_:1})])):(0,n.Q3)("",!0)],10,me)])),_:2},1024)))),128))])),_:1})])),_:1})],2)])),[[G,m.value]])}}};const ye=(0,N.A)(fe,[["__scopeId","data-v-5a46db3f"]]);var be=ye;const ve={class:"edit-box"},ke={class:"header"},we=(0,n.Lk)("span",null,"模型动画",-1),Le=["onClick"],xe={class:"icon-name"},Me={class:"check"},_e=(0,n.Lk)("div",{class:"header"},[(0,n.Lk)("span",null,"动画配置")],-1),Fe={class:"option"},Ce=(0,n.Lk)("span",null," 循环方式 ",-1),Se={class:"option"},Ae={class:"option"},Ee=(0,n.Lk)("span",null," 播放速度 ",-1),Te={class:"option"},Ie={class:"option"},Re=(0,n.Lk)("span",null," 动作幅度 ",-1),Ve={class:"option"},Pe={class:"header"},Ue=(0,n.Lk)("span",null,"轴动画",-1),ze={class:"options"},He=(0,n.Lk)("span",null," 轴方向 ",-1),We=(0,n.Lk)("span",null," 播放速度 ",-1);var Oe={__name:"EditAnimation",setup(e,{expose:t}){const i=l(),{$bus:r}=(0,n.nI)().proxy,c=(0,s.Kh)({visible:!1,animationName:null,loop:"LoopRepeat",timeScale:1,weight:1,rotationVisible:!1,rotationType:"y",rotationSpeed:1}),d=(0,n.EW)((()=>c.visible?"":"disabled")),u=(0,n.EW)((()=>c.rotationVisible?"":"disabled")),p=(0,s.Kh)({modelAnimation:(0,n.EW)((()=>i.modelApi?i.modelApi.modelAnimation:[]))});(0,n.sV)((()=>{p.modelAnimation.length&&(c.animationName=p.modelAnimation[0].name),r.on("model-update",(()=>{if(p.modelAnimation.length){const e=p.modelAnimation[0].name;c.animationName=e}Object.assign(c,{visible:!1,loop:"LoopRepeat",timeScale:1,weight:1,rotationVisible:!1,rotationType:"y",rotationSpeed:1})}))}));const h=()=>{const{visible:e}=c;e?g():i.modelApi.onClearAnimation()},m=({name:e})=>{c.animationName=e,i.modelApi.onStartModelAnimaion(c)},g=()=>{i.modelApi.onStartModelAnimaion(c)},f=()=>{i.modelApi.onSetRotation(c)},y=()=>{i.modelApi.onSetRotationType(c)};return t({config:c}),(e,t)=>{const i=(0,n.g2)("el-switch"),s=(0,n.g2)("Check"),r=(0,n.g2)("el-icon"),l=(0,n.g2)("el-space"),b=(0,n.g2)("el-scrollbar"),v=(0,n.g2)("el-empty"),k=(0,n.g2)("Switch"),w=(0,n.g2)("el-radio-button"),L=(0,n.g2)("el-radio-group"),x=(0,n.g2)("VideoPlay"),M=(0,n.g2)("el-slider"),_=(0,n.g2)("Sort");return(0,n.uX)(),(0,n.CE)("div",ve,[(0,n.Lk)("div",ke,[we,(0,n.bF)(i,{modelValue:c.visible,"onUpdate:modelValue":t[0]||(t[0]=e=>c.visible=e),onChange:h},null,8,["modelValue"])]),(0,n.Lk)("div",{class:(0,o.C4)(["options",d.value])},[p.modelAnimation.length?((0,n.uX)(),(0,n.Wv)(b,{key:0,"max-height":"250px"},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(p.modelAnimation,(e=>((0,n.uX)(),(0,n.CE)("div",{class:(0,o.C4)(["option",c.animationName==e.name?"option-active":""]),onClick:t=>m(e),key:e.name},[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",xe,(0,o.v_)(e.name),1),(0,n.bo)((0,n.Lk)("div",Me,[(0,n.bF)(r,{size:"20px",color:"#2a3ff6"},{default:(0,n.k6)((()=>[(0,n.bF)(s)])),_:1})],512),[[a.aG,c.animationName==e.name]])])),_:2},1024)],10,Le)))),128))])),_:1})):((0,n.uX)(),(0,n.Wv)(v,{key:1,description:"暂无动画","image-size":120}))],2),_e,(0,n.Lk)("div",{class:(0,o.C4)(["options",d.value])},[(0,n.Lk)("div",Fe,[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.bF)(k)])),_:1}),Ce])),_:1})]),(0,n.Lk)("div",Se,[(0,n.bF)(L,{modelValue:c.loop,"onUpdate:modelValue":t[1]||(t[1]=e=>c.loop=e),onChange:g},{default:(0,n.k6)((()=>[(0,n.bF)(w,{label:"LoopOnce"},{default:(0,n.k6)((()=>[(0,n.eW)("只执行一次")])),_:1}),(0,n.bF)(w,{label:"LoopRepeat"},{default:(0,n.k6)((()=>[(0,n.eW)("无限循环")])),_:1}),(0,n.bF)(w,{label:"LoopPingPong"},{default:(0,n.k6)((()=>[(0,n.eW)("来回循环")])),_:1})])),_:1},8,["modelValue"])]),(0,n.Lk)("div",Ae,[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.bF)(x)])),_:1}),Ee])),_:1})]),(0,n.Lk)("div",Te,[(0,n.bF)(M,{"show-input":"",modelValue:c.timeScale,"onUpdate:modelValue":t[2]||(t[2]=e=>c.timeScale=e),onChange:g,step:.01,min:0,max:1},null,8,["modelValue"])]),(0,n.Lk)("div",Ie,[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.bF)(_)])),_:1}),Re])),_:1})]),(0,n.Lk)("div",Ve,[(0,n.bF)(M,{"show-input":"",modelValue:c.weight,"onUpdate:modelValue":t[3]||(t[3]=e=>c.weight=e),onChange:g,step:.01,min:0,max:1},null,8,["modelValue"])])],2),(0,n.Lk)("div",Pe,[Ue,(0,n.bF)(i,{modelValue:c.rotationVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>c.rotationVisible=e),onChange:f},null,8,["modelValue"])]),(0,n.Lk)("div",ze,[(0,n.Lk)("div",{class:(0,o.C4)(["option",u.value])},[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[He,(0,n.bF)(L,{modelValue:c.rotationType,"onUpdate:modelValue":t[5]||(t[5]=e=>c.rotationType=e),onChange:y},{default:(0,n.k6)((()=>[(0,n.bF)(w,{label:"x"},{default:(0,n.k6)((()=>[(0,n.eW)("X轴")])),_:1}),(0,n.bF)(w,{label:"y"},{default:(0,n.k6)((()=>[(0,n.eW)("Y轴")])),_:1}),(0,n.bF)(w,{label:"z"},{default:(0,n.k6)((()=>[(0,n.eW)("Z轴")])),_:1})])),_:1},8,["modelValue"])])),_:1})],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",u.value])},[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.bF)(x)])),_:1}),We])),_:1})],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",u.value])},[(0,n.bF)(M,{onInput:f,"show-input":"",modelValue:c.rotationSpeed,"onUpdate:modelValue":t[6]||(t[6]=e=>c.rotationSpeed=e),step:.01,min:1,max:10},null,8,["modelValue"])],2)])])}}};const De=Oe;var Ge=De;const Ne={class:"edit-box"},Be={class:"header"},je=(0,n.Lk)("span",null,"辅助线/轴配置",-1),Xe={class:"option space-between"},Ye=(0,n.Lk)("span",null," 模型轴旋转 ",-1),Qe={class:"option"},Ke={class:"option"},Ze={class:"option"},qe={class:"option space-between"},$e=(0,n.Lk)("span",null," 模型位置 ",-1),Je={class:"option"},et={class:"grid-txt"},tt={class:"grid-silder"},it={class:"option"},nt={class:"grid-txt"},ot={class:"grid-silder"},st={class:"option"},at={class:"grid-txt"},rt={class:"grid-silder"},lt={class:"option space-between"},ct=(0,n.Lk)("span",null," 模型骨架 ",-1),dt={class:"option space-between"},ut=(0,n.Lk)("span",null," 网格辅助线 ",-1),pt={class:"option"},ht={class:"grid-txt"},mt={class:"grid-silder"},gt={class:"option"},ft={class:"grid-txt"},yt={class:"grid-silder"},bt={class:"option"},vt={class:"grid-txt"},kt={class:"grid-silder"},wt={class:"option"},Lt={class:"option"},xt={class:"option space-between"},Mt=(0,n.Lk)("span",null," 坐标轴辅助线 ",-1),_t={class:"grid-txt"},Ft={class:"grid-silder"};var Ct={__name:"EditAttribute",setup(e,{expose:t}){const i=l(),{$bus:a}=(0,n.nI)().proxy,r=(0,s.Kh)({visible:!0,skeletonHelper:!1,gridHelper:!1,x:0,y:-.59,z:-.1,positionX:0,positionY:-1,positionZ:0,divisions:18,size:6,color:"rgb(193,193,193)",axesHelper:!1,axesSize:1.8}),d=c.yD,u=(0,n.EW)((()=>r.visible?"":"disabled")),p=(0,n.EW)((()=>{const{visible:e,gridHelper:t}=r;return t&&e?"":"disabled"})),h=(0,n.EW)((()=>{const{visible:e,axesHelper:t}=r;return t&&e?"":"disabled"}));(0,n.sV)((()=>{a.on("model-update",(()=>{Object.assign(r,{visible:!0,skeletonHelper:!1,gridHelper:!1,x:0,y:-.59,z:-.1,positionX:0,positionY:-1,positionZ:0,divisions:18,size:6,color:"rgb(193,193,193)",axesHelper:!1,axesSize:1.8})}))}));const m=()=>{},g=(e,t)=>{const n="right"==t;i.modelApi.onSetModelRotateOnAxis(e,n)},f=()=>{i.modelApi.onResultModelRotateOnAxis()},y=()=>{i.modelApi.onSetModelPosition(r)},b=()=>{r.positionX=0,r.positionY=-1,r.positionZ=0,i.modelApi.onResultModelPosition(r)},v=()=>{i.modelApi.onSetModelHelper(r.skeletonHelper)},k=e=>{r.color=e,i.modelApi.onSetModelGridHelper(r)},w=()=>{i.modelApi.onSetModelGridHelper(r)},L=()=>{i.modelApi.onSetModelGridHelperSize(r)},x=()=>{i.modelApi.onSetModelAxesHelper(r)},M=()=>{const{x:e,y:t,z:n}=i.modelApi.model.rotation;let o=e,s=t,a=n;return{...r,rotationX:o,rotationY:s,rotationZ:a}};return t({getAttrbuteConfig:M}),(e,t)=>{const i=(0,n.g2)("el-switch"),a=(0,n.g2)("Setting"),l=(0,n.g2)("el-icon"),c=(0,n.g2)("el-space"),M=(0,n.g2)("el-button"),_=(0,n.g2)("Location"),F=(0,n.g2)("el-slider"),C=(0,n.g2)("Eleme"),S=(0,n.g2)("Grid"),A=(0,n.g2)("el-input-number"),E=(0,n.g2)("el-color-picker"),T=(0,n.g2)("Rank");return(0,n.uX)(),(0,n.CE)("div",Ne,[(0,n.Lk)("div",Be,[je,(0,n.bF)(i,{modelValue:r.visible,"onUpdate:modelValue":t[0]||(t[0]=e=>r.visible=e),onChange:m},null,8,["modelValue"])]),(0,n.Lk)("div",{class:(0,o.C4)(["options",u.value])},[(0,n.Lk)("div",Xe,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(a)])),_:1}),Ye])),_:1}),(0,n.bF)(M,{type:"primary",link:"",icon:"Refresh",onClick:f},{default:(0,n.k6)((()=>[(0,n.eW)(" 重置 ")])),_:1})]),(0,n.Lk)("div",Qe,[(0,n.bF)(M,{type:"info",icon:"RefreshRight",onClick:t[1]||(t[1]=e=>g("x","right"))}),(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("X轴")])),_:1}),(0,n.bF)(M,{type:"info",icon:"RefreshLeft",onClick:t[2]||(t[2]=e=>g("x","left"))})]),(0,n.Lk)("div",Ke,[(0,n.bF)(M,{type:"info",icon:"RefreshRight",onClick:t[3]||(t[3]=e=>g("y","right"))}),(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("Y轴")])),_:1}),(0,n.bF)(M,{type:"info",icon:"RefreshLeft",onClick:t[4]||(t[4]=e=>g("y","left"))})]),(0,n.Lk)("div",Ze,[(0,n.bF)(M,{type:"info",icon:"RefreshRight",onClick:t[5]||(t[5]=e=>g("z","right"))}),(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("Z轴")])),_:1}),(0,n.bF)(M,{type:"info",icon:"RefreshLeft",onClick:t[6]||(t[6]=e=>g("z","left"))})]),(0,n.Lk)("div",qe,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(_)])),_:1}),$e])),_:1}),(0,n.bF)(M,{type:"primary",link:"",icon:"Refresh",onClick:b},{default:(0,n.k6)((()=>[(0,n.eW)(" 重置 ")])),_:1})]),(0,n.Lk)("div",Je,[(0,n.Lk)("div",et,[(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("X 轴")])),_:1})]),(0,n.Lk)("div",tt,[(0,n.bF)(F,{onInput:y,"show-input":"",modelValue:r.positionX,"onUpdate:modelValue":t[7]||(t[7]=e=>r.positionX=e),min:-10,max:10,step:.1},null,8,["modelValue"])])]),(0,n.Lk)("div",it,[(0,n.Lk)("div",nt,[(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("Y 轴")])),_:1})]),(0,n.Lk)("div",ot,[(0,n.bF)(F,{onInput:y,"show-input":"",modelValue:r.positionY,"onUpdate:modelValue":t[8]||(t[8]=e=>r.positionY=e),min:-10,max:10,step:.1},null,8,["modelValue"])])]),(0,n.Lk)("div",st,[(0,n.Lk)("div",at,[(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("Z 轴")])),_:1})]),(0,n.Lk)("div",rt,[(0,n.bF)(F,{onInput:y,"show-input":"",modelValue:r.positionZ,"onUpdate:modelValue":t[9]||(t[9]=e=>r.positionZ=e),min:-10,max:10,step:.1},null,8,["modelValue"])])]),(0,n.Lk)("div",lt,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(C)])),_:1}),ct])),_:1}),(0,n.bF)(i,{modelValue:r.skeletonHelper,"onUpdate:modelValue":t[10]||(t[10]=e=>r.skeletonHelper=e),onChange:v},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["options",u.value])},[(0,n.Lk)("div",dt,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(S)])),_:1}),ut])),_:1}),(0,n.bF)(i,{modelValue:r.gridHelper,"onUpdate:modelValue":t[11]||(t[11]=e=>r.gridHelper=e),onChange:w},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["options",p.value])},[(0,n.Lk)("div",pt,[(0,n.Lk)("div",ht,[(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("X 轴")])),_:1})]),(0,n.Lk)("div",mt,[(0,n.bF)(F,{"show-input":"",onInput:w,modelValue:r.x,"onUpdate:modelValue":t[12]||(t[12]=e=>r.x=e),min:-2,max:4,step:.01},null,8,["modelValue"])])]),(0,n.Lk)("div",gt,[(0,n.Lk)("div",ft,[(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("Y 轴")])),_:1})]),(0,n.Lk)("div",yt,[(0,n.bF)(F,{"show-input":"",onInput:w,modelValue:r.y,"onUpdate:modelValue":t[13]||(t[13]=e=>r.y=e),min:-2,max:4,step:.01},null,8,["modelValue"])])]),(0,n.Lk)("div",bt,[(0,n.Lk)("div",vt,[(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("Z 轴")])),_:1})]),(0,n.Lk)("div",kt,[(0,n.bF)(F,{"show-input":"",onInput:w,modelValue:r.z,"onUpdate:modelValue":t[14]||(t[14]=e=>r.z=e),min:-2,max:4,step:.01},null,8,["modelValue"])])]),(0,n.Lk)("div",wt,[(0,n.Lk)("div",null,[(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("大小")])),_:1}),(0,n.bF)(A,{controls:!0,onChange:L,modelValue:r.size,"onUpdate:modelValue":t[15]||(t[15]=e=>r.size=e),min:1,max:40},null,8,["modelValue"])]),(0,n.Lk)("div",null,[(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("分割数")])),_:1}),(0,n.bF)(A,{controls:!0,onChange:L,modelValue:r.divisions,"onUpdate:modelValue":t[16]||(t[16]=e=>r.divisions=e),min:1,max:40},null,8,["modelValue"])])]),(0,n.Lk)("div",Lt,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("网格颜色")])),_:1}),(0,n.bF)(E,{"color-format":"hex",predefine:(0,s.R1)(d),onChange:w,onActiveChange:k,modelValue:r.color,"onUpdate:modelValue":t[17]||(t[17]=e=>r.color=e)},null,8,["predefine","modelValue"])])),_:1})])],2),(0,n.Lk)("div",{class:(0,o.C4)(["options",u.value])},[(0,n.Lk)("div",xt,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(T)])),_:1}),Mt])),_:1}),(0,n.bF)(i,{modelValue:r.axesHelper,"onUpdate:modelValue":t[18]||(t[18]=e=>r.axesHelper=e),onChange:x},null,8,["modelValue"])]),(0,n.Lk)("div",{class:(0,o.C4)(["option",h.value])},[(0,n.Lk)("div",_t,[(0,n.bF)(M,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("轴长度")])),_:1})]),(0,n.Lk)("div",Ft,[(0,n.bF)(F,{onInput:x,modelValue:r.axesSize,"onUpdate:modelValue":t[19]||(t[19]=e=>r.axesSize=e),min:1,max:10,step:.2},null,8,["modelValue"])])],2)],2)])}}};const St=Ct;var At=St;const Et=e=>((0,n.Qi)("data-v-26bf972c"),e=e(),(0,n.jt)(),e),Tt={class:"edit-box"},It={class:"header"},Rt=Et((()=>(0,n.Lk)("span",null,"模型灯光",-1))),Vt={class:"options"},Pt={class:"option space-between"},Ut=Et((()=>(0,n.Lk)("span",null,"光源平面",-1))),zt=Et((()=>(0,n.Lk)("span",null,"平面颜色",-1))),Ht={class:"grid-txt"},Wt={class:"grid-silder"},Ot={class:"grid-txt"},Dt={class:"grid-silder"},Gt={class:"options"},Nt={class:"option space-between"},Bt=Et((()=>(0,n.Lk)("span",null,"环境光",-1))),jt={class:"color"},Xt={class:"silder"},Yt={class:"options"},Qt={class:"option space-between"},Kt=Et((()=>(0,n.Lk)("span",null,"平行光",-1))),Zt={class:"color"},qt={class:"silder"},$t={class:"grid-txt"},Jt={class:"grid-silder"},ei={class:"grid-txt"},ti={class:"grid-silder"},ii={class:"grid-txt"},ni={class:"grid-silder"},oi={class:"grid-txt"},si={class:"grid-silder"},ai={class:"grid-txt"},ri={class:"grid-silder"},li={class:"options"},ci={class:"option space-between"},di=Et((()=>(0,n.Lk)("span",null,"点光源",-1))),ui={class:"grid-txt"},pi={class:"grid-silder"},hi={class:"color"},mi={class:"silder"},gi={class:"grid-txt"},fi={class:"grid-silder"},yi={class:"grid-txt"},bi={class:"grid-silder"},vi={class:"grid-txt"},ki={class:"grid-silder"},wi={class:"options"},Li={class:"option space-between"},xi=Et((()=>(0,n.Lk)("span",null,"聚光灯",-1))),Mi={class:"color"},_i={class:"silder"},Fi={class:"grid-txt"},Ci={class:"grid-silder"},Si={class:"grid-txt"},Ai={class:"grid-silder"},Ei={class:"grid-txt"},Ti={class:"grid-silder"},Ii={class:"grid-txt"},Ri={class:"grid-silder"},Vi={class:"grid-txt"},Pi={class:"grid-silder"},Ui={class:"grid-txt"},zi={class:"grid-silder"},Hi={class:"grid-txt"},Wi={class:"grid-silder"},Oi={class:"grid-txt"},Di={class:"grid-silder"},Gi={class:"grid-txt"},Ni={class:"grid-silder"};var Bi={__name:"EditLight",setup(e,{expose:t}){const i=l(),{$bus:a}=(0,n.nI)().proxy,r=(0,s.Kh)({planeGeometry:!1,planeColor:"#000000",planeWidth:7,planeHeight:7,ambientLight:!0,ambientLightColor:"#fff",ambientLightIntensity:.8,directionalLight:!1,directionalLightHelper:!0,directionalLightColor:"#fff",directionalLightIntensity:5,directionalHorizontal:-1.26,directionalVertical:-3.85,directionalSistance:2.98,directionaShadow:!0,pointLight:!1,pointLightHelper:!0,pointLightColor:"#1E90FF",pointLightIntensity:10,pointHorizontal:-4.21,pointVertical:-4.1,pointSistance:2.53,spotLight:!1,spotLightColor:"#00BABD",spotLightIntensity:900,spotHorizontal:-3.49,spotVertical:-4.37,spotSistance:4.09,spotAngle:.5,spotPenumbra:1,spotFocus:1,spotCastShadow:!0,spotLightHelper:!0,spotDistance:20}),d=c.yD,u=(0,n.EW)((()=>{const{ambientLight:e}=r;return e?"":"disabled"})),p=(0,n.EW)((()=>{const{directionalLight:e}=r;return e?"":"disabled"})),h=(0,n.EW)((()=>{const{pointLight:e}=r;return e?"":"disabled"})),m=(0,n.EW)((()=>{const{spotLight:e}=r;return e?"":"disabled"})),g=(0,n.EW)((()=>{const{planeGeometry:e}=r;return e?"":"disabled"})),f=(0,s.Kh)({modelApi:(0,n.EW)((()=>i.modelApi))});(0,n.sV)((()=>{a.on("model-update",(()=>{C()}))}));const y=e=>{r.ambientLightColor=e,f.modelApi.onSetModelAmbientLight(r)},b=()=>{f.modelApi.onSetModelAmbientLight(r)},v=e=>{r.directionalLightColor=e,f.modelApi.onSetModelDirectionalLight(r)},k=()=>{r.directionalLight&&(r.planeGeometry=!0,f.modelApi.onSetModelPlaneGeometry(r)),f.modelApi.onSetModelDirectionalLight(r)},w=e=>{r.pointLightColor=e,f.modelApi.onSetModelPointLight(r)},L=()=>{f.modelApi.onSetModelPointLight(r)},x=e=>{r.spotLightColor=e,f.modelApi.onSetModelSpotLight(r)},M=()=>{r.spotLight&&(r.planeGeometry=!0,f.modelApi.onSetModelPlaneGeometry(r)),f.modelApi.onSetModelSpotLight(r)},_=e=>{r.planeColor=e,f.modelApi.onSetModelPlaneGeometry(r)},F=()=>{f.modelApi.onSetModelPlaneGeometry(r)},C=()=>{Object.assign(r,{planeGeometry:!1,planeColor:"#000000",planeWidth:7,planeHeight:7,ambientLight:!0,ambientLightColor:"#fff",ambientLightIntensity:.8,directionalLight:!1,directionalLightHelper:!0,directionalLightColor:"#fff",directionalLightIntensity:5,directionalHorizontal:-1.26,directionalVertical:-3.85,directionalSistance:2.98,directionaShadow:!0,pointLight:!1,pointLightHelper:!0,pointLightColor:"#1E90FF",pointLightIntensity:10,pointHorizontal:-4.21,pointVertical:-4.1,pointSistance:2.53,spotLight:!1,spotLightColor:"#00BABD",spotLightIntensity:900,spotHorizontal:-3.49,spotVertical:-4.37,spotSistance:4.09,spotAngle:.5,spotPenumbra:1,spotFocus:1,spotCastShadow:!0,spotLightHelper:!0,spotDistance:20})},S=()=>{C(),f.modelApi.onResettingLight({ambientLight:!0})};return t({config:r}),(e,t)=>{const i=(0,n.g2)("el-button"),a=(0,n.g2)("Odometer"),l=(0,n.g2)("el-icon"),c=(0,n.g2)("el-space"),f=(0,n.g2)("el-switch"),C=(0,n.g2)("el-color-picker"),A=(0,n.g2)("el-slider"),E=(0,n.g2)("SetUp"),T=(0,n.g2)("Place"),I=(0,n.g2)("Orange"),R=(0,n.g2)("el-scrollbar");return(0,n.uX)(),(0,n.CE)("div",Tt,[(0,n.Lk)("div",It,[Rt,(0,n.bF)(i,{type:"primary",icon:"Refresh",onClick:S},{default:(0,n.k6)((()=>[(0,n.eW)(" 重置 ")])),_:1})]),(0,n.bF)(R,{height:"calc(100vh - 130px)"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",Vt,[(0,n.Lk)("div",Pt,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(a)])),_:1}),Ut])),_:1}),(0,n.bF)(f,{modelValue:r.planeGeometry,"onUpdate:modelValue":t[0]||(t[0]=e=>r.planeGeometry=e),onChange:F},null,8,["modelValue"])]),(0,n.Lk)("div",{class:(0,o.C4)(["option",g.value])},[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[zt,(0,n.bF)(C,{"color-format":"hex",modelValue:r.planeColor,"onUpdate:modelValue":t[1]||(t[1]=e=>r.planeColor=e),predefine:(0,s.R1)(d),onChange:F,onActiveChange:_},null,8,["modelValue","predefine"])])),_:1})],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",g.value])},[(0,n.Lk)("div",Ht,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("宽度")])),_:1})]),(0,n.Lk)("div",Wt,[(0,n.bF)(A,{"show-input":"",onInput:F,modelValue:r.planeWidth,"onUpdate:modelValue":t[2]||(t[2]=e=>r.planeWidth=e),min:0,max:100,step:.1},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",g.value])},[(0,n.Lk)("div",Ot,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("高度")])),_:1})]),(0,n.Lk)("div",Dt,[(0,n.bF)(A,{"show-input":"",onInput:F,modelValue:r.planeHeight,"onUpdate:modelValue":t[3]||(t[3]=e=>r.planeHeight=e),min:0,max:100,step:.1},null,8,["modelValue"])])],2)]),(0,n.Lk)("div",Gt,[(0,n.Lk)("div",Nt,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(a)])),_:1}),Bt])),_:1}),(0,n.bF)(f,{modelValue:r.ambientLight,"onUpdate:modelValue":t[4]||(t[4]=e=>r.ambientLight=e),onChange:b},null,8,["modelValue"])]),(0,n.Lk)("div",{class:(0,o.C4)(["option",u.value])},[(0,n.Lk)("div",jt,[(0,n.bF)(C,{"color-format":"hex",modelValue:r.ambientLightColor,"onUpdate:modelValue":t[5]||(t[5]=e=>r.ambientLightColor=e),predefine:(0,s.R1)(d),onChange:b,onActiveChange:y},null,8,["modelValue","predefine"])]),(0,n.Lk)("div",Xt,[(0,n.bF)(A,{"show-input":"",onInput:b,modelValue:r.ambientLightIntensity,"onUpdate:modelValue":t[6]||(t[6]=e=>r.ambientLightIntensity=e),min:-5,max:5,step:.01},null,8,["modelValue"])])],2)]),(0,n.Lk)("div",Yt,[(0,n.Lk)("div",Qt,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(E)])),_:1}),Kt])),_:1}),(0,n.bF)(f,{modelValue:r.directionalLight,"onUpdate:modelValue":t[7]||(t[7]=e=>r.directionalLight=e),onChange:k},null,8,["modelValue"])]),(0,n.Lk)("div",{class:(0,o.C4)(["option",p.value])},[(0,n.Lk)("div",Zt,[(0,n.bF)(C,{"color-format":"hex",modelValue:r.directionalLightColor,"onUpdate:modelValue":t[8]||(t[8]=e=>r.directionalLightColor=e),predefine:(0,s.R1)(d),onChange:k,onActiveChange:v},null,8,["modelValue","predefine"])]),(0,n.Lk)("div",qt,[(0,n.bF)(A,{"show-input":"",onInput:k,modelValue:r.directionalLightIntensity,"onUpdate:modelValue":t[9]||(t[9]=e=>r.directionalLightIntensity=e),min:-5,max:15,step:.01},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",p.value])},[(0,n.Lk)("div",$t,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("是否开启阴影")])),_:1})]),(0,n.Lk)("div",Jt,[(0,n.bF)(f,{modelValue:r.directionaShadow,"onUpdate:modelValue":t[10]||(t[10]=e=>r.directionaShadow=e),onChange:k},null,8,["modelValue"])]),(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",ei,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("辅助线")])),_:1})]),(0,n.Lk)("div",ti,[(0,n.bF)(f,{modelValue:r.directionalLightHelper,"onUpdate:modelValue":t[11]||(t[11]=e=>r.directionalLightHelper=e),onChange:k},null,8,["modelValue"])])])),_:1})],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",p.value])},[(0,n.Lk)("div",ii,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("水平方向")])),_:1})]),(0,n.Lk)("div",ni,[(0,n.bF)(A,{"show-input":"",onInput:k,modelValue:r.directionalHorizontal,"onUpdate:modelValue":t[12]||(t[12]=e=>r.directionalHorizontal=e),min:-10,max:10,step:.01},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",p.value])},[(0,n.Lk)("div",oi,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("垂直方向")])),_:1})]),(0,n.Lk)("div",si,[(0,n.bF)(A,{"show-input":"",onInput:k,modelValue:r.directionalVertical,"onUpdate:modelValue":t[13]||(t[13]=e=>r.directionalVertical=e),min:-10,max:10,step:.01},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",p.value])},[(0,n.Lk)("div",ai,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("光源距离")])),_:1})]),(0,n.Lk)("div",ri,[(0,n.bF)(A,{"show-input":"",onInput:k,modelValue:r.directionalSistance,"onUpdate:modelValue":t[14]||(t[14]=e=>r.directionalSistance=e),min:0,max:10,step:.01},null,8,["modelValue"])])],2)]),(0,n.Lk)("div",li,[(0,n.Lk)("div",ci,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(T)])),_:1}),di])),_:1}),(0,n.bF)(f,{modelValue:r.pointLight,"onUpdate:modelValue":t[15]||(t[15]=e=>r.pointLight=e),onChange:L},null,8,["modelValue"])]),(0,n.Lk)("div",{class:(0,o.C4)(["option",h.value])},[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",ui,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("辅助线")])),_:1})]),(0,n.Lk)("div",pi,[(0,n.bF)(f,{modelValue:r.pointLightHelper,"onUpdate:modelValue":t[16]||(t[16]=e=>r.pointLightHelper=e),onChange:L},null,8,["modelValue"])])])),_:1})],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",h.value])},[(0,n.Lk)("div",hi,[(0,n.bF)(C,{"color-format":"hex",modelValue:r.pointLightColor,"onUpdate:modelValue":t[17]||(t[17]=e=>r.pointLightColor=e),predefine:(0,s.R1)(d),onChange:L,onActiveChange:w},null,8,["modelValue","predefine"])]),(0,n.Lk)("div",mi,[(0,n.bF)(A,{"show-input":"",onInput:L,modelValue:r.pointLightIntensity,"onUpdate:modelValue":t[18]||(t[18]=e=>r.pointLightIntensity=e),min:-20,max:60,step:.1},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",h.value])},[(0,n.Lk)("div",gi,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("水平方向")])),_:1})]),(0,n.Lk)("div",fi,[(0,n.bF)(A,{"show-input":"",onInput:L,modelValue:r.pointHorizontal,"onUpdate:modelValue":t[19]||(t[19]=e=>r.pointHorizontal=e),min:-10,max:10,step:.11},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",h.value])},[(0,n.Lk)("div",yi,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("垂直方向")])),_:1})]),(0,n.Lk)("div",bi,[(0,n.bF)(A,{"show-input":"",onInput:L,modelValue:r.pointVertical,"onUpdate:modelValue":t[20]||(t[20]=e=>r.pointVertical=e),min:-10,max:10,step:.1},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",h.value])},[(0,n.Lk)("div",vi,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("光源距离")])),_:1})]),(0,n.Lk)("div",ki,[(0,n.bF)(A,{"show-input":"",onInput:L,modelValue:r.pointSistance,"onUpdate:modelValue":t[21]||(t[21]=e=>r.pointSistance=e),min:0,max:10,step:.1},null,8,["modelValue"])])],2)]),(0,n.Lk)("div",wi,[(0,n.Lk)("div",Li,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(I)])),_:1}),xi])),_:1}),(0,n.bF)(f,{modelValue:r.spotLight,"onUpdate:modelValue":t[22]||(t[22]=e=>r.spotLight=e),onChange:M},null,8,["modelValue"])]),(0,n.Lk)("div",{class:(0,o.C4)(["option",m.value])},[(0,n.Lk)("div",Mi,[(0,n.bF)(C,{"color-format":"hex",modelValue:r.spotLightColor,"onUpdate:modelValue":t[23]||(t[23]=e=>r.spotLightColor=e),predefine:(0,s.R1)(d),onChange:M,onActiveChange:x},null,8,["modelValue","predefine"])]),(0,n.Lk)("div",_i,[(0,n.bF)(A,{"show-input":"",onInput:M,modelValue:r.spotLightIntensity,"onUpdate:modelValue":t[24]||(t[24]=e=>r.spotLightIntensity=e),min:0,max:2e3,step:.1},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",m.value])},[(0,n.Lk)("div",Fi,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("是否开启阴影")])),_:1})]),(0,n.Lk)("div",Ci,[(0,n.bF)(f,{modelValue:r.spotCastShadow,"onUpdate:modelValue":t[25]||(t[25]=e=>r.spotCastShadow=e),onChange:M},null,8,["modelValue"])]),(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",Si,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("辅助线")])),_:1})]),(0,n.Lk)("div",Ai,[(0,n.bF)(f,{modelValue:r.spotLightHelper,"onUpdate:modelValue":t[26]||(t[26]=e=>r.spotLightHelper=e),onChange:M},null,8,["modelValue"])])])),_:1})],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",m.value])},[(0,n.Lk)("div",Ei,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("水平方向")])),_:1})]),(0,n.Lk)("div",Ti,[(0,n.bF)(A,{"show-input":"",onInput:M,modelValue:r.spotHorizontal,"onUpdate:modelValue":t[27]||(t[27]=e=>r.spotHorizontal=e),min:-10,max:10,step:.1},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",m.value])},[(0,n.Lk)("div",Ii,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("垂直方向")])),_:1})]),(0,n.Lk)("div",Ri,[(0,n.bF)(A,{"show-input":"",onInput:M,modelValue:r.spotVertical,"onUpdate:modelValue":t[28]||(t[28]=e=>r.spotVertical=e),min:-10,max:10,step:.1},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",m.value])},[(0,n.Lk)("div",Vi,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("光源距离")])),_:1})]),(0,n.Lk)("div",Pi,[(0,n.bF)(A,{"show-input":"",onInput:M,modelValue:r.spotSistance,"onUpdate:modelValue":t[29]||(t[29]=e=>r.spotSistance=e),min:0,max:10,step:.1},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",m.value])},[(0,n.Lk)("div",Ui,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("光线照射范围")])),_:1})]),(0,n.Lk)("div",zi,[(0,n.bF)(A,{"show-input":"",onInput:M,modelValue:r.spotAngle,"onUpdate:modelValue":t[30]||(t[30]=e=>r.spotAngle=e),min:0,max:2,step:.01},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",m.value])},[(0,n.Lk)("div",Hi,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("边缘聚光度")])),_:1})]),(0,n.Lk)("div",Wi,[(0,n.bF)(A,{"show-input":"",onInput:M,modelValue:r.spotPenumbra,"onUpdate:modelValue":t[31]||(t[31]=e=>r.spotPenumbra=e),min:0,max:1,step:.01},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",m.value])},[(0,n.Lk)("div",Oi,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("投影聚焦度")])),_:1})]),(0,n.Lk)("div",Di,[(0,n.bF)(A,{"show-input":"",onInput:M,modelValue:r.spotFocus,"onUpdate:modelValue":t[32]||(t[32]=e=>r.spotFocus=e),min:0,max:3,step:.01},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",m.value])},[(0,n.Lk)("div",Gi,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("光源照射距离")])),_:1})]),(0,n.Lk)("div",Ni,[(0,n.bF)(A,{"show-input":"",onInput:M,modelValue:r.spotDistance,"onUpdate:modelValue":t[33]||(t[33]=e=>r.spotDistance=e),min:1,max:500,step:1},null,8,["modelValue"])])],2)])])),_:1})])}}};const ji=(0,N.A)(Bi,[["__scopeId","data-v-26bf972c"]]);var Xi=ji;const Yi={class:"edit-box"},Qi={class:"header"},Ki=(0,n.Lk)("span",null,"后期处理",-1),Zi={class:"options"},qi={class:"option space-between"},$i=(0,n.Lk)("span",null," 辉光 ",-1),Ji={class:"option"},en={class:"grid-txt"},tn={class:"grid-silder"},nn={class:"option"},on={class:"grid-txt"},sn={class:"grid-silder"},an={class:"option"},rn={class:"grid-txt"},ln={class:"grid-silder"},cn={class:"option"},dn={class:"grid-txt"},un={class:"grid-silder"},pn={class:"options"},hn={class:"option space-between"},mn=(0,n.Lk)("span",null," 色调曝光度 ",-1),gn={class:"grid-silder"},fn={class:"header"},yn=(0,n.Lk)("span",null,"模型操作",-1),bn={class:"options"},vn=(0,n.Lk)("span",null," 模型分解 ",-1),kn={class:"grid-silder"},wn=(0,n.Lk)("span",null," 模型材质操作 ",-1),Ln={class:"grid-silder"},xn={class:"grid-silder"};var Mn={__name:"EditLaterStage",setup(e,{expose:t}){const i=l(),{$bus:a}=(0,n.nI)().proxy,r=(0,n.EW)((()=>{const{glow:e}=h;return e?"":"disabled"})),d=(0,n.EW)((()=>{const e=i.modelApi.modelMaterialList,t=e.filter((e=>"Mesh"==e.type));return t.length<=1||t.length!=e.length||h.manageFlage?"disabled":""})),u=(0,n.EW)((()=>{const e=i.modelApi.modelMaterialList,t=e.filter((e=>"Mesh"==e.type));return t.length<=1||t.length!=e.length?"disabled":""})),p=(0,n.EW)((()=>h.manageFlage?"":"disabled")),h=(0,s.Kh)({glow:!1,threshold:.05,strength:.6,radius:1,decompose:0,transformType:"translate",manageFlage:!1,manageFlage:!1,toneMappingExposure:2,color:""});(0,n.sV)((()=>{a.on("model-update",(()=>{Object.assign(h,{glow:!1,threshold:.05,strength:.6,radius:1,decompose:0,transformType:"translate",manageFlage:!1,toneMappingExposure:2})}))}));const m=()=>{i.modelApi.onSetFlowColor(h.color)},g=e=>{h.color=e,i.modelApi.onSetFlowColor(h.color)},f=()=>{i.modelApi.onSetUnrealBloomPass(h)},y=()=>{i.modelApi.setModelMeshDecompose(h)},b=()=>{h.decompose=0,i.modelApi.setModelMeshDrag(h)},v=e=>{i.modelApi.setTransformControlsType(e)},k=()=>{Object.assign(h,{glow:!1,threshold:.05,strength:.6,radius:1,decompose:0,transformType:"translate",manageFlage:!1,toneMappingExposure:2}),i.modelApi.initStageFlow()},w=()=>({meshPositonList:i.modelApi.getMeshDragPosition(),...h});return t({getStageConfig:w}),(e,t)=>{const i=(0,n.g2)("el-button"),a=(0,n.g2)("Sunny"),l=(0,n.g2)("el-icon"),w=(0,n.g2)("el-space"),L=(0,n.g2)("WarnTriangleFilled"),x=(0,n.g2)("el-switch"),M=(0,n.g2)("el-tooltip"),_=(0,n.g2)("el-color-picker"),F=(0,n.g2)("el-slider"),C=(0,n.g2)("Umbrella"),S=(0,n.g2)("Cpu"),A=(0,n.g2)("Rank"),E=(0,n.g2)("el-radio-button"),T=(0,n.g2)("el-radio-group");return(0,n.uX)(),(0,n.CE)("div",Yi,[(0,n.Lk)("div",Qi,[Ki,(0,n.bF)(i,{type:"primary",icon:"Refresh",onClick:k},{default:(0,n.k6)((()=>[(0,n.eW)(" 重置 ")])),_:1})]),(0,n.Lk)("div",Zi,[(0,n.Lk)("div",qi,[(0,n.bF)(w,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(a)])),_:1}),$i])),_:1}),(0,n.bF)(M,{effect:"dark",content:"注意：辉光效果十分耗费性能，大模型文件开启会有卡顿，请谨慎使用 ",placement:"top"},{default:(0,n.k6)((()=>[(0,n.bF)(w,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(L,{size:20,color:"#ffb940"})])),_:1}),(0,n.bF)(x,{modelValue:h.glow,"onUpdate:modelValue":t[0]||(t[0]=e=>h.glow=e),onChange:f},null,8,["modelValue"])])),_:1})])),_:1})])]),(0,n.Lk)("div",{class:(0,o.C4)(["options",r.value])},[(0,n.Lk)("div",Ji,[(0,n.Lk)("div",en,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("颜色")])),_:1})]),(0,n.Lk)("div",tn,[(0,n.bF)(_,{"color-format":"hex",predefine:(0,s.R1)(c.yD),onChange:m,onActiveChange:g,modelValue:h.color,"onUpdate:modelValue":t[1]||(t[1]=e=>h.color=e)},null,8,["predefine","modelValue"])])]),(0,n.Lk)("div",nn,[(0,n.Lk)("div",on,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("强度")])),_:1})]),(0,n.Lk)("div",sn,[(0,n.bF)(F,{"show-input":"",modelValue:h.strength,"onUpdate:modelValue":t[2]||(t[2]=e=>h.strength=e),onInput:f,step:.01,min:0,max:8},null,8,["modelValue"])])]),(0,n.Lk)("div",an,[(0,n.Lk)("div",rn,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("半径")])),_:1})]),(0,n.Lk)("div",ln,[(0,n.bF)(F,{"show-input":"",modelValue:h.radius,"onUpdate:modelValue":t[3]||(t[3]=e=>h.radius=e),onInput:f,step:.01,min:0,max:5},null,8,["modelValue"])])]),(0,n.Lk)("div",cn,[(0,n.Lk)("div",dn,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("阈值")])),_:1})]),(0,n.Lk)("div",un,[(0,n.bF)(F,{"show-input":"",modelValue:h.threshold,"onUpdate:modelValue":t[4]||(t[4]=e=>h.threshold=e),onInput:f,step:.01,min:0,max:1},null,8,["modelValue"])])])],2),(0,n.Lk)("div",pn,[(0,n.Lk)("div",hn,[(0,n.bF)(w,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(C)])),_:1}),mn])),_:1}),(0,n.Lk)("div",gn,[(0,n.bF)(F,{"show-input":"",modelValue:h.toneMappingExposure,"onUpdate:modelValue":t[5]||(t[5]=e=>h.toneMappingExposure=e),onInput:f,step:.01,min:.5,max:10},null,8,["modelValue"])])])]),(0,n.Lk)("div",fn,[(0,n.bF)(w,null,{default:(0,n.k6)((()=>[yn,"disabled"==d.value?((0,n.uX)(),(0,n.Wv)(M,{key:0,effect:"dark",content:"当前模型不可进行以下操作",placement:"top"},{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(L,{size:20,color:"#ffb940"})])),_:1})])),_:1})):(0,n.Q3)("",!0)])),_:1})]),(0,n.Lk)("div",bn,[(0,n.Lk)("div",{class:(0,o.C4)(["option space-between",d.value])},[(0,n.bF)(w,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(S)])),_:1}),vn])),_:1}),(0,n.Lk)("div",kn,[(0,n.bF)(F,{"show-input":"",modelValue:h.decompose,"onUpdate:modelValue":t[6]||(t[6]=e=>h.decompose=e),onInput:y,step:.01,min:0,max:800},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",u.value])},[(0,n.bF)(w,null,{default:(0,n.k6)((()=>[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(A,{size:20})])),_:1}),wn])),_:1}),(0,n.Lk)("div",Ln,[(0,n.bF)(x,{modelValue:h.manageFlage,"onUpdate:modelValue":t[7]||(t[7]=e=>h.manageFlage=e),onChange:b},null,8,["modelValue"])])],2),(0,n.Lk)("div",{class:(0,o.C4)(["option",p.value])},[(0,n.Lk)("div",xn,[(0,n.bF)(T,{modelValue:h.transformType,"onUpdate:modelValue":t[8]||(t[8]=e=>h.transformType=e),onChange:v},{default:(0,n.k6)((()=>[(0,n.bF)(E,{label:"translate"},{default:(0,n.k6)((()=>[(0,n.eW)("拖拽")])),_:1}),(0,n.bF)(E,{label:"rotate"},{default:(0,n.k6)((()=>[(0,n.eW)("旋转")])),_:1}),(0,n.bF)(E,{label:"scale"},{default:(0,n.k6)((()=>[(0,n.eW)("缩放")])),_:1})])),_:1},8,["modelValue"])])],2)])])}}};const _n=Mn;var Fn=_n;const Cn=e=>((0,n.Qi)("data-v-7fb64128"),e=e(),(0,n.jt)(),e),Sn={class:"edit-box"},An=Cn((()=>(0,n.Lk)("div",{class:"header"},[(0,n.Lk)("span",null,"几何体模型材质列表")],-1))),En={class:"options"},Tn=["onClick"],In={class:"icon-name"},Rn={class:"check"},Vn={class:"icon-delete"},Pn=Cn((()=>(0,n.Lk)("div",{class:"header"},[(0,n.Lk)("span",null,"几何体模型编辑")],-1))),Un={class:"options"},zn={class:"grid-txt"},Hn={class:"grid-silder"},Wn={key:1};var On={__name:"EditGeometry",setup(e){const t=l(),i=(0,s.Kh)({meaterialName:null,type:null}),r=(0,s.KR)(null),c=(0,s.KR)([]),d=(0,n.EW)((()=>{const e=u.modelMaterialList.filter((e=>e.userData.geometry));return 0!=e})),u=(0,s.Kh)({modelMaterialList:(0,n.EW)((()=>t.modelApi.modelMaterialList)),selectMeshUuid:(0,n.EW)((()=>t.selectMeshUuid))});(0,n.wB)((()=>t.selectMeshUuid),(e=>{const{geometry:t}=u.modelMaterialList.find((t=>t.uuid==e))||{};if(t){const{type:e}=t;r.value={...t.parameters},i.type=e,c.value=Object.keys(r.value)}else c.value=[]}));const h=({name:e,material:n,geometry:o})=>{i.meaterialName=n.name,t.modelApi.onChangeModelMeaterial(e)},m=()=>{t.modelApi.onSetGeometryMesh(r.value,i.type)},g=e=>{t.modelApi.onDeleteGeometryMesh(e),t.selectMeshAction({}),p.nk.success("删除成功")},f=e=>{let t={min:1,max:80,step:.01};return["width","height","radius","length","thetaLength","radiusTop","innerRadius","radiusBottom","q","outerRadius","arc","tube","p"].includes(e)&&(t={min:.1,max:10,step:.01}),["detail","capSegments","radialSegments","thetaStart","depthSegments","widthSegments","heightSegments"].includes(e)&&(t={min:0,max:10,step:1}),t};return(e,t)=>{const i=(0,n.g2)("Check"),s=(0,n.g2)("el-icon"),l=(0,n.g2)("Delete"),p=(0,n.g2)("el-space"),y=(0,n.g2)("el-scrollbar"),b=(0,n.g2)("el-button"),v=(0,n.g2)("el-slider"),k=(0,n.g2)("el-switch"),w=(0,n.g2)("el-empty");return(0,n.uX)(),(0,n.CE)("div",Sn,[d.value?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[An,(0,n.Lk)("div",En,[(0,n.bF)(y,{"max-height":"300px"},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(u.modelMaterialList,(e=>((0,n.uX)(),(0,n.CE)("div",{class:(0,o.C4)(["option",u.selectMeshUuid==e.uuid?"option-active":""]),onClick:t=>h(e),key:e.uuid},[(0,n.Lk)("div",In,(0,o.v_)(e.name),1),(0,n.bF)(p,null,{default:(0,n.k6)((()=>[(0,n.bo)((0,n.Lk)("div",Rn,[(0,n.bF)(s,{size:"20px",color:"#2a3ff6"},{default:(0,n.k6)((()=>[(0,n.bF)(i)])),_:1})],512),[[a.aG,u.selectMeshUuid==e.uuid]]),(0,n.Lk)("div",Vn,[(0,n.bF)(s,{size:"18px",color:"#2a3ff6"},{default:(0,n.k6)((()=>[(0,n.bF)(l,{onClick:(0,a.D$)((t=>g(e.uuid)),["stop"])},null,8,["onClick"])])),_:2},1024)])])),_:2},1024)],10,Tn)))),128))])),_:1})]),Pn,(0,n.Lk)("div",Un,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(c.value,(e=>((0,n.uX)(),(0,n.CE)("div",{class:"option",key:e},[(0,n.Lk)("div",zn,[(0,n.bF)(b,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(e),1)])),_:2},1024)]),(0,n.Lk)("div",Hn,["number"==typeof r.value[e]?((0,n.uX)(),(0,n.Wv)(v,{key:0,"show-input":"",modelValue:r.value[e],"onUpdate:modelValue":t=>r.value[e]=t,min:f(e).min,max:f(e).max,step:f(e).step,onInput:m},null,8,["modelValue","onUpdate:modelValue","min","max","step"])):"string"==typeof r.value[e]?((0,n.uX)(),(0,n.CE)("div",Wn,(0,o.v_)(r.value[e]),1)):"boolean"==typeof r.value[e]?((0,n.uX)(),(0,n.Wv)(k,{key:2,onChange:m,modelValue:r.value[e],"onUpdate:modelValue":t=>r.value[e]=t},null,8,["modelValue","onUpdate:modelValue"])):(0,n.Q3)("",!0)])])))),128))])],64)):((0,n.uX)(),(0,n.Wv)(w,{key:1,description:"当前模型不支持使用该功能","image-size":120}))])}}};const Dn=(0,N.A)(On,[["__scopeId","data-v-7fb64128"]]);var Gn=Dn;var Nn=i(7477);const Bn=e=>((0,n.Qi)("data-v-095851b9"),e=e(),(0,n.jt)(),e),jn={class:"edit-box"},Xn={class:"header"},Yn=Bn((()=>(0,n.Lk)("span",null," 标签配置 ",-1))),Qn={class:"options"},Kn={class:"option"},Zn=Bn((()=>(0,n.Lk)("span",null,"标签类型",-1))),qn=Bn((()=>(0,n.Lk)("span",{style:{color:"#18c174 "}},"(可拖拽添加多个)",-1))),$n={class:"tag-box"},Jn={class:"icon"},eo=Bn((()=>(0,n.Lk)("div",{class:"options"},[(0,n.Lk)("div",{class:"header"}," 标签列表 ")],-1))),to={class:"options"},io=["onClick"],no={class:"icon-name"},oo={class:"check"},so={class:"icon-delete"},ao=Bn((()=>(0,n.Lk)("div",{class:"header"},[(0,n.Lk)("span",null," 标签编辑 ")],-1))),ro={key:0,class:"options"},lo={class:"option"},co={class:"grid-txt"},uo={class:"grid-silder"},po={class:"option"},ho={class:"grid-txt"},mo={class:"grid-silder"},go={class:"option"},fo={class:"grid-txt"},yo={class:"grid-silder"},bo={class:"option"},vo={class:"grid-txt"},ko={class:"grid-silder"},wo={class:"option"},Lo={class:"grid-txt"},xo={class:"grid-silder"},Mo={class:"option"},_o={class:"grid-txt"},Fo={class:"grid-silder"},Co={class:"option"},So={class:"grid-txt"},Ao={class:"grid-silder"},Eo={class:"grid-txt"},To={class:"grid-silder"},Io={class:"grid-txt"},Ro={class:"grid-silder"},Vo={class:"option"},Po={class:"grid-txt"},Uo={class:"grid-silder"},zo={class:"option",style:{height:"auto"}},Ho={class:"grid-txt"},Wo={class:"grid-silder"};var Oo={__name:"EditTags",setup(e,{expose:t}){const i=l(),r=c.yD,d=(0,s.Kh)({dragTagList:(0,n.EW)((()=>i.modelApi.dragTagList))}),u=(0,n.EW)((()=>{const e=[];for(const[t]of Object.entries(Nn))e.push({name:t});return e})),p=(0,s.Kh)({}),h=(e,t)=>{i.modelApi.setDragTag(t),i.changeDragType("tags")},m=e=>{e.preventDefault()},g=()=>{p.uuid=null,i.modelApi.clearSceneTags()},f=e=>{Object.assign(p,{...e})},y=e=>{i.modelApi.deleteTag(e),p.uuid=null},b=()=>{i.modelApi.updateTagElement(p)};return t({config:d}),(e,t)=>{const i=(0,n.g2)("el-button"),l=(0,n.g2)("PriceTag"),c=(0,n.g2)("el-icon"),v=(0,n.g2)("el-space"),k=(0,n.g2)("el-col"),w=(0,n.g2)("el-row"),L=(0,n.g2)("el-scrollbar"),x=(0,n.g2)("Check"),M=(0,n.g2)("Delete"),_=(0,n.g2)("el-empty"),F=(0,n.g2)("el-slider"),C=(0,n.g2)("el-color-picker"),S=(0,n.g2)("el-input");return(0,n.uX)(),(0,n.CE)("div",jn,[(0,n.Lk)("div",Xn,[Yn,(0,n.bF)(i,{type:"primary",icon:"Refresh",onClick:g},{default:(0,n.k6)((()=>[(0,n.eW)(" 重置 ")])),_:1})]),(0,n.Lk)("div",Qn,[(0,n.Lk)("div",Kn,[(0,n.bF)(v,null,{default:(0,n.k6)((()=>[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(l)])),_:1}),Zn,qn])),_:1})]),(0,n.bF)(L,{"max-height":"150px"},{default:(0,n.k6)((()=>[(0,n.bF)(w,{class:"tag-row"},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(u.value,(e=>((0,n.uX)(),(0,n.Wv)(k,{draggable:"true",key:e.name,span:4,onDragstart:t=>h(t,e),onDrag:t[0]||(t[0]=e=>m(e))},{default:(0,n.k6)((()=>[(0,n.Lk)("div",$n,[(0,n.Lk)("div",Jn,[(0,n.bF)(c,{size:"16px"},{default:(0,n.k6)((()=>[((0,n.uX)(),(0,n.Wv)((0,n.$y)(e.name)))])),_:2},1024)])])])),_:2},1032,["onDragstart"])))),128))])),_:1})])),_:1})]),eo,(0,n.Lk)("div",to,[d.dragTagList.length?((0,n.uX)(),(0,n.Wv)(L,{key:0,"max-height":"170px"},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(d.dragTagList,(e=>((0,n.uX)(),(0,n.CE)("div",{class:(0,o.C4)(["option",p.uuid==e.uuid?"option-active":""]),onClick:t=>f(e),key:e.uuid},[(0,n.Lk)("div",no,(0,o.v_)(e.innerText),1),(0,n.bF)(v,null,{default:(0,n.k6)((()=>[(0,n.bo)((0,n.Lk)("div",oo,[(0,n.bF)(c,{size:"18px",color:"#2a3ff6"},{default:(0,n.k6)((()=>[(0,n.bF)(x)])),_:1})],512),[[a.aG,p.uuid==e.uuid]]),(0,n.Lk)("div",so,[(0,n.bF)(c,{size:"18px",color:"#2a3ff6"},{default:(0,n.k6)((()=>[(0,n.bF)(M,{onClick:(0,a.D$)((t=>y(e.uuid)),["stop"])},null,8,["onClick"])])),_:2},1024)])])),_:2},1024)],10,io)))),128))])),_:1})):((0,n.uX)(),(0,n.Wv)(_,{key:1,description:"暂无标签","image-size":100}))]),ao,p.uuid?((0,n.uX)(),(0,n.CE)("div",ro,[(0,n.Lk)("div",lo,[(0,n.Lk)("div",co,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("容器高度")])),_:1})]),(0,n.Lk)("div",uo,[(0,n.bF)(F,{onInput:b,"show-input":"",modelValue:p.height,"onUpdate:modelValue":t[1]||(t[1]=e=>p.height=e),min:1,max:500,step:1},null,8,["modelValue"])])]),(0,n.Lk)("div",po,[(0,n.Lk)("div",ho,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("容器宽度")])),_:1})]),(0,n.Lk)("div",mo,[(0,n.bF)(F,{onInput:b,"show-input":"",modelValue:p.width,"onUpdate:modelValue":t[2]||(t[2]=e=>p.width=e),min:1,max:500,step:1},null,8,["modelValue"])])]),(0,n.Lk)("div",go,[(0,n.Lk)("div",fo,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("字体大小")])),_:1})]),(0,n.Lk)("div",yo,[(0,n.bF)(F,{onInput:b,"show-input":"",modelValue:p.fontSize,"onUpdate:modelValue":t[3]||(t[3]=e=>p.fontSize=e),min:1,max:50,step:.1},null,8,["modelValue"])])]),(0,n.Lk)("div",bo,[(0,n.Lk)("div",vo,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("标签坐标X")])),_:1})]),(0,n.Lk)("div",ko,[(0,n.bF)(F,{onInput:b,"show-input":"",modelValue:p.positionX,"onUpdate:modelValue":t[4]||(t[4]=e=>p.positionX=e),min:-50,max:50,step:.01},null,8,["modelValue"])])]),(0,n.Lk)("div",wo,[(0,n.Lk)("div",Lo,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("标签坐标Y")])),_:1})]),(0,n.Lk)("div",xo,[(0,n.bF)(F,{onInput:b,"show-input":"",modelValue:p.positionY,"onUpdate:modelValue":t[5]||(t[5]=e=>p.positionY=e),min:-50,max:50,step:.1},null,8,["modelValue"])])]),(0,n.Lk)("div",Mo,[(0,n.Lk)("div",_o,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("标签坐标Z")])),_:1})]),(0,n.Lk)("div",Fo,[(0,n.bF)(F,{onInput:b,"show-input":"",modelValue:p.positionZ,"onUpdate:modelValue":t[6]||(t[6]=e=>p.positionZ=e),min:-50,max:50,step:.1},null,8,["modelValue"])])]),(0,n.Lk)("div",Co,[(0,n.Lk)("div",So,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("背景颜色")])),_:1})]),(0,n.Lk)("div",Ao,[(0,n.bF)(C,{"color-format":"hex",predefine:(0,s.R1)(r),onChange:b,modelValue:p.backgroundColor,"onUpdate:modelValue":t[7]||(t[7]=e=>p.backgroundColor=e)},null,8,["predefine","modelValue"])]),(0,n.Lk)("div",Eo,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("图标颜色")])),_:1})]),(0,n.Lk)("div",To,[(0,n.bF)(C,{"color-format":"hex",predefine:(0,s.R1)(r),onChange:b,modelValue:p.iconColor,"onUpdate:modelValue":t[8]||(t[8]=e=>p.iconColor=e)},null,8,["predefine","modelValue"])]),(0,n.Lk)("div",Io,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("字体颜色")])),_:1})]),(0,n.Lk)("div",Ro,[(0,n.bF)(C,{"color-format":"hex",predefine:(0,s.R1)(r),onChange:b,modelValue:p.color,"onUpdate:modelValue":t[9]||(t[9]=e=>p.color=e)},null,8,["predefine","modelValue"])])]),(0,n.Lk)("div",Vo,[(0,n.Lk)("div",Po,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("图标大小")])),_:1})]),(0,n.Lk)("div",Uo,[(0,n.bF)(F,{onInput:b,"show-input":"",modelValue:p.iconSize,"onUpdate:modelValue":t[10]||(t[10]=e=>p.iconSize=e),min:1,max:50,step:.1},null,8,["modelValue"])])]),(0,n.Lk)("div",zo,[(0,n.Lk)("div",Ho,[(0,n.bF)(i,{type:"primary",link:""},{default:(0,n.k6)((()=>[(0,n.eW)("标签内容")])),_:1})]),(0,n.Lk)("div",Wo,[(0,n.bF)(S,{type:"textarea",autosize:{minRows:3,maxRows:3},onInput:b,modelValue:p.innerText,"onUpdate:modelValue":t[11]||(t[11]=e=>p.innerText=e),modelModifiers:{trim:!0}},null,8,["modelValue"])])])])):(0,n.Q3)("",!0)])}}};const Do=(0,N.A)(Oo,[["__scopeId","data-v-095851b9"]]);var Go=Do;const No={class:"model-panel"},Bo={class:"panel-tabs"},jo=["onClick"],Xo={class:"tab"},Yo={class:"panel-edit"};var Qo={__name:"index",setup(e,{expose:t}){const i=[{name:"背景",key:"EditBackground",icon:"Picture"},{name:"材质",key:"EditMaterial",icon:"DataAnalysis"},{name:"后期/操作",key:"EditLaterStage",icon:"MagicStick"},{name:"灯光",key:"EditLight",icon:"Sunrise"},{name:"模型动画",key:"EditAnimation",icon:"VideoCameraFilled"},{name:"辅助线/轴配置",key:"EditAttribute",icon:"Box"},{name:"几何体模型配置",key:"EditGeometry",icon:"Cellphone"},{name:"标签配置",key:"EditTags",icon:"CollectionTag"}],r=(0,s.KR)("EditMaterial"),c=(0,s.KR)(null),d=(0,s.KR)(null),u=(0,s.KR)(null),p=(0,s.KR)(null),h=(0,s.KR)(null),m=(0,s.KR)(null),g=(0,s.KR)(null),f=(0,s.KR)(null),y=((0,s.KR)(null),l(),()=>({background:c.value.config,material:d.value.getMeshConfig(),animation:u.value.config,attribute:p.value.getAttrbuteConfig(),light:h.value.config,stage:m.value.getStageConfig(),tags:f.value.config}));return t({getPanelConfig:y}),(e,t)=>{const s=(0,n.g2)("el-icon"),l=(0,n.g2)("el-tooltip");return(0,n.uX)(),(0,n.CE)("div",No,[(0,n.Lk)("ul",Bo,[((0,n.uX)(),(0,n.CE)(n.FK,null,(0,n.pI)(i,(e=>(0,n.Lk)("li",{key:e.key,class:(0,o.C4)(r.value==e.key?"active":""),onClick:t=>r.value=e.key},[(0,n.bF)(l,{effect:"light",content:e.name,placement:"top"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",Xo,[(0,n.bF)(s,{size:"20px",color:r.value==e.key?"#fff":""},{default:(0,n.k6)((()=>[((0,n.uX)(),(0,n.Wv)((0,n.$y)(e.icon)))])),_:2},1032,["color"])])])),_:2},1032,["content"])],10,jo))),64))]),(0,n.Lk)("div",Yo,[(0,n.bo)((0,n.Lk)("div",null,[(0,n.bF)(j,{ref_key:"background",ref:c},null,512)],512),[[a.aG,"EditBackground"==r.value]]),(0,n.bo)((0,n.Lk)("div",null,[(0,n.bF)(be,{ref_key:"material",ref:d},null,512)],512),[[a.aG,"EditMaterial"==r.value]]),(0,n.bo)((0,n.Lk)("div",null,[(0,n.bF)(Fn,{ref_key:"stage",ref:m},null,512)],512),[[a.aG,"EditLaterStage"==r.value]]),(0,n.bo)((0,n.Lk)("div",null,[(0,n.bF)(Ge,{ref_key:"animation",ref:u},null,512)],512),[[a.aG,"EditAnimation"==r.value]]),(0,n.bo)((0,n.Lk)("div",null,[(0,n.bF)(Xi,{ref_key:"light",ref:h},null,512)],512),[[a.aG,"EditLight"==r.value]]),(0,n.bo)((0,n.Lk)("div",null,[(0,n.bF)(At,{ref_key:"attribute",ref:p},null,512)],512),[[a.aG,"EditAttribute"==r.value]]),(0,n.bo)((0,n.Lk)("div",null,[(0,n.bF)(Gn,{ref_key:"geometry",ref:g},null,512)],512),[[a.aG,"EditGeometry"==r.value]]),(0,n.bo)((0,n.Lk)("div",null,[(0,n.bF)(Go,{ref_key:"tags",ref:f},null,512)],512),[[a.aG,"EditTags"==r.value]])])])}}};const Ko=(0,N.A)(Qo,[["__scopeId","data-v-79828e9a"]]);var Zo=Ko;const qo={class:"model-choose"},$o=(0,n.Lk)("div",{class:"header"},[(0,n.Lk)("span",null,"模型列表")],-1),Jo={class:"options"},es={class:"option"},ts=(0,n.Lk)("span",null,"普通模型",-1),is={class:"options"},ns={class:"option"},os=(0,n.Lk)("span",null,"动画模型",-1),ss={class:"options"},as={class:"option"},rs=(0,n.Lk)("span",null,"几何体模型",-1),ls={key:0,style:{color:"#18c174 "}},cs=["onDragstart"],ds={class:"geometry-name"},us={key:1,class:"geometry-box"},ps={class:"icon"},hs=(0,n.Lk)("div",null,[(0,n.Lk)("span",null,"添加几何体模型")],-1),ms={class:"options"},gs={class:"option"},fs=(0,n.Lk)("span",null,"外部模型",-1),ys={class:"file-name"},bs=(0,n.Lk)("span",null,"当前模型:",-1),vs={class:"upload"},ks={class:"icon"},ws=(0,n.Lk)("div",null,[(0,n.Lk)("span",null,"请选择(目前仅支持.glb, .obj, .gltf, .fbx, .stl格式)")],-1);var Ls={__name:"index",setup(e,{expose:t}){const r=l(),{$bus:c}=(0,n.nI)().proxy,p=(0,n.EW)((()=>d.u9.filter((e=>!e.animation)))),h=(0,n.EW)((()=>d.u9.filter((e=>e.animation)))),m=(0,s.KR)(9),g=(0,s.KR)(!1),f=(0,s.KR)({name:"变形金刚（3）",fileType:"glb",id:9,animation:!1,filePath:"threeFile/glb/glb-9.glb",icon:i(6206),decomposeName:"transformers_3",key:"transformers-3"}),y=(0,s.KR)(null),b=async e=>{if(e.id==m.value)return!1;g.value=!1,m.value=e.id,y.value=null,f.value=e,c.emit("page-loading",!0);try{const{load:t}=await r.modelApi.onSwitchModel(e);t&&(c.emit("model-update"),c.emit("page-loading",!1))}catch(t){c.emit("page-loading",!1)}},v=async()=>{g.value=!0,y.value=null,m.value=null,f.value={},r.modelApi.clearSceneModel()},k=(e,t)=>{r.modelApi.setDragGeometryModel(t),r.changeDragType("geometry")},w=e=>{e.preventDefault()},L=async e=>{y.value=e.name;const t=URL.createObjectURL(e.raw),i={filePath:t,fileType:(0,u.ti)(e.name)};c.emit("page-loading",!0);try{const{load:e,filePath:t}=await r.modelApi.onSwitchModel(i);URL.revokeObjectURL(t),e&&(c.emit("model-update"),c.emit("page-loading",!1),m.value=null,g.value=!1,f.value={})}catch(n){y.value=null,c.emit("page-loading",!1)}};return t({activeModel:f}),(e,t)=>{const i=(0,n.g2)("Orange"),r=(0,n.g2)("el-icon"),l=(0,n.g2)("el-space"),c=(0,n.g2)("el-image"),u=(0,n.g2)("el-col"),f=(0,n.g2)("el-row"),x=(0,n.g2)("el-scrollbar"),M=(0,n.g2)("Paperclip"),_=(0,n.g2)("SwitchFilled"),F=(0,n.g2)("el-tooltip"),C=(0,n.g2)("Plus"),S=(0,n.g2)("UploadFilled"),A=(0,n.g2)("el-upload");return(0,n.uX)(),(0,n.CE)("div",qo,[$o,(0,n.Lk)("div",Jo,[(0,n.Lk)("div",es,[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.bF)(i)])),_:1}),ts])),_:1})]),(0,n.bF)(x,{"max-height":"210px"},{default:(0,n.k6)((()=>[(0,n.bF)(f,null,{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(p.value,(e=>((0,n.uX)(),(0,n.Wv)(u,{style:{textAlign:"center"},span:12,key:e.id},{default:(0,n.k6)((()=>[(0,n.bF)(c,{draggable:"false",onClick:(0,a.D$)((t=>b(e)),["prevent"]),class:(0,o.C4)(["el-img",m.value==e.id?"active-model":""]),src:e.icon,fit:"cover"},null,8,["onClick","class","src"])])),_:2},1024)))),128))])),_:1})])),_:1})]),(0,n.Lk)("div",is,[(0,n.Lk)("div",ns,[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.bF)(M)])),_:1}),os])),_:1})]),(0,n.bF)(x,{"max-height":"210px"},{default:(0,n.k6)((()=>[(0,n.bF)(f,null,{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(h.value,(e=>((0,n.uX)(),(0,n.Wv)(u,{style:{textAlign:"center"},span:12,key:e.id},{default:(0,n.k6)((()=>[(0,n.bF)(c,{draggable:"false",onClick:t=>b(e),class:(0,o.C4)(["el-img",m.value==e.id?"active-model":""]),src:e.icon,fit:"cover"},null,8,["onClick","class","src"])])),_:2},1024)))),128))])),_:1})])),_:1})]),(0,n.Lk)("div",ss,[(0,n.Lk)("div",as,[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.bF)(_)])),_:1}),rs,g.value?((0,n.uX)(),(0,n.CE)("span",ls,"(可拖拽添加多个)")):(0,n.Q3)("",!0)])),_:1})]),(0,n.bF)(x,{"max-height":"120px"},{default:(0,n.k6)((()=>[g.value?((0,n.uX)(),(0,n.Wv)(f,{key:0},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,s.R1)(d.WH),(e=>((0,n.uX)(),(0,n.Wv)(u,{style:{textAlign:"center"},span:8,key:e.type},{default:(0,n.k6)((()=>[(0,n.Lk)("div",{class:(0,o.C4)(["geometry",m.value==e.id?"active-model":""]),draggable:"true",onDragstart:t=>k(t,e),onDrag:t[0]||(t[0]=e=>w(e))},[(0,n.Lk)("div",ds,[(0,n.bF)(F,{effect:"dark",content:`${e.name}:${e.type}`,placement:"top"},{default:(0,n.k6)((()=>[(0,n.Lk)("b",null,(0,o.v_)(e.name),1)])),_:2},1032,["content"])])],42,cs)])),_:2},1024)))),128))])),_:1})):((0,n.uX)(),(0,n.CE)("div",us,[(0,n.Lk)("div",{class:"geometry-add",onClick:v},[(0,n.Lk)("div",ps,[(0,n.bF)(r,{size:44},{default:(0,n.k6)((()=>[(0,n.bF)(C)])),_:1}),hs])])]))])),_:1})]),(0,n.Lk)("div",ms,[(0,n.Lk)("div",gs,[(0,n.bF)(l,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,null,{default:(0,n.k6)((()=>[(0,n.bF)(S)])),_:1}),fs])),_:1})]),(0,n.Lk)("div",ys,[bs,(0,n.bF)(F,{effect:"dark",content:y.value,placement:"top"},{default:(0,n.k6)((()=>[(0,n.Lk)("b",null,(0,o.v_)(y.value),1)])),_:1},8,["content"])]),(0,n.bF)(A,{action:"",accept:".glb,.obj,.gltf,.fbx,.stl",class:"file-box","show-file-list":!1,"auto-upload":!1,"on-change":L},{default:(0,n.k6)((()=>[(0,n.Lk)("div",vs,[(0,n.Lk)("div",ks,[(0,n.bF)(r,{size:44},{default:(0,n.k6)((()=>[(0,n.bF)(C)])),_:1}),ws])])])),_:1})])])}}};const xs=Ls;var Ms=xs,_s=i(3723),Fs=i.n(_s);const Cs={class:"code"},Ss={class:"dialog-footer"};var As={__name:"index",setup(e,{expose:t}){const i=(0,s.KR)(!1),a=(0,s.KR)(null),r=(0,s.Kh)({width:400,height:300}),l=(0,n.EW)((()=>{const e=a.value.replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,"'$1'"),t=`${c.qd}?modelConfig=`+e,i=`<iframe  width="${r.width}" height="${r.height}" src="${t}" allowfullscreen></iframe>`;return i})),d=e=>{i.value=!0,a.value=JSON.stringify(e)},u=()=>{const e=new(Fs())(".copy-button",{text:()=>l.value});e.on("success",(t=>{p.nk.success("复制成功,将代码粘贴至你的项目中即可"),e.destroy(),i.value=!1})),e.on("error",(()=>{console.log("复制失败"),e.destroy()}))};return t({showDialog:d}),(e,t)=>{const s=(0,n.g2)("el-scrollbar"),a=(0,n.g2)("el-text"),c=(0,n.g2)("el-input-number"),d=(0,n.g2)("el-col"),p=(0,n.g2)("el-row"),h=(0,n.g2)("el-button"),m=(0,n.g2)("el-dialog");return(0,n.uX)(),(0,n.Wv)(m,{modelValue:i.value,"onUpdate:modelValue":t[2]||(t[2]=e=>i.value=e),title:"将当前编辑效果嵌入你的项目",width:"600px","close-on-click-modal":!1},{footer:(0,n.k6)((()=>[(0,n.Lk)("span",Ss,[(0,n.bF)(h,{type:"primary",class:"copy-button",onClick:u},{default:(0,n.k6)((()=>[(0,n.eW)(" 复制代码 ")])),_:1})])])),default:(0,n.k6)((()=>[(0,n.bF)(s,{"max-height":"400px"},{default:(0,n.k6)((()=>[(0,n.Lk)("code",Cs,(0,o.v_)(l.value),1)])),_:1}),(0,n.bF)(p,{style:{marginTop:"10px"}},{default:(0,n.k6)((()=>[(0,n.bF)(d,{span:12},{default:(0,n.k6)((()=>[(0,n.bF)(a,{type:"primary"},{default:(0,n.k6)((()=>[(0,n.eW)("容器宽度")])),_:1}),(0,n.bF)(c,{class:"number-style",precision:0,modelValue:r.width,"onUpdate:modelValue":t[0]||(t[0]=e=>r.width=e)},null,8,["modelValue"])])),_:1}),(0,n.bF)(d,{span:12},{default:(0,n.k6)((()=>[(0,n.bF)(a,{type:"primary"},{default:(0,n.k6)((()=>[(0,n.eW)("容器高度")])),_:1}),(0,n.bF)(c,{class:"number-style",precision:0,modelValue:r.height,"onUpdate:modelValue":t[1]||(t[1]=e=>r.height=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}}};const Es=(0,N.A)(As,[["__scopeId","data-v-24530c32"]]);var Ts=Es,Is=i(1387),Rs=i(2933),Vs=(i(6573),i(8100),i(7936),i(2951)),Ps=i(1353),Us=i(9294),zs=i(7669),Hs=i(6541),Ws=i(8068),Os=i(1540),Ds=i(8286),Gs=i(3262),Ns=i(427),Bs=i(3191),js=i(1383),Xs=i(5533);i(7467),i(4732),i(9577);let Ys,Qs,Ks,Zs;function qs(e,t=1/0,i=null){Qs||(Qs=new X.PlaneGeometry(2,2,1,1)),Ks||(Ks=new X.ShaderMaterial({uniforms:{blitTexture:new X.Uniform(e)},vertexShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main(){\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = vec4(position.xy * 1.0,0.,.999999);\n\t\t\t}",fragmentShader:"\n\t\t\tuniform sampler2D blitTexture; \n\t\t\tvarying vec2 vUv;\n\n\t\t\tvoid main(){ \n\t\t\t\tgl_FragColor = vec4(vUv.xy, 0, 1);\n\t\t\t\t\n\t\t\t\t#ifdef IS_SRGB\n\t\t\t\tgl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );\n\t\t\t\t#else\n\t\t\t\tgl_FragColor = texture2D( blitTexture, vUv);\n\t\t\t\t#endif\n\t\t\t}"})),Ks.uniforms.blitTexture.value=e,Ks.defines.IS_SRGB=e.colorSpace==X.SRGBColorSpace,Ks.needsUpdate=!0,Zs||(Zs=new X.Mesh(Qs,Ks),Zs.frustrumCulled=!1);const n=new X.PerspectiveCamera,o=new X.Scene;o.add(Zs),null===i&&(i=Ys=new X.WebGLRenderer({antialias:!1}));const s=Math.min(e.image.width,t),a=Math.min(e.image.height,t);i.setSize(s,a),i.clear(),i.render(o,n);const r=document.createElement("canvas"),l=r.getContext("2d");r.width=s,r.height=a,l.drawImage(i.domElement,0,0,s,a);const c=new X.CanvasTexture(r);return c.minFilter=e.minFilter,c.magFilter=e.magFilter,c.wrapS=e.wrapS,c.wrapT=e.wrapT,c.name=e.name,Ys&&(Ys.forceContextLoss(),Ys.dispose(),Ys=null),c}const $s={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class Js{constructor(){this.pluginCallbacks=[],this.register((function(e){return new ka(e)})),this.register((function(e){return new wa(e)})),this.register((function(e){return new Ma(e)})),this.register((function(e){return new _a(e)})),this.register((function(e){return new Fa(e)})),this.register((function(e){return new Ca(e)})),this.register((function(e){return new La(e)})),this.register((function(e){return new xa(e)})),this.register((function(e){return new Sa(e)})),this.register((function(e){return new Aa(e)})),this.register((function(e){return new Ea(e)})),this.register((function(e){return new Ta(e)})),this.register((function(e){return new Ia(e)}))}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,n){const o=new va,s=[];for(let a=0,r=this.pluginCallbacks.length;a<r;a++)s.push(this.pluginCallbacks[a](o));o.setPlugins(s),o.write(e,t,n).catch(i)}parseAsync(e,t){const i=this;return new Promise((function(n,o){i.parse(e,n,o,t)}))}}const ea={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},ta="KHR_mesh_quantization",ia={};ia[X.NearestFilter]=ea.NEAREST,ia[X.NearestMipmapNearestFilter]=ea.NEAREST_MIPMAP_NEAREST,ia[X.NearestMipmapLinearFilter]=ea.NEAREST_MIPMAP_LINEAR,ia[X.LinearFilter]=ea.LINEAR,ia[X.LinearMipmapNearestFilter]=ea.LINEAR_MIPMAP_NEAREST,ia[X.LinearMipmapLinearFilter]=ea.LINEAR_MIPMAP_LINEAR,ia[X.ClampToEdgeWrapping]=ea.CLAMP_TO_EDGE,ia[X.RepeatWrapping]=ea.REPEAT,ia[X.MirroredRepeatWrapping]=ea.MIRRORED_REPEAT;const na={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},oa=new X.Color,sa=12,aa=1179937895,ra=2,la=8,ca=1313821514,da=5130562;function ua(e,t){return e.length===t.length&&e.every((function(e,i){return e===t[i]}))}function pa(e){return(new TextEncoder).encode(e).buffer}function ha(e){return ua(e.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function ma(e,t,i){const n={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let o=t;o<t+i;o++)for(let t=0;t<e.itemSize;t++){let i;e.itemSize>4?i=e.array[o*e.itemSize+t]:(0===t?i=e.getX(o):1===t?i=e.getY(o):2===t?i=e.getZ(o):3===t&&(i=e.getW(o)),!0===e.normalized&&(i=X.MathUtils.normalize(i,e.array))),n.min[t]=Math.min(n.min[t],i),n.max[t]=Math.max(n.max[t],i)}return n}function ga(e){return 4*Math.ceil(e/4)}function fa(e,t=0){const i=ga(e.byteLength);if(i!==e.byteLength){const n=new Uint8Array(i);if(n.set(new Uint8Array(e)),0!==t)for(let o=e.byteLength;o<i;o++)n[o]=t;return n.buffer}return e}function ya(){return"undefined"===typeof document&&"undefined"!==typeof OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas")}function ba(e,t){if(void 0!==e.toBlob)return new Promise((i=>e.toBlob(i,t)));let i;return"image/jpeg"===t?i=.92:"image/webp"===t&&(i=.8),e.convertToBlob({type:t,quality:i})}class va{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,t,i={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},i),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const n=this,o=n.buffers,s=n.json;i=n.options;const a=n.extensionsUsed,r=n.extensionsRequired,l=new Blob(o,{type:"application/octet-stream"}),c=Object.keys(a),d=Object.keys(r);if(c.length>0&&(s.extensionsUsed=c),d.length>0&&(s.extensionsRequired=d),s.buffers&&s.buffers.length>0&&(s.buffers[0].byteLength=l.size),!0===i.binary){const e=new FileReader;e.readAsArrayBuffer(l),e.onloadend=function(){const i=fa(e.result),n=new DataView(new ArrayBuffer(la));n.setUint32(0,i.byteLength,!0),n.setUint32(4,da,!0);const o=fa(pa(JSON.stringify(s)),32),a=new DataView(new ArrayBuffer(la));a.setUint32(0,o.byteLength,!0),a.setUint32(4,ca,!0);const r=new ArrayBuffer(sa),l=new DataView(r);l.setUint32(0,aa,!0),l.setUint32(4,ra,!0);const c=sa+a.byteLength+o.byteLength+n.byteLength+i.byteLength;l.setUint32(8,c,!0);const d=new Blob([r,a,o,n,i],{type:"application/octet-stream"}),u=new FileReader;u.readAsArrayBuffer(d),u.onloadend=function(){t(u.result)}}}else if(s.buffers&&s.buffers.length>0){const e=new FileReader;e.readAsDataURL(l),e.onloadend=function(){const i=e.result;s.buffers[0].uri=i,t(s)}}else t(s)}serializeUserData(e,t){if(0===Object.keys(e.userData).length)return;const i=this.options,n=this.extensionsUsed;try{const o=JSON.parse(JSON.stringify(e.userData));if(i.includeCustomExtensions&&o.gltfExtensions){void 0===t.extensions&&(t.extensions={});for(const e in o.gltfExtensions)t.extensions[e]=o.gltfExtensions[e],n[e]=!0;delete o.gltfExtensions}Object.keys(o).length>0&&(t.extras=o)}catch(o){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+o.message)}}getUID(e,t=!1){if(!1===this.uids.has(e)){const t=new Map;t.set(!0,this.uid++),t.set(!1,this.uid++),this.uids.set(e,t)}const i=this.uids.get(e);return i.get(t)}isNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return!1;const i=new X.Vector3;for(let n=0,o=e.count;n<o;n++)if(Math.abs(i.fromBufferAttribute(e,n).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const i=e.clone(),n=new X.Vector3;for(let o=0,s=i.count;o<s;o++)n.fromBufferAttribute(i,o),0===n.x&&0===n.y&&0===n.z?n.setX(1):n.normalize(),i.setXYZ(o,n.x,n.y,n.z);return t.attributesNormalized.set(e,i),i}applyTextureTransform(e,t){let i=!1;const n={};0===t.offset.x&&0===t.offset.y||(n.offset=t.offset.toArray(),i=!0),0!==t.rotation&&(n.rotation=t.rotation,i=!0),1===t.repeat.x&&1===t.repeat.y||(n.scale=t.repeat.toArray(),i=!0),i&&(e.extensions=e.extensions||{},e.extensions["KHR_texture_transform"]=n,this.extensionsUsed["KHR_texture_transform"]=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function i(e){return e.colorSpace===X.SRGBColorSpace?function(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}:function(e){return e}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof X.CompressedTexture&&(e=qs(e)),t instanceof X.CompressedTexture&&(t=qs(t));const n=e?e.image:null,o=t?t.image:null,s=Math.max(n?n.width:0,o?o.width:0),a=Math.max(n?n.height:0,o?o.height:0),r=ya();r.width=s,r.height=a;const l=r.getContext("2d");l.fillStyle="#00ffff",l.fillRect(0,0,s,a);const c=l.getImageData(0,0,s,a);if(n){l.drawImage(n,0,0,s,a);const t=i(e),o=l.getImageData(0,0,s,a).data;for(let e=2;e<o.length;e+=4)c.data[e]=256*t(o[e]/256)}if(o){l.drawImage(o,0,0,s,a);const e=i(t),n=l.getImageData(0,0,s,a).data;for(let t=1;t<n.length;t+=4)c.data[t]=256*e(n[t]/256)}l.putImageData(c,0,0);const d=e||t,u=d.clone();return u.source=new X.Source(r),u.colorSpace=X.NoColorSpace,u.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),u}processBuffer(e){const t=this.json,i=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),i.push(e),0}processBufferView(e,t,i,n,o){const s=this.json;let a;switch(s.bufferViews||(s.bufferViews=[]),t){case ea.BYTE:case ea.UNSIGNED_BYTE:a=1;break;case ea.SHORT:case ea.UNSIGNED_SHORT:a=2;break;default:a=4}const r=ga(n*e.itemSize*a),l=new DataView(new ArrayBuffer(r));let c=0;for(let p=i;p<i+n;p++)for(let i=0;i<e.itemSize;i++){let n;e.itemSize>4?n=e.array[p*e.itemSize+i]:(0===i?n=e.getX(p):1===i?n=e.getY(p):2===i?n=e.getZ(p):3===i&&(n=e.getW(p)),!0===e.normalized&&(n=X.MathUtils.normalize(n,e.array))),t===ea.FLOAT?l.setFloat32(c,n,!0):t===ea.INT?l.setInt32(c,n,!0):t===ea.UNSIGNED_INT?l.setUint32(c,n,!0):t===ea.SHORT?l.setInt16(c,n,!0):t===ea.UNSIGNED_SHORT?l.setUint16(c,n,!0):t===ea.BYTE?l.setInt8(c,n):t===ea.UNSIGNED_BYTE&&l.setUint8(c,n),c+=a}const d={buffer:this.processBuffer(l.buffer),byteOffset:this.byteOffset,byteLength:r};void 0!==o&&(d.target=o),o===ea.ARRAY_BUFFER&&(d.byteStride=e.itemSize*a),this.byteOffset+=r,s.bufferViews.push(d);const u={id:s.bufferViews.length-1,byteLength:0};return u}processBufferViewImage(e){const t=this,i=t.json;return i.bufferViews||(i.bufferViews=[]),new Promise((function(n){const o=new FileReader;o.readAsArrayBuffer(e),o.onloadend=function(){const e=fa(o.result),s={buffer:t.processBuffer(e),byteOffset:t.byteOffset,byteLength:e.byteLength};t.byteOffset+=e.byteLength,n(i.bufferViews.push(s)-1)}}))}processAccessor(e,t,i,n){const o=this.json,s={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let a;if(e.array.constructor===Float32Array)a=ea.FLOAT;else if(e.array.constructor===Int32Array)a=ea.INT;else if(e.array.constructor===Uint32Array)a=ea.UNSIGNED_INT;else if(e.array.constructor===Int16Array)a=ea.SHORT;else if(e.array.constructor===Uint16Array)a=ea.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)a=ea.BYTE;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);a=ea.UNSIGNED_BYTE}if(void 0===i&&(i=0),void 0!==n&&n!==1/0||(n=e.count),0===n)return null;const r=ma(e,i,n);let l;void 0!==t&&(l=e===t.index?ea.ELEMENT_ARRAY_BUFFER:ea.ARRAY_BUFFER);const c=this.processBufferView(e,a,i,n,l),d={bufferView:c.id,byteOffset:c.byteOffset,componentType:a,count:n,max:r.max,min:r.min,type:s[e.itemSize]};return!0===e.normalized&&(d.normalized=!0),o.accessors||(o.accessors=[]),o.accessors.push(d)-1}processImage(e,t,i,n="image/png"){if(null!==e){const o=this,s=o.cache,a=o.json,r=o.options,l=o.pending;s.images.has(e)||s.images.set(e,{});const c=s.images.get(e),d=n+":flipY/"+i.toString();if(void 0!==c[d])return c[d];a.images||(a.images=[]);const u={mimeType:n},p=ya();p.width=Math.min(e.width,r.maxTextureSize),p.height=Math.min(e.height,r.maxTextureSize);const h=p.getContext("2d");if(!0===i&&(h.translate(0,p.height),h.scale(1,-1)),void 0!==e.data){t!==X.RGBAFormat&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>r.maxTextureSize||e.height>r.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const i=new Uint8ClampedArray(e.height*e.width*4);for(let t=0;t<i.length;t+=4)i[t+0]=e.data[t+0],i[t+1]=e.data[t+1],i[t+2]=e.data[t+2],i[t+3]=e.data[t+3];h.putImageData(new ImageData(i,e.width,e.height),0,0)}else h.drawImage(e,0,0,p.width,p.height);!0===r.binary?l.push(ba(p,n).then((e=>o.processBufferViewImage(e))).then((e=>{u.bufferView=e}))):void 0!==p.toDataURL?u.uri=p.toDataURL(n):l.push(ba(p,n).then((e=>(new FileReader).readAsDataURL(e))).then((e=>{u.uri=e})));const m=a.images.push(u)-1;return c[d]=m,m}throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const i={magFilter:ia[e.magFilter],minFilter:ia[e.minFilter],wrapS:ia[e.wrapS],wrapT:ia[e.wrapT]};return t.samplers.push(i)-1}processTexture(e){const t=this,i=t.options,n=this.cache,o=this.json;if(n.textures.has(e))return n.textures.get(e);o.textures||(o.textures=[]),e instanceof X.CompressedTexture&&(e=qs(e,i.maxTextureSize));let s=e.userData.mimeType;"image/webp"===s&&(s="image/png");const a={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,s)};e.name&&(a.name=e.name),this._invokeAll((function(t){t.writeTexture&&t.writeTexture(e,a)}));const r=o.textures.push(a)-1;return n.textures.set(e,r),r}processMaterial(e){const t=this.cache,i=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);const n={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const o=e.color.toArray().concat([e.opacity]);if(ua(o,[1,1,1,1])||(n.pbrMetallicRoughness.baseColorFactor=o),e.isMeshStandardMaterial?(n.pbrMetallicRoughness.metallicFactor=e.metalness,n.pbrMetallicRoughness.roughnessFactor=e.roughness):(n.pbrMetallicRoughness.metallicFactor=.5,n.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const t=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),i={index:this.processTexture(t),channel:t.channel};this.applyTextureTransform(i,t),n.pbrMetallicRoughness.metallicRoughnessTexture=i}if(e.map){const t={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(t,e.map),n.pbrMetallicRoughness.baseColorTexture=t}if(e.emissive){const t=e.emissive,i=Math.max(t.r,t.g,t.b);if(i>0&&(n.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const t={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(t,e.emissiveMap),n.emissiveTexture=t}}if(e.normalMap){const t={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&1!==e.normalScale.x&&(t.scale=e.normalScale.x),this.applyTextureTransform(t,e.normalMap),n.normalTexture=t}if(e.aoMap){const t={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};1!==e.aoMapIntensity&&(t.strength=e.aoMapIntensity),this.applyTextureTransform(t,e.aoMap),n.occlusionTexture=t}e.transparent?n.alphaMode="BLEND":e.alphaTest>0&&(n.alphaMode="MASK",n.alphaCutoff=e.alphaTest),e.side===X.DoubleSide&&(n.doubleSided=!0),""!==e.name&&(n.name=e.name),this.serializeUserData(e,n),this._invokeAll((function(t){t.writeMaterial&&t.writeMaterial(e,n)}));const s=i.materials.push(n)-1;return t.materials.set(e,s),s}processMesh(e){const t=this.cache,i=this.json,n=[e.geometry.uuid];if(Array.isArray(e.material))for(let v=0,k=e.material.length;v<k;v++)n.push(e.material[v].uuid);else n.push(e.material.uuid);const o=n.join(":");if(t.meshes.has(o))return t.meshes.get(o);const s=e.geometry;let a;a=e.isLineSegments?ea.LINES:e.isLineLoop?ea.LINE_LOOP:e.isLine?ea.LINE_STRIP:e.isPoints?ea.POINTS:e.material.wireframe?ea.LINES:ea.TRIANGLES;const r={},l={},c=[],d=[],u={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},p=s.getAttribute("normal");void 0===p||this.isNormalizedNormalAttribute(p)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),s.setAttribute("normal",this.createNormalizedNormalAttribute(p)));let h=null;for(let v in s.attributes){if("morph"===v.slice(0,5))continue;const e=s.attributes[v];v=u[v]||v.toUpperCase();const i=/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/;if(i.test(v)||(v="_"+v),t.attributes.has(this.getUID(e))){l[v]=t.attributes.get(this.getUID(e));continue}h=null;const n=e.array;"JOINTS_0"!==v||n instanceof Uint16Array||n instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),h=new X.BufferAttribute(new Uint16Array(n),e.itemSize,e.normalized));const o=this.processAccessor(h||e,s);null!==o&&(v.startsWith("_")||this.detectMeshQuantization(v,e),l[v]=o,t.attributes.set(this.getUID(e),o))}if(void 0!==p&&s.setAttribute("normal",p),0===Object.keys(l).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){const i=[],n=[],o={};if(void 0!==e.morphTargetDictionary)for(const t in e.morphTargetDictionary)o[e.morphTargetDictionary[t]]=t;for(let a=0;a<e.morphTargetInfluences.length;++a){const r={};let l=!1;for(const e in s.morphAttributes){if("position"!==e&&"normal"!==e){l||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),l=!0);continue}const i=s.morphAttributes[e][a],n=e.toUpperCase(),o=s.attributes[e];if(t.attributes.has(this.getUID(i,!0))){r[n]=t.attributes.get(this.getUID(i,!0));continue}const c=i.clone();if(!s.morphTargetsRelative)for(let e=0,t=i.count;e<t;e++)for(let n=0;n<i.itemSize;n++)0===n&&c.setX(e,i.getX(e)-o.getX(e)),1===n&&c.setY(e,i.getY(e)-o.getY(e)),2===n&&c.setZ(e,i.getZ(e)-o.getZ(e)),3===n&&c.setW(e,i.getW(e)-o.getW(e));r[n]=this.processAccessor(c,s),t.attributes.set(this.getUID(o,!0),r[n])}d.push(r),i.push(e.morphTargetInfluences[a]),void 0!==e.morphTargetDictionary&&n.push(o[a])}r.weights=i,n.length>0&&(r.extras={},r.extras.targetNames=n)}const m=Array.isArray(e.material);if(m&&0===s.groups.length)return null;let g=!1;if(m&&null===s.index){const e=[];for(let t=0,i=s.attributes.position.count;t<i;t++)e[t]=t;s.setIndex(e),g=!0}const f=m?e.material:[e.material],y=m?s.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let v=0,k=y.length;v<k;v++){const e={mode:a,attributes:l};if(this.serializeUserData(s,e),d.length>0&&(e.targets=d),null!==s.index){let i=this.getUID(s.index);void 0===y[v].start&&void 0===y[v].count||(i+=":"+y[v].start+":"+y[v].count),t.attributes.has(i)?e.indices=t.attributes.get(i):(e.indices=this.processAccessor(s.index,s,y[v].start,y[v].count),t.attributes.set(i,e.indices)),null===e.indices&&delete e.indices}const i=this.processMaterial(f[y[v].materialIndex]);null!==i&&(e.material=i),c.push(e)}!0===g&&s.setIndex(null),r.primitives=c,i.meshes||(i.meshes=[]),this._invokeAll((function(t){t.writeMesh&&t.writeMesh(e,r)}));const b=i.meshes.push(r)-1;return t.meshes.set(o,b),b}detectMeshQuantization(e,t){if(this.extensionsUsed[ta])return;let i;switch(t.array.constructor){case Int8Array:i="byte";break;case Uint8Array:i="unsigned byte";break;case Int16Array:i="short";break;case Uint16Array:i="unsigned short";break;default:return}t.normalized&&(i+=" normalized");const n=e.split("_",1)[0];$s[n]&&$s[n].includes(i)&&(this.extensionsUsed[ta]=!0,this.extensionsRequired[ta]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const i=e.isOrthographicCamera,n={type:i?"orthographic":"perspective"};return i?n.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:n.perspective={aspectRatio:e.aspect,yfov:X.MathUtils.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(n.name=e.type),t.cameras.push(n)-1}processAnimation(e,t){const i=this.json,n=this.nodeMap;i.animations||(i.animations=[]),e=Js.Utils.mergeMorphTargetTracks(e.clone(),t);const o=e.tracks,s=[],a=[];for(let r=0;r<o.length;++r){const e=o[r],i=X.PropertyBinding.parseTrackName(e.name);let l=X.PropertyBinding.findNode(t,i.nodeName);const c=na[i.propertyName];if("bones"===i.objectName&&(l=!0===l.isSkinnedMesh?l.skeleton.getBoneByName(i.objectIndex):void 0),!l||!c)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',e.name),null;const d=1;let u,p=e.values.length/e.times.length;c===na.morphTargetInfluences&&(p/=l.morphTargetInfluences.length),!0===e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(u="CUBICSPLINE",p/=3):u=e.getInterpolation()===X.InterpolateDiscrete?"STEP":"LINEAR",a.push({input:this.processAccessor(new X.BufferAttribute(e.times,d)),output:this.processAccessor(new X.BufferAttribute(e.values,p)),interpolation:u}),s.push({sampler:a.length-1,target:{node:n.get(l),path:c}})}return i.animations.push({name:e.name||"clip_"+i.animations.length,samplers:a,channels:s}),i.animations.length-1}processSkin(e){const t=this.json,i=this.nodeMap,n=t.nodes[i.get(e)],o=e.skeleton;if(void 0===o)return null;const s=e.skeleton.bones[0];if(void 0===s)return null;const a=[],r=new Float32Array(16*o.bones.length),l=new X.Matrix4;for(let d=0;d<o.bones.length;++d)a.push(i.get(o.bones[d])),l.copy(o.boneInverses[d]),l.multiply(e.bindMatrix).toArray(r,16*d);void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new X.BufferAttribute(r,16)),joints:a,skeleton:i.get(s)});const c=n.skin=t.skins.length-1;return c}processNode(e){const t=this.json,i=this.options,n=this.nodeMap;t.nodes||(t.nodes=[]);const o={};if(i.trs){const t=e.quaternion.toArray(),i=e.position.toArray(),n=e.scale.toArray();ua(t,[0,0,0,1])||(o.rotation=t),ua(i,[0,0,0])||(o.translation=i),ua(n,[1,1,1])||(o.scale=n)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===ha(e.matrix)&&(o.matrix=e.matrix.elements);if(""!==e.name&&(o.name=String(e.name)),this.serializeUserData(e,o),e.isMesh||e.isLine||e.isPoints){const t=this.processMesh(e);null!==t&&(o.mesh=t)}else e.isCamera&&(o.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const t=[];for(let n=0,o=e.children.length;n<o;n++){const o=e.children[n];if(o.visible||!1===i.onlyVisible){const e=this.processNode(o);null!==e&&t.push(e)}}t.length>0&&(o.children=t)}this._invokeAll((function(t){t.writeNode&&t.writeNode(e,o)}));const s=t.nodes.push(o)-1;return n.set(e,s),s}processScene(e){const t=this.json,i=this.options;t.scenes||(t.scenes=[],t.scene=0);const n={};""!==e.name&&(n.name=e.name),t.scenes.push(n);const o=[];for(let s=0,a=e.children.length;s<a;s++){const t=e.children[s];if(t.visible||!1===i.onlyVisible){const e=this.processNode(t);null!==e&&o.push(e)}}o.length>0&&(n.nodes=o),this.serializeUserData(e,n)}processObjects(e){const t=new X.Scene;t.name="AuxScene";for(let i=0;i<e.length;i++)t.children.push(e[i]);this.processScene(t)}processInput(e){const t=this.options;e=e instanceof Array?e:[e],this._invokeAll((function(t){t.beforeParse&&t.beforeParse(e)}));const i=[];for(let n=0;n<e.length;n++)e[n]instanceof X.Scene?this.processScene(e[n]):i.push(e[n]);i.length>0&&this.processObjects(i);for(let n=0;n<this.skins.length;++n)this.processSkin(this.skins[n]);for(let n=0;n<t.animations.length;++n)this.processAnimation(t.animations[n],e[0]);this._invokeAll((function(t){t.afterParse&&t.afterParse(e)}))}_invokeAll(e){for(let t=0,i=this.plugins.length;t<i;t++)e(this.plugins[t])}}class ka{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight)return void console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);const i=this.writer,n=i.json,o=i.extensionsUsed,s={};e.name&&(s.name=e.name),s.color=e.color.toArray(),s.intensity=e.intensity,e.isDirectionalLight?s.type="directional":e.isPointLight?(s.type="point",e.distance>0&&(s.range=e.distance)):e.isSpotLight&&(s.type="spot",e.distance>0&&(s.range=e.distance),s.spot={},s.spot.innerConeAngle=(1-e.penumbra)*e.angle,s.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),o[this.name]||(n.extensions=n.extensions||{},n.extensions[this.name]={lights:[]},o[this.name]=!0);const a=n.extensions[this.name].lights;a.push(s),t.extensions=t.extensions||{},t.extensions[this.name]={light:a.length-1}}}class wa{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}writeMaterial(e,t){if(!e.isMeshBasicMaterial)return;const i=this.writer,n=i.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},n[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}class La{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;const i=this.writer,n=i.extensionsUsed,o={};if(o.clearcoatFactor=e.clearcoat,e.clearcoatMap){const t={index:i.processTexture(e.clearcoatMap),texCoord:e.clearcoatMap.channel};i.applyTextureTransform(t,e.clearcoatMap),o.clearcoatTexture=t}if(o.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const t={index:i.processTexture(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};i.applyTextureTransform(t,e.clearcoatRoughnessMap),o.clearcoatRoughnessTexture=t}if(e.clearcoatNormalMap){const t={index:i.processTexture(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};i.applyTextureTransform(t,e.clearcoatNormalMap),o.clearcoatNormalTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class xa{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;const i=this.writer,n=i.extensionsUsed,o={};if(o.iridescenceFactor=e.iridescence,e.iridescenceMap){const t={index:i.processTexture(e.iridescenceMap),texCoord:e.iridescenceMap.channel};i.applyTextureTransform(t,e.iridescenceMap),o.iridescenceTexture=t}if(o.iridescenceIor=e.iridescenceIOR,o.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],o.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const t={index:i.processTexture(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};i.applyTextureTransform(t,e.iridescenceThicknessMap),o.iridescenceThicknessTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class Ma{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const i=this.writer,n=i.extensionsUsed,o={};if(o.transmissionFactor=e.transmission,e.transmissionMap){const t={index:i.processTexture(e.transmissionMap),texCoord:e.transmissionMap.channel};i.applyTextureTransform(t,e.transmissionMap),o.transmissionTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class _a{constructor(e){this.writer=e,this.name="KHR_materials_volume"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const i=this.writer,n=i.extensionsUsed,o={};if(o.thicknessFactor=e.thickness,e.thicknessMap){const t={index:i.processTexture(e.thicknessMap),texCoord:e.thicknessMap.channel};i.applyTextureTransform(t,e.thicknessMap),o.thicknessTexture=t}o.attenuationDistance=e.attenuationDistance,o.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class Fa{constructor(e){this.writer=e,this.name="KHR_materials_ior"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;const i=this.writer,n=i.extensionsUsed,o={};o.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class Ca{constructor(e){this.writer=e,this.name="KHR_materials_specular"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(oa)&&!e.specularIntensityMap&&!e.specularColorMap)return;const i=this.writer,n=i.extensionsUsed,o={};if(e.specularIntensityMap){const t={index:i.processTexture(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};i.applyTextureTransform(t,e.specularIntensityMap),o.specularTexture=t}if(e.specularColorMap){const t={index:i.processTexture(e.specularColorMap),texCoord:e.specularColorMap.channel};i.applyTextureTransform(t,e.specularColorMap),o.specularColorTexture=t}o.specularFactor=e.specularIntensity,o.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class Sa{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;const i=this.writer,n=i.extensionsUsed,o={};if(e.sheenRoughnessMap){const t={index:i.processTexture(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};i.applyTextureTransform(t,e.sheenRoughnessMap),o.sheenRoughnessTexture=t}if(e.sheenColorMap){const t={index:i.processTexture(e.sheenColorMap),texCoord:e.sheenColorMap.channel};i.applyTextureTransform(t,e.sheenColorMap),o.sheenColorTexture=t}o.sheenRoughnessFactor=e.sheenRoughness,o.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class Aa{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.anisotropy)return;const i=this.writer,n=i.extensionsUsed,o={};if(e.anisotropyMap){const t={index:i.processTexture(e.anisotropyMap)};i.applyTextureTransform(t,e.anisotropyMap),o.anisotropyTexture=t}o.anisotropyStrength=e.anisotropy,o.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class Ea{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;const i=this.writer,n=i.extensionsUsed,o={};o.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class Ta{constructor(e){this.writer=e,this.name="EXT_materials_bump"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.bumpScale&&!e.bumpMap)return;const i=this.writer,n=i.extensionsUsed,o={};if(e.bumpMap){const t={index:i.processTexture(e.bumpMap),texCoord:e.bumpMap.channel};i.applyTextureTransform(t,e.bumpMap),o.bumpTexture=t}o.bumpFactor=e.bumpScale,t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class Ia{constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}writeNode(e,t){if(!e.isInstancedMesh)return;const i=this.writer,n=e,o=new Float32Array(3*n.count),s=new Float32Array(4*n.count),a=new Float32Array(3*n.count),r=new X.Matrix4,l=new X.Vector3,c=new X.Quaternion,d=new X.Vector3;for(let p=0;p<n.count;p++)n.getMatrixAt(p,r),r.decompose(l,c,d),l.toArray(o,3*p),c.toArray(s,4*p),d.toArray(a,3*p);const u={TRANSLATION:i.processAccessor(new X.BufferAttribute(o,3)),ROTATION:i.processAccessor(new X.BufferAttribute(s,4)),SCALE:i.processAccessor(new X.BufferAttribute(a,3))};n.instanceColor&&(u._COLOR_0=i.processAccessor(n.instanceColor)),t.extensions=t.extensions||{},t.extensions[this.name]={attributes:u},i.extensionsUsed[this.name]=!0,i.extensionsRequired[this.name]=!0}}Js.Utils={insertKeyframe:function(e,t){const i=.001,n=e.getValueSize(),o=new e.TimeBufferType(e.times.length+1),s=new e.ValueBufferType(e.values.length+n),a=e.createInterpolant(new e.ValueBufferType(n));let r;if(0===e.times.length){o[0]=t;for(let e=0;e<n;e++)s[e]=0;r=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<i)return 0;o[0]=t,o.set(e.times,1),s.set(a.evaluate(t),0),s.set(e.values,n),r=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<i)return e.times.length-1;o[o.length-1]=t,o.set(e.times,0),s.set(e.values,0),s.set(a.evaluate(t),e.values.length),r=o.length-1}else for(let l=0;l<e.times.length;l++){if(Math.abs(e.times[l]-t)<i)return l;if(e.times[l]<t&&e.times[l+1]>t){o.set(e.times.slice(0,l+1),0),o[l+1]=t,o.set(e.times.slice(l+1),l+2),s.set(e.values.slice(0,(l+1)*n),0),s.set(a.evaluate(t),(l+1)*n),s.set(e.values.slice((l+1)*n),(l+2)*n),r=l+1;break}}return e.times=o,e.values=s,r},mergeMorphTargetTracks:function(e,t){const i=[],n={},o=e.tracks;for(let s=0;s<o.length;++s){let e=o[s];const a=X.PropertyBinding.parseTrackName(e.name),r=X.PropertyBinding.findNode(t,a.nodeName);if("morphTargetInfluences"!==a.propertyName||void 0===a.propertyIndex){i.push(e);continue}if(e.createInterpolant!==e.InterpolantFactoryMethodDiscrete&&e.createInterpolant!==e.InterpolantFactoryMethodLinear){if(e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),e=e.clone(),e.setInterpolation(X.InterpolateLinear)}const l=r.morphTargetInfluences.length,c=r.morphTargetDictionary[a.propertyIndex];if(void 0===c)throw new Error("THREE.GLTFExporter: Morph target name not found: "+a.propertyIndex);let d;if(void 0===n[r.uuid]){d=e.clone();const t=new d.ValueBufferType(l*d.times.length);for(let e=0;e<d.times.length;e++)t[e*l+c]=d.values[e];d.name=(a.nodeName||"")+".morphTargetInfluences",d.values=t,n[r.uuid]=d,i.push(d);continue}const u=e.createInterpolant(new e.ValueBufferType(1));d=n[r.uuid];for(let t=0;t<d.times.length;t++)d.values[t*l+c]=u.evaluate(d.times[t]);for(let t=0;t<e.times.length;t++){const i=this.insertKeyframe(d,e.times[t]);d.values[i*l+c]=e.values[t]}}return e.tracks=i,e}};var Ra=i(514);class Va extends X.DataTextureLoader{constructor(e){super(e),this.type=X.HalfFloatType}parse(e){const t=1,i=2,n=3,o=4,s=function(e,s){switch(e){case t:throw new Error("THREE.RGBELoader: Read Error: "+(s||""));case i:throw new Error("THREE.RGBELoader: Write Error: "+(s||""));case n:throw new Error("THREE.RGBELoader: Bad File Format: "+(s||""));default:case o:throw new Error("THREE.RGBELoader: Memory Error: "+(s||""))}},a=1,r=2,l=4,c="\n",d=function(e,t,i){const n=128;t=t||1024;let o=e.pos,s=-1,a=0,r="",l=String.fromCharCode.apply(null,new Uint16Array(e.subarray(o,o+n)));while(0>(s=l.indexOf(c))&&a<t&&o<e.byteLength)r+=l,a+=l.length,o+=n,l+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(o,o+n)));return-1<s&&(!1!==i&&(e.pos+=a+s+1),r+l.slice(0,s))},u=function(e){const i=/^#\?(\S+)/,o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,c=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,u=/^\s*FORMAT=(\S+)\s*$/,p=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,h={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let m,g;(e.pos>=e.byteLength||!(m=d(e)))&&s(t,"no header found"),(g=m.match(i))||s(n,"bad initial token"),h.valid|=a,h.programtype=g[1],h.string+=m+"\n";while(1){if(m=d(e),!1===m)break;if(h.string+=m+"\n","#"!==m.charAt(0)){if((g=m.match(o))&&(h.gamma=parseFloat(g[1])),(g=m.match(c))&&(h.exposure=parseFloat(g[1])),(g=m.match(u))&&(h.valid|=r,h.format=g[1]),(g=m.match(p))&&(h.valid|=l,h.height=parseInt(g[1],10),h.width=parseInt(g[2],10)),h.valid&r&&h.valid&l)break}else h.comments+=m+"\n"}return h.valid&r||s(n,"missing format specifier"),h.valid&l||s(n,"missing image size specifier"),h},p=function(e,i,a){const r=i;if(r<8||r>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);r!==(e[2]<<8|e[3])&&s(n,"wrong scanline width");const l=new Uint8Array(4*i*a);l.length||s(o,"unable to allocate buffer space");let c=0,d=0;const u=4*r,p=new Uint8Array(4),h=new Uint8Array(u);let m=a;while(m>0&&d<e.byteLength){d+4>e.byteLength&&s(t),p[0]=e[d++],p[1]=e[d++],p[2]=e[d++],p[3]=e[d++],2==p[0]&&2==p[1]&&(p[2]<<8|p[3])==r||s(n,"bad rgbe scanline format");let i,o=0;while(o<u&&d<e.byteLength){i=e[d++];const t=i>128;if(t&&(i-=128),(0===i||o+i>u)&&s(n,"bad scanline data"),t){const t=e[d++];for(let e=0;e<i;e++)h[o++]=t}else h.set(e.subarray(d,d+i),o),o+=i,d+=i}const a=r;for(let e=0;e<a;e++){let t=0;l[c]=h[e+t],t+=r,l[c+1]=h[e+t],t+=r,l[c+2]=h[e+t],t+=r,l[c+3]=h[e+t],c+=4}m--}return l},h=function(e,t,i,n){const o=e[t+3],s=Math.pow(2,o-128)/255;i[n+0]=e[t+0]*s,i[n+1]=e[t+1]*s,i[n+2]=e[t+2]*s,i[n+3]=1},m=function(e,t,i,n){const o=e[t+3],s=Math.pow(2,o-128)/255;i[n+0]=X.DataUtils.toHalfFloat(Math.min(e[t+0]*s,65504)),i[n+1]=X.DataUtils.toHalfFloat(Math.min(e[t+1]*s,65504)),i[n+2]=X.DataUtils.toHalfFloat(Math.min(e[t+2]*s,65504)),i[n+3]=X.DataUtils.toHalfFloat(1)},g=new Uint8Array(e);g.pos=0;const f=u(g),y=f.width,b=f.height,v=p(g.subarray(g.pos),y,b);let k,w,L;switch(this.type){case X.FloatType:L=v.length/4;const e=new Float32Array(4*L);for(let i=0;i<L;i++)h(v,4*i,e,4*i);k=e,w=X.FloatType;break;case X.HalfFloatType:L=v.length/4;const t=new Uint16Array(4*L);for(let i=0;i<L;i++)m(v,4*i,t,4*i);k=t,w=X.HalfFloatType;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:y,height:b,data:k,header:f.string,gamma:f.gamma,exposure:f.exposure,type:w}}setDataType(e){return this.type=e,this}load(e,t,i,n){function o(e,i){switch(e.type){case X.FloatType:case X.HalfFloatType:e.colorSpace=X.LinearSRGBColorSpace,e.minFilter=X.LinearFilter,e.magFilter=X.LinearFilter,e.generateMipmaps=!1,e.flipY=!0;break}t&&t(e,i)}return super.load(e,o,i,n)}}function Pa(e){this.scene.background=new X.Color(e)}function Ua(e){const t=(new X.TextureLoader).load(e);this.scene.background=t,this.scene.backgroundIntensity=1,t.dispose()}function za(e){return new Promise((t=>{const{blurriness:i,intensity:n,viewImg:o}=e,s=(new X.TextureLoader).load(o);s.mapping=X.EquirectangularReflectionMapping,this.scene.background=s,this.scene.environment=s,this.scene.backgroundIntensity=n,this.scene.backgroundBlurriness=i,s.dispose(),t()}))}function Ha(e){const{blurriness:t,intensity:i}=e;this.scene.backgroundIntensity=i,this.scene.backgroundBlurriness=t}function Wa(e,t){return new Promise((async i=>{let n,o;n="hdr"==t?new Va:new X.TextureLoader,o=await n.loadAsync(e),o.mapping=X.EquirectangularReflectionMapping,this.scene.background=o,this.scene.environment=o,o.dispose(),i()}))}var Oa={onSetSceneColor:Pa,onSetSceneImage:Ua,onSetSceneViewImage:za,onSetSceneViewConfig:Ha,onSetStorageViewImage:Wa};const Da=l();function Ga(){this.modelMaterialList=[];let e=0;this.model.traverse((t=>{t.isMesh&&t.material&&(t.castShadow=!0,t.frustumCulled=!1,Array.isArray(t.material)?(t.material=t.material[0],this.setMaterialMeshParams(t,e)):this.setMaterialMeshParams(t,e))}))}function Na(e,t){const i=e.clone();Object.assign(e.userData,{rotation:i.rotation,scale:i.scale,position:i.position});const n=e.material.clone();e.mapId=e.name+"_"+t,e.material=n;const{mapId:o,uuid:s,userData:a,type:r,name:l,isMesh:c,visible:d}=e,{color:u,wireframe:p,depthWrite:h,opacity:m}=e.material,g={color:u,wireframe:p,depthWrite:h,opacity:m},f={mapId:o,uuid:s,userData:a,type:r,name:l,isMesh:c,visible:d,material:g};this.modelMaterialList.push(f);const y=e.material.clone();y.userData.mapId=e.name+"_"+t,this.originalMaterials.set(e.uuid,y)}function Ba(){this.model.updateMatrixWorld();const e=(new X.Box3).setFromObject(this.model),t=e.getSize(new X.Vector3),i=e.getCenter(new X.Vector3),n=Math.max(t.x,t.y,t.z),o=2.5,s=o/(n>1?n:.5);this.model.scale.set(s,s,s),this.model.position.sub(i.multiplyScalar(s)),this.controls.maxDistance=10*t.length(),this.camera.position.set(0,2,6),this.camera.updateProjectionMatrix()}function ja(e){let t={};return e.forEach((e=>{if(e.map&&e.map.image){const i=document.createElement("canvas");i.width=75,i.height=75;const n=i.getContext("2d");n.drawImage(e.map.image,0,0),t={url:i.toDataURL("image/png",.5)},i.remove()}})),t}function Xa(e){const{color:t,wireframe:i,depthWrite:n,opacity:o}=JSON.parse(JSON.stringify(e)),s=Da.selectMesh.uuid,a=this.scene.getObjectByProperty("uuid",s);if(a&&a.material){const{name:e,map:s}=a.material;Object.assign(a.material,{map:s,name:e,transparent:!0,color:new X.Color(t),wireframe:i,depthWrite:n,opacity:o})}const r=this.modelMaterialList.find((e=>e.uuid==s))||{};Object.assign(r.material,{color:new X.Color(t),wireframe:i,depthWrite:n,opacity:o})}function Ya(e){const t=this.scene.getObjectByProperty("uuid",e.uuid);t.visible=e.visible}function Qa({mapId:e,meshName:t}){const i=Da.selectMesh.uuid,n=this.scene.getObjectByProperty("uuid",i),o=this.originalMaterials.get(i);n.material=o.clone(),n.mapId=e,n.meshFrom=t}function Ka({id:e,url:t}){return new Promise((i=>{const n=Da.selectMesh.uuid,o=this.scene.getObjectByProperty("uuid",n),s=(new X.TextureLoader).load(t),a=o.material.clone();a.map=s,a.map.wrapS=X.MirroredRepeatWrapping,a.map.wrapT=X.MirroredRepeatWrapping,a.map.flipY=!1,a.map.colorSpace=X.SRGBColorSpace,a.map.minFilter=X.LinearFilter,a.map.magFilter=X.LinearFilter,o.material=a,o.mapId=e,o.meshFrom=e,s.dispose(),i()}))}function Za(e,t){return new Promise((async i=>{const n=Da.selectMesh.uuid,o=this.scene.getObjectByProperty("uuid",n);let s,a;s="hdr"==t?new Va:new X.TextureLoader,a=await s.loadAsync(e);const r=o.material.clone();r.map=a,r.map.wrapS=X.MirroredRepeatWrapping,r.map.wrapT=X.MirroredRepeatWrapping,r.map.flipY=!1,r.map.colorSpace=X.SRGBColorSpace,r.map.minFilter=X.LinearFilter,r.map.magFilter=X.LinearFilter,o.material=r,a.dispose(),i()}))}function qa(e){const t=this.model.getObjectByName(e);return this.outlinePass.selectedObjects=[t],Da.selectMeshAction(t),t}function $a(e){const{clientHeight:t,clientWidth:i,offsetLeft:n,offsetTop:o}=this.container;let s;if(this.mouse.x=(e.clientX-n)/i*2-1,this.mouse.y=-(e.clientY-o)/t*2+1,this.raycaster.setFromCamera(this.mouse,this.camera),this.model&&(s=this.model),this.geometryGroup.children.length&&(s=this.geometryGroup),!s)return!1;const a=this.raycaster.intersectObjects(s.children,!0),r=a.filter((e=>e.object.isMesh&&e.object.material));if(r.length>0){const e=r[0].object;if(this.outlinePass.selectedObjects=[e],Da.selectMeshAction(e),this.transformControls){const t=(new X.Box3).setFromObject(e),{dragPosition:i}=e.userData;if(i)this.transformControls.position.copy(i);else{const i=t.getCenter(new X.Vector3);e.userData.dragPosition=i,this.transformControls.position.copy(i)}this.transformControls.attach(e)}}else this.transformControls||(this.outlinePass.selectedObjects=[],Da.selectMeshAction({}))}function Ja(){const e=[];return this.model.traverse((t=>{if(t.isMesh&&t.material){const{color:i,opacity:n,depthWrite:o,wireframe:s}=t.material,a={meshName:t.name,meshFrom:t.meshFrom,color:i.getStyle(),opacity:n,depthWrite:o,wireframe:s,visible:t.visible,type:t.material.type};e.push(a)}})),e}function er(e){this.model.traverse((t=>{if(t.isMesh&&t.material){const{name:i,color:n,map:o,wireframe:s,depthWrite:a,opacity:r}=t.material;if(e.type)t.material=new X[e.type]({map:o,transparent:!0,color:n,name:i});else{const e=this.originalMaterials.get(t.uuid);t.material=e}a&&(t.material.depthWrite=a),r&&(t.material.opacity=r),s&&(t.material.wireframe=s),t.material.side=X.DoubleSide}}))}function tr(e){this.modelMaterialList=[],this.model.traverse((e=>{const{name:t}=e;e.castShadow=!0,e.frustumCulled=!1,e.isMesh&&e.material&&(this.modelMaterialList.push(e),this.originalMaterials.set(e.uuid,e.material),e.mapId=t)}))}function ir(){this.model.traverse((e=>{if(e.isMesh&&e.material){const t=this.originalMaterials.get(e.uuid);e.material=t.clone(),e.mapId=t.userData.mapId,e.visible=!0,e.meshFrom=null}})),this.modelMaterialList.forEach((e=>{e.visible=!0;const t=this.originalMaterials.get(e.uuid);e.mapId=t.userData.mapId;const{color:i,wireframe:n,depthWrite:o,opacity:s}=t;Object.assign(e.material,{color:i,wireframe:n,depthWrite:o,opacity:s})})),Da.selectMeshAction({})}var nr,or={getModelMeaterialList:Ga,setModelPositionSize:Ba,getModelMaps:ja,onSetModelMaterial:Xa,onSetModelMap:Qa,onSetSystemModelMap:Ka,onSetStorageModelMap:Za,onChangeModelMeaterial:qa,onMouseClickModel:$a,onGetEditMeshList:Ja,onChangeModelMeshType:er,onSetGeometryMeshList:tr,onSetMeshVisibe:Ya,initModelMaterial:ir,setMaterialMeshParams:Na},sr={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-sr.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*sr.Bounce.In(2*e):.5*sr.Bounce.Out(2*e-1)+.5}}};nr="undefined"===typeof self&&"undefined"!==typeof process&&process.hrtime?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!==typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};var ar=nr,rr=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},e.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},e.prototype.update=function(e,t){void 0===e&&(e=ar()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;while(i.length>0){this._tweensAddedDuringUpdate={};for(var n=0;n<i.length;n++){var o=this._tweens[i[n]],s=!t;o&&!1===o.update(e,s)&&!t&&delete this._tweens[i[n]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),lr={Linear:function(e,t){var i=e.length-1,n=i*t,o=Math.floor(n),s=lr.Utils.Linear;return t<0?s(e[0],e[1],n):t>1?s(e[i],e[i-1],i-n):s(e[o],e[o+1>i?i:o+1],n-o)},Bezier:function(e,t){for(var i=0,n=e.length-1,o=Math.pow,s=lr.Utils.Bernstein,a=0;a<=n;a++)i+=o(1-t,n-a)*o(t,a)*e[a]*s(n,a);return i},CatmullRom:function(e,t){var i=e.length-1,n=i*t,o=Math.floor(n),s=lr.Utils.CatmullRom;return e[0]===e[i]?(t<0&&(o=Math.floor(n=i*(1+t))),s(e[(o-1+i)%i],e[o],e[(o+1)%i],e[(o+2)%i],n-o)):t<0?e[0]-(s(e[0],e[0],e[1],e[1],-n)-e[0]):t>1?e[i]-(s(e[i],e[i],e[i-1],e[i-1],n-i)-e[i]):s(e[o?o-1:0],e[o],e[i<o+1?i:o+1],e[i<o+2?i:o+2],n-o)},Utils:{Linear:function(e,t,i){return(t-e)*i+e},Bernstein:function(e,t){var i=lr.Utils.Factorial;return i(e)/i(t)/i(e-t)},Factorial:function(){var e=[1];return function(t){var i=1;if(e[t])return e[t];for(var n=t;n>1;n--)i*=n;return e[t]=i,i}}(),CatmullRom:function(e,t,i,n,o){var s=.5*(i-e),a=.5*(n-t),r=o*o,l=o*r;return(2*t-2*i+s+a)*l+(-3*t+3*i-2*s-a)*r+s*o+t}}},cr=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),dr=new rr,ur=function(){function e(e,t){void 0===t&&(t=dr),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=sr.Linear.None,this._interpolationFunction=lr.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=cr.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.to=function(e,t){return this._valuesEnd=Object.create(e),void 0!==t&&(this._duration=t),this},e.prototype.duration=function(e){return this._duration=e,this},e.prototype.start=function(e){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var t in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==e?"string"===typeof e?ar()+parseFloat(e):e:ar(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},e.prototype._setupProperties=function(e,t,i,n){for(var o in i){var s=e[o],a=Array.isArray(s),r=a?"array":typeof s,l=!a&&Array.isArray(i[o]);if("undefined"!==r&&"function"!==r){if(l){var c=i[o];if(0===c.length)continue;c=c.map(this._handleRelativeValue.bind(this,s)),i[o]=[s].concat(c)}if("object"!==r&&!a||!s||l)"undefined"===typeof t[o]&&(t[o]=s),a||(t[o]*=1),n[o]=l?i[o].slice().reverse():t[o]||0;else{for(var d in t[o]=a?[]:{},s)t[o][d]=s[d];n[o]=a?[]:{},this._setupProperties(s,t[o],i[o],n[o])}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(e){return void 0===e&&(e=ar()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},e.prototype.resume=function(e){return void 0===e&&(e=ar()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return this._group=e,this},e.prototype.delay=function(e){return this._delayTime=e,this},e.prototype.repeat=function(e){return this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return this._yoyo=e,this},e.prototype.easing=function(e){return this._easingFunction=e,this},e.prototype.interpolation=function(e){return this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(e,t){if(void 0===e&&(e=ar()),void 0===t&&(t=!0),this._isPaused)return!0;var i,n,o=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>o)return!1;t&&this.start(e)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),n=(e-this._startTime)/this._duration,n=0===this._duration||n>1?1:n;var s=this._easingFunction(n);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,s),this._onUpdateCallback&&this._onUpdateCallback(this._object,n),1===n){if(this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!==typeof this._valuesEnd[i]||(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,r=this._chainedTweens.length;a<r;a++)this._chainedTweens[a].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,i,n){for(var o in i)if(void 0!==t[o]){var s=t[o]||0,a=i[o],r=Array.isArray(e[o]),l=Array.isArray(a),c=!r&&l;c?e[o]=this._interpolationFunction(a,n):"object"===typeof a&&a?this._updateProperties(e[o],s,a,n):(a=this._handleRelativeValue(s,a),"number"===typeof a&&(e[o]=s+(a-s)*n))}},e.prototype._handleRelativeValue=function(e,t){return"string"!==typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"===typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},e}(),pr="18.6.4",hr=cr.nextId,mr=dr,gr=mr.getAll.bind(mr),fr=mr.removeAll.bind(mr),yr=mr.add.bind(mr),br=mr.remove.bind(mr),vr=mr.update.bind(mr),kr={Easing:sr,Group:rr,Interpolation:lr,now:ar,Sequence:cr,nextId:hr,Tween:ur,VERSION:pr,getAll:gr,removeAll:fr,add:yr,remove:br,update:vr},wr=kr;const Lr=new X.Raycaster,xr=new X.Vector3,Mr=new X.Vector3,_r=new X.Quaternion,Fr={X:new X.Vector3(1,0,0),Y:new X.Vector3(0,1,0),Z:new X.Vector3(0,0,1)},Cr={type:"change"},Sr={type:"mouseDown"},Ar={type:"mouseUp",mode:null},Er={type:"objectChange"};class Tr extends X.Object3D{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const i=new $r;this._gizmo=i,this.add(i);const n=new Jr;this._plane=n,this.add(n);const o=this;function s(e,t){let s=t;Object.defineProperty(o,e,{get:function(){return void 0!==s?s:t},set:function(t){s!==t&&(s=t,n[e]=t,i[e]=t,o.dispatchEvent({type:e+"-changed",value:t}),o.dispatchEvent(Cr))}}),o[e]=t,n[e]=t,i[e]=t}s("camera",e),s("object",void 0),s("enabled",!0),s("axis",null),s("mode","translate"),s("translationSnap",null),s("rotationSnap",null),s("scaleSnap",null),s("space","world"),s("size",1),s("dragging",!1),s("showX",!0),s("showY",!0),s("showZ",!0);const a=new X.Vector3,r=new X.Vector3,l=new X.Quaternion,c=new X.Quaternion,d=new X.Vector3,u=new X.Quaternion,p=new X.Vector3,h=new X.Vector3,m=new X.Vector3,g=0,f=new X.Vector3;s("worldPosition",a),s("worldPositionStart",r),s("worldQuaternion",l),s("worldQuaternionStart",c),s("cameraPosition",d),s("cameraQuaternion",u),s("pointStart",p),s("pointEnd",h),s("rotationAxis",m),s("rotationAngle",g),s("eye",f),this._offset=new X.Vector3,this._startNorm=new X.Vector3,this._endNorm=new X.Vector3,this._cameraScale=new X.Vector3,this._parentPosition=new X.Vector3,this._parentQuaternion=new X.Quaternion,this._parentQuaternionInv=new X.Quaternion,this._parentScale=new X.Vector3,this._worldScaleStart=new X.Vector3,this._worldQuaternionInv=new X.Quaternion,this._worldScale=new X.Vector3,this._positionStart=new X.Vector3,this._quaternionStart=new X.Quaternion,this._scaleStart=new X.Vector3,this._getPointer=Ir.bind(this),this._onPointerDown=Vr.bind(this),this._onPointerHover=Rr.bind(this),this._onPointerMove=Pr.bind(this),this._onPointerUp=Ur.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;Lr.setFromCamera(e,this.camera);const t=zr(this._gizmo.picker[this.mode],Lr);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){Lr.setFromCamera(e,this.camera);const t=zr(this._plane,Lr,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,Sr.mode=this.mode,this.dispatchEvent(Sr)}}pointerMove(e){const t=this.axis,i=this.mode,n=this.object;let o=this.space;if("scale"===i?o="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(o="world"),void 0===n||null===t||!1===this.dragging||-1!==e.button)return;Lr.setFromCamera(e,this.camera);const s=zr(this._plane,Lr,!0);if(s){if(this.pointEnd.copy(s.point).sub(this.worldPositionStart),"translate"===i)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===o&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===o&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),n.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===o&&(n.position.applyQuaternion(_r.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.position.applyQuaternion(this._quaternionStart)),"world"===o&&(n.parent&&n.position.add(xr.setFromMatrixPosition(n.parent.matrixWorld)),-1!==t.search("X")&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.parent&&n.position.sub(xr.setFromMatrixPosition(n.parent.matrixWorld))));else if("scale"===i){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(e*=-1),Mr.set(e,e,e)}else xr.copy(this.pointStart),Mr.copy(this.pointEnd),xr.applyQuaternion(this._worldQuaternionInv),Mr.applyQuaternion(this._worldQuaternionInv),Mr.divide(xr),-1===t.search("X")&&(Mr.x=1),-1===t.search("Y")&&(Mr.y=1),-1===t.search("Z")&&(Mr.z=1);n.scale.copy(this._scaleStart).multiply(Mr),this.scaleSnap&&(-1!==t.search("X")&&(n.scale.x=Math.round(n.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(n.scale.y=Math.round(n.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(n.scale.z=Math.round(n.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this._offset.copy(this.pointEnd).sub(this.pointStart);const e=20/this.worldPosition.distanceTo(xr.setFromMatrixPosition(this.camera.matrixWorld));let i=!1;"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(xr.copy(this.rotationAxis).cross(this.eye))*e):"X"!==t&&"Y"!==t&&"Z"!==t||(this.rotationAxis.copy(Fr[t]),xr.copy(Fr[t]),"local"===o&&xr.applyQuaternion(this.worldQuaternion),xr.cross(this.eye),0===xr.length()?i=!0:this.rotationAngle=this._offset.dot(xr.normalize())*e),("E"===t||i)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===o&&"E"!==t&&"XYZE"!==t?(n.quaternion.copy(this._quaternionStart),n.quaternion.multiply(_r.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),n.quaternion.copy(_r.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),n.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(Cr),this.dispatchEvent(Er)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(Ar.mode=this.mode,this.dispatchEvent(Ar)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse((function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}))}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(Cr),this.dispatchEvent(Er),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Lr}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function Ir(e){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};{const t=this.domElement.getBoundingClientRect();return{x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1,button:e.button}}}function Rr(e){if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(e));break}}function Vr(e){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(e)),this.pointerDown(this._getPointer(e)))}function Pr(e){this.enabled&&this.pointerMove(this._getPointer(e))}function Ur(e){this.enabled&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(e)))}function zr(e,t,i){const n=t.intersectObject(e,!0);for(let o=0;o<n.length;o++)if(n[o].object.visible||i)return n[o];return!1}const Hr=new X.Euler,Wr=new X.Vector3(0,1,0),Or=new X.Vector3(0,0,0),Dr=new X.Matrix4,Gr=new X.Quaternion,Nr=new X.Quaternion,Br=new X.Vector3,jr=new X.Matrix4,Xr=new X.Vector3(1,0,0),Yr=new X.Vector3(0,1,0),Qr=new X.Vector3(0,0,1),Kr=new X.Vector3,Zr=new X.Vector3,qr=new X.Vector3;class $r extends X.Object3D{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new X.MeshBasicMaterial({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new X.LineBasicMaterial({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;const n=t.clone();n.opacity=.5;const o=e.clone();o.color.setHex(16711680);const s=e.clone();s.color.setHex(65280);const a=e.clone();a.color.setHex(255);const r=e.clone();r.color.setHex(16711680),r.opacity=.5;const l=e.clone();l.color.setHex(65280),l.opacity=.5;const c=e.clone();c.color.setHex(255),c.opacity=.5;const d=e.clone();d.opacity=.25;const u=e.clone();u.color.setHex(16776960),u.opacity=.25;const p=e.clone();p.color.setHex(16776960);const h=e.clone();h.color.setHex(7895160);const m=new X.CylinderGeometry(0,.04,.1,12);m.translate(0,.05,0);const g=new X.BoxGeometry(.08,.08,.08);g.translate(0,.04,0);const f=new X.BufferGeometry;f.setAttribute("position",new X.Float32BufferAttribute([0,0,0,1,0,0],3));const y=new X.CylinderGeometry(.0075,.0075,.5,3);function b(e,t){const i=new X.TorusGeometry(e,.0075,3,64,t*Math.PI*2);return i.rotateY(Math.PI/2),i.rotateX(Math.PI/2),i}function v(){const e=new X.BufferGeometry;return e.setAttribute("position",new X.Float32BufferAttribute([0,0,0,1,1,1],3)),e}y.translate(0,.25,0);const k={X:[[new X.Mesh(m,o),[.5,0,0],[0,0,-Math.PI/2]],[new X.Mesh(m,o),[-.5,0,0],[0,0,Math.PI/2]],[new X.Mesh(y,o),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new X.Mesh(m,s),[0,.5,0]],[new X.Mesh(m,s),[0,-.5,0],[Math.PI,0,0]],[new X.Mesh(y,s)]],Z:[[new X.Mesh(m,a),[0,0,.5],[Math.PI/2,0,0]],[new X.Mesh(m,a),[0,0,-.5],[-Math.PI/2,0,0]],[new X.Mesh(y,a),null,[Math.PI/2,0,0]]],XYZ:[[new X.Mesh(new X.OctahedronGeometry(.1,0),d.clone()),[0,0,0]]],XY:[[new X.Mesh(new X.BoxGeometry(.15,.15,.01),c.clone()),[.15,.15,0]]],YZ:[[new X.Mesh(new X.BoxGeometry(.15,.15,.01),r.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new X.Mesh(new X.BoxGeometry(.15,.15,.01),l.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},w={X:[[new X.Mesh(new X.CylinderGeometry(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new X.Mesh(new X.CylinderGeometry(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new X.Mesh(new X.CylinderGeometry(.2,0,.6,4),i),[0,.3,0]],[new X.Mesh(new X.CylinderGeometry(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new X.Mesh(new X.CylinderGeometry(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new X.Mesh(new X.CylinderGeometry(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new X.Mesh(new X.OctahedronGeometry(.2,0),i)]],XY:[[new X.Mesh(new X.BoxGeometry(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new X.Mesh(new X.BoxGeometry(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new X.Mesh(new X.BoxGeometry(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},L={START:[[new X.Mesh(new X.OctahedronGeometry(.01,2),n),null,null,null,"helper"]],END:[[new X.Mesh(new X.OctahedronGeometry(.01,2),n),null,null,null,"helper"]],DELTA:[[new X.Line(v(),n),null,null,null,"helper"]],X:[[new X.Line(f,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new X.Line(f,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new X.Line(f,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},x={XYZE:[[new X.Mesh(b(.5,1),h),null,[0,Math.PI/2,0]]],X:[[new X.Mesh(b(.5,.5),o)]],Y:[[new X.Mesh(b(.5,.5),s),null,[0,0,-Math.PI/2]]],Z:[[new X.Mesh(b(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new X.Mesh(b(.75,1),u),null,[0,Math.PI/2,0]]]},M={AXIS:[[new X.Line(f,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},_={XYZE:[[new X.Mesh(new X.SphereGeometry(.25,10,8),i)]],X:[[new X.Mesh(new X.TorusGeometry(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new X.Mesh(new X.TorusGeometry(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new X.Mesh(new X.TorusGeometry(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new X.Mesh(new X.TorusGeometry(.75,.1,2,24),i)]]},F={X:[[new X.Mesh(g,o),[.5,0,0],[0,0,-Math.PI/2]],[new X.Mesh(y,o),[0,0,0],[0,0,-Math.PI/2]],[new X.Mesh(g,o),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new X.Mesh(g,s),[0,.5,0]],[new X.Mesh(y,s)],[new X.Mesh(g,s),[0,-.5,0],[0,0,Math.PI]]],Z:[[new X.Mesh(g,a),[0,0,.5],[Math.PI/2,0,0]],[new X.Mesh(y,a),[0,0,0],[Math.PI/2,0,0]],[new X.Mesh(g,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new X.Mesh(new X.BoxGeometry(.15,.15,.01),c),[.15,.15,0]]],YZ:[[new X.Mesh(new X.BoxGeometry(.15,.15,.01),r),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new X.Mesh(new X.BoxGeometry(.15,.15,.01),l),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new X.Mesh(new X.BoxGeometry(.1,.1,.1),d.clone())]]},C={X:[[new X.Mesh(new X.CylinderGeometry(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new X.Mesh(new X.CylinderGeometry(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new X.Mesh(new X.CylinderGeometry(.2,0,.6,4),i),[0,.3,0]],[new X.Mesh(new X.CylinderGeometry(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new X.Mesh(new X.CylinderGeometry(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new X.Mesh(new X.CylinderGeometry(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new X.Mesh(new X.BoxGeometry(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new X.Mesh(new X.BoxGeometry(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new X.Mesh(new X.BoxGeometry(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new X.Mesh(new X.BoxGeometry(.2,.2,.2),i),[0,0,0]]]},S={X:[[new X.Line(f,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new X.Line(f,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new X.Line(f,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function A(e){const t=new X.Object3D;for(const i in e)for(let n=e[i].length;n--;){const o=e[i][n][0].clone(),s=e[i][n][1],a=e[i][n][2],r=e[i][n][3],l=e[i][n][4];o.name=i,o.tag=l,s&&o.position.set(s[0],s[1],s[2]),a&&o.rotation.set(a[0],a[1],a[2]),r&&o.scale.set(r[0],r[1],r[2]),o.updateMatrix();const c=o.geometry.clone();c.applyMatrix4(o.matrix),o.geometry=c,o.renderOrder=1/0,o.position.set(0,0,0),o.rotation.set(0,0,0),o.scale.set(1,1,1),t.add(o)}return t}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo["translate"]=A(k)),this.add(this.gizmo["rotate"]=A(x)),this.add(this.gizmo["scale"]=A(F)),this.add(this.picker["translate"]=A(w)),this.add(this.picker["rotate"]=A(_)),this.add(this.picker["scale"]=A(C)),this.add(this.helper["translate"]=A(L)),this.add(this.helper["rotate"]=A(M)),this.add(this.helper["scale"]=A(S)),this.picker["translate"].visible=!1,this.picker["rotate"].visible=!1,this.picker["scale"].visible=!1}updateMatrixWorld(e){const t="scale"===this.mode?"local":this.space,i="local"===t?this.worldQuaternion:Nr;this.gizmo["translate"].visible="translate"===this.mode,this.gizmo["rotate"].visible="rotate"===this.mode,this.gizmo["scale"].visible="scale"===this.mode,this.helper["translate"].visible="translate"===this.mode,this.helper["rotate"].visible="rotate"===this.mode,this.helper["scale"].visible="scale"===this.mode;let n=[];n=n.concat(this.picker[this.mode].children),n=n.concat(this.gizmo[this.mode].children),n=n.concat(this.helper[this.mode].children);for(let o=0;o<n.length;o++){const e=n[o];let t;if(e.visible=!0,e.rotation.set(0,0,0),e.position.copy(this.worldPosition),t=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),e.scale.set(1,1,1).multiplyScalar(t*this.size/4),"helper"!==e.tag){if(e.quaternion.copy(i),"translate"===this.mode||"scale"===this.mode){const t=.99,n=.2;"X"===e.name&&Math.abs(Wr.copy(Xr).applyQuaternion(i).dot(this.eye))>t&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"Y"===e.name&&Math.abs(Wr.copy(Yr).applyQuaternion(i).dot(this.eye))>t&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"Z"===e.name&&Math.abs(Wr.copy(Qr).applyQuaternion(i).dot(this.eye))>t&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XY"===e.name&&Math.abs(Wr.copy(Qr).applyQuaternion(i).dot(this.eye))<n&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"YZ"===e.name&&Math.abs(Wr.copy(Xr).applyQuaternion(i).dot(this.eye))<n&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XZ"===e.name&&Math.abs(Wr.copy(Yr).applyQuaternion(i).dot(this.eye))<n&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1)}else"rotate"===this.mode&&(Gr.copy(i),Wr.copy(this.eye).applyQuaternion(_r.copy(i).invert()),-1!==e.name.search("E")&&e.quaternion.setFromRotationMatrix(Dr.lookAt(this.eye,Or,Yr)),"X"===e.name&&(_r.setFromAxisAngle(Xr,Math.atan2(-Wr.y,Wr.z)),_r.multiplyQuaternions(Gr,_r),e.quaternion.copy(_r)),"Y"===e.name&&(_r.setFromAxisAngle(Yr,Math.atan2(Wr.x,Wr.z)),_r.multiplyQuaternions(Gr,_r),e.quaternion.copy(_r)),"Z"===e.name&&(_r.setFromAxisAngle(Qr,Math.atan2(Wr.y,Wr.x)),_r.multiplyQuaternions(Gr,_r),e.quaternion.copy(_r)));e.visible=e.visible&&(-1===e.name.indexOf("X")||this.showX),e.visible=e.visible&&(-1===e.name.indexOf("Y")||this.showY),e.visible=e.visible&&(-1===e.name.indexOf("Z")||this.showZ),e.visible=e.visible&&(-1===e.name.indexOf("E")||this.showX&&this.showY&&this.showZ),e.material._color=e.material._color||e.material.color.clone(),e.material._opacity=e.material._opacity||e.material.opacity,e.material.color.copy(e.material._color),e.material.opacity=e.material._opacity,this.enabled&&this.axis&&(e.name===this.axis||this.axis.split("").some((function(t){return e.name===t})))&&(e.material.color.setHex(16776960),e.material.opacity=1)}else e.visible=!1,"AXIS"===e.name?(e.visible=!!this.axis,"X"===this.axis&&(_r.setFromEuler(Hr.set(0,0,0)),e.quaternion.copy(i).multiply(_r),Math.abs(Wr.copy(Xr).applyQuaternion(i).dot(this.eye))>.9&&(e.visible=!1)),"Y"===this.axis&&(_r.setFromEuler(Hr.set(0,0,Math.PI/2)),e.quaternion.copy(i).multiply(_r),Math.abs(Wr.copy(Yr).applyQuaternion(i).dot(this.eye))>.9&&(e.visible=!1)),"Z"===this.axis&&(_r.setFromEuler(Hr.set(0,Math.PI/2,0)),e.quaternion.copy(i).multiply(_r),Math.abs(Wr.copy(Qr).applyQuaternion(i).dot(this.eye))>.9&&(e.visible=!1)),"XYZE"===this.axis&&(_r.setFromEuler(Hr.set(0,Math.PI/2,0)),Wr.copy(this.rotationAxis),e.quaternion.setFromRotationMatrix(Dr.lookAt(Or,Wr,Yr)),e.quaternion.multiply(_r),e.visible=this.dragging),"E"===this.axis&&(e.visible=!1)):"START"===e.name?(e.position.copy(this.worldPositionStart),e.visible=this.dragging):"END"===e.name?(e.position.copy(this.worldPosition),e.visible=this.dragging):"DELTA"===e.name?(e.position.copy(this.worldPositionStart),e.quaternion.copy(this.worldQuaternionStart),xr.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),xr.applyQuaternion(this.worldQuaternionStart.clone().invert()),e.scale.copy(xr),e.visible=this.dragging):(e.quaternion.copy(i),this.dragging?e.position.copy(this.worldPositionStart):e.position.copy(this.worldPosition),this.axis&&(e.visible=-1!==this.axis.search(e.name)))}super.updateMatrixWorld(e)}}class Jr extends X.Mesh{constructor(){super(new X.PlaneGeometry(1e5,1e5,2,2),new X.MeshBasicMaterial({visible:!1,wireframe:!0,side:X.DoubleSide,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),Kr.copy(Xr).applyQuaternion("local"===t?this.worldQuaternion:Nr),Zr.copy(Yr).applyQuaternion("local"===t?this.worldQuaternion:Nr),qr.copy(Qr).applyQuaternion("local"===t?this.worldQuaternion:Nr),Wr.copy(Zr),this.mode){case"translate":case"scale":switch(this.axis){case"X":Wr.copy(this.eye).cross(Kr),Br.copy(Kr).cross(Wr);break;case"Y":Wr.copy(this.eye).cross(Zr),Br.copy(Zr).cross(Wr);break;case"Z":Wr.copy(this.eye).cross(qr),Br.copy(qr).cross(Wr);break;case"XY":Br.copy(qr);break;case"YZ":Br.copy(Kr);break;case"XZ":Wr.copy(qr),Br.copy(Zr);break;case"XYZ":case"E":Br.set(0,0,0);break}break;case"rotate":default:Br.set(0,0,0)}0===Br.length()?this.quaternion.copy(this.cameraQuaternion):(jr.lookAt(xr.set(0,0,0),Br,Wr),this.quaternion.setFromRotationMatrix(jr)),super.updateMatrixWorld(e)}}function el(e){const{glow:t,threshold:i,strength:n,radius:o,toneMappingExposure:s,color:a}=e;if(this.glowUnrealBloomPass=t,t){this.unrealBloomPass.threshold=i,this.unrealBloomPass.strength=n,this.unrealBloomPass.radius=o,this.renderer.toneMappingExposure=s,this.shaderPass.material.uniforms.glowColor.value=new X.Color(a);const e=this.effectComposer.passes||[],t=e.find((e=>"ShaderColor"==e.name))||{};t.name||this.effectComposer.addPass(this.shaderPass)}else this.unrealBloomPass.threshold=0,this.unrealBloomPass.strength=0,this.unrealBloomPass.radius=0,this.renderer.toneMappingExposure=s,this.shaderPass.material.uniforms.glowColor.value=new X.Color,this.glowComposer.renderer.clear(),this.glowComposer.renderer.dispose(),this.effectComposer.removePass(this.shaderPass)}function tl({decompose:e}){if(this.glowMaterialList.length<=1)return!1;const t=(e,t)=>{const i=new wr.Tween(e.position);i.to(t,500),i.onUpdate((function(t){e.position.set(t.x||0,t.y||0,t.z||0)})),i.start()},i=this.glowMaterialList.length,n=2*Math.PI/i;this.glowMaterialList.forEach(((i,o)=>{const s=this.model.getObjectByName(i),{decomposeName:a}=this.model;if("Mesh"==s.type)if(c.sf[a]&&c.sf[a][i]){const n={x:0,y:0,z:0},{x:o,y:r,z:l}=c.sf[a][i];"straight"==o?n.x+=e:"burden"==o&&(n.x-=e),"straight"==r?n.y+=e:"burden"==r&&(n.y-=e),"straight"==l?n.z+=e:"burden"==l&&(n.z-=e),t(s,n)}else{const i=o*n,a=e*Math.cos(i),r=e*Math.sin(i),l={x:a,y:r,z:0};t(s,l)}}))}function il({manageFlage:e}){e?(this.transformControls||(this.transformControls=new Tr(this.camera,this.renderer.domElement),this.transformControls.setMode("translate"),this.transformControls.addEventListener("dragging-changed",(e=>{this.controls.enabled=!e.value})),this.transformControls.size=1,this.scene.add(this.transformControls)),this.transformControls.attach()):this.transformControls&&(this.transformControls.detach(),this.transformControls.dispose(),this.scene.remove(this.transformControls),this.transformControls=null)}function nl(e){this.transformControls.setMode(e)}function ol(){const e=[];return this.modelMaterialList.forEach((t=>{const i=this.model.getObjectByProperty("name",t.name),{rotation:n,scale:o,position:s}=i,a={name:t.name,rotation:{x:n.x,y:n.y,z:n.z},scale:{x:o.x,y:o.y,z:o.z},position:{x:s.x,y:s.y,z:s.z}};e.push(a)})),e}function sl(e){this.shaderPass.material.uniforms.glowColor.value=new X.Color(e)}function al(){this.renderer.toneMappingExposure=2,Object.assign(this.unrealBloomPass,{threshold:0,strength:0,radius:0}),this.shaderPass.material.uniforms.glowColor.value=new X.Color,this.glowUnrealBloomPass=!1,this.glowComposer.renderer.clear(),this.glowComposer.renderer.dispose(),this.transformControls&&(this.transformControls.detach(),this.transformControls.dispose(),this.scene.remove(this.transformControls),this.transformControls=null),this.effectComposer.removePass(this.shaderPass),this.model.traverse((e=>{if(e.isMesh&&e.material){const{rotation:t,scale:i,position:n}=e.userData;e.rotation.set(t.x,t.y,t.z),e.scale.set(i.x,i.y,i.z),e.position.set(n.x,n.y,n.z)}}))}var rl={onSetUnrealBloomPass:el,setModelMeshDecompose:tl,setModelMeshDrag:il,getMeshDragPosition:ol,onSetFlowColor:sl,initStageFlow:al,setTransformControlsType:nl};function ll({ambientLight:e,ambientLightColor:t,ambientLightIntensity:i}){this.ambientLight.visible=e,this.ambientLight.intensity=i,this.ambientLight.color.set(t)}function cl(e){const{directionaShadow:t,directionalHorizontal:i,directionalVertical:n,directionalSistance:o,directionalLight:s,directionalLightColor:a,directionalLightIntensity:r,directionalLightHelper:l}=e;this.directionalLight.visible=s,this.directionalLightHelper.visible=l&&s,this.directionalLight.intensity=r,this.directionalLight.castShadow=t,this.directionalLight.color.set(a);const{x:c,y:d,z:p}=(0,u.Qp)(i,n,o);this.directionalLight.position.set(c,d,p),this.directionalLightHelper.update()}function dl(e){const{pointHorizontal:t,pointVertical:i,pointSistance:n,pointLight:o,pointLightColor:s,pointLightIntensity:a,pointLightHelper:r}=e;this.pointLight.visible=o,this.pointLightHelper.visible=o&&r,this.pointLight.intensity=a,this.pointLight.color.set(s);const{x:l,y:c,z:d}=(0,u.Qp)(t,i,n);this.pointLight.position.set(l,c,d),this.pointLightHelper.update()}function ul(e){const{spotDistance:t,spotCastShadow:i,spotLightHelper:n,spotFocus:o,spotPenumbra:s,spotAngle:a,spotLight:r,spotLightColor:l,spotLightIntensity:c,spotHorizontal:d,spotVertical:p,spotSistance:h}=e;this.spotLight.visible=r,this.spotLightHelper.visible=r&&n,this.spotLight.intensity=c,this.spotLight.angle=a,this.spotLight.penumbra=s,this.spotLight.shadow.focus=o,this.spotLight.castShadow=i,this.spotLight.distance=t,this.spotLight.color.set(l);const{x:m,y:g,z:f}=(0,u.Qp)(d,p,h);this.spotLight.position.set(m,g,f),this.spotLightHelper.update()}function pl({planeGeometry:e,planeColor:t,planeWidth:i,planeHeight:n}){this.planeGeometry.visible=e,this.planeGeometry.geometry=new X.PlaneGeometry(i,n),this.planeGeometry.material.color.set(t),this.planeGeometry.material.side=X.DoubleSide,this.planeGeometry.geometry.verticesNeedUpdate=!0}function hl({ambientLight:e}){const t={planeGeometry:!1,planeColor:"#939393",planeWidth:7,planeHeight:7,ambientLight:e,ambientLightColor:"#fff",ambientLightIntensity:.8,directionalLight:!1,directionalLightHelper:!0,directionalLightColor:"#1E90FF",directionalLightIntensity:1,directionalHorizontal:-1.26,directionalVertical:-3.85,directionalSistance:2.98,directionaShadow:!0,pointLight:!1,pointLightHelper:!0,pointLightColor:"#1E90FF",pointLightIntensity:1,pointHorizontal:-4.21,pointVertical:-4.1,pointSistance:2.53,spotLight:!1,spotLightColor:"#323636",spotLightIntensity:400,spotHorizontal:-3.49,spotVertical:-4.37,spotSistance:4.09,spotAngle:.5,spotPenumbra:1,spotFocus:1,spotCastShadow:!0,spotLightHelper:!0,spotDistance:20};this.onSetModelAmbientLight(t),this.onSetModelDirectionalLight(t),this.onSetModelPointLight(t),this.onSetModelSpotLight(t),this.onSetModelPlaneGeometry(t)}var ml={onSetModelAmbientLight:ll,onSetModelDirectionalLight:cl,onSetModelPointLight:dl,onSetModelSpotLight:ul,onSetModelPlaneGeometry:pl,onResettingLight:hl};function gl(e){this.onSetModelAnimaion(e),cancelAnimationFrame(this.animationFrame),this.animationFrameFun()}function fl({animationName:e,loop:t,timeScale:i,weight:n}){this.animationMixer=new X.AnimationMixer(this.model);const o=X.AnimationClip.findByName(this.modelAnimation,e);o&&(this.animateClipAction=this.animationMixer.clipAction(o),this.animateClipAction.setEffectiveTimeScale(i),this.animateClipAction.setEffectiveWeight(n),this.animateClipAction.setLoop(this.loopMap[t]),this.animateClipAction.play())}function yl(){this.animationFrame=requestAnimationFrame((()=>this.animationFrameFun())),this.animationMixer&&this.animationMixer.update(this.animationColock.getDelta())}function bl(){this.animateClipAction&&(this.animationMixer.stopAllAction(),this.animationMixer.update(0),cancelAnimationFrame(this.animationFrame))}function vl(e){const{rotationVisible:t,rotationType:i,rotationSpeed:n}=e;t?(cancelAnimationFrame(this.rotationAnimationFrame),this.rotationAnimationFun(i,n)):(cancelAnimationFrame(this.rotationAnimationFrame),this.model.rotation.set(0,0,0))}function kl(e){const{rotationType:t,rotationSpeed:i}=e;this.model.rotation.set(0,0,0),cancelAnimationFrame(this.rotationAnimationFrame),this.rotationAnimationFun(t,i)}function wl(e,t){this.rotationAnimationFrame=requestAnimationFrame((()=>this.rotationAnimationFun(e,t))),this.model.rotation[e]+=t/50}function Ll(e){this.modelAnimation=e.animations||[]}var xl={onStartModelAnimaion:gl,onSetModelAnimaion:fl,animationFrameFun:yl,onClearAnimation:bl,onSetRotation:vl,onSetRotationType:kl,rotationAnimationFun:wl,getModelAnimaionList:Ll};function Ml(e){this.skeletonHelper.visible=e}function _l(e,t){const i=Math.PI/2,{x:n,y:o,z:s}=this.model.rotation,a={x:n,y:o,z:s};a[e]+=t?i:-i;const r=new wr.Tween({x:n,y:o,z:s});r.to(a,500),r.onUpdate((t=>{this.model.rotation[e]=t[e]})),r.start()}function Fl(){this.model.rotation.x=0,this.model.rotation.y=0,this.model.rotation.z=0}function Cl({positionX:e,positionY:t,positionZ:i}){const n=new wr.Tween(this.model.position),o={x:e,y:t,z:i};n.to(o,500),n.onUpdate((e=>{this.model.position.set(e.x||0,e.y||0,e.z||0)})),n.start()}function Sl({positionX:e,positionY:t,positionZ:i}){this.model.position.set(e,t,i)}function Al(){this.camera.position.set(0,2,6),this.camera.lookAt(0,0,0)}function El(){return this.camera.position}function Tl({x:e,y:t,z:i,gridHelper:n,color:o}){this.gridHelper.visible=n,this.gridHelper.material.color.set(o);const s=new wr.Tween(this.gridHelper.position),a={x:e,y:t,z:i};s.to(a,500),s.onUpdate((e=>{this.gridHelper.position.set(e.x||0,e.y||0,e.z||0)})),s.start()}function Il({x:e,y:t,z:i,size:n,divisions:o,color:s,gridHelper:a}){this.scene.remove(this.gridHelper),this.gridHelper.geometry.dispose(),this.gridHelper.material.dispose(),this.gridHelper=new X.GridHelper(n,o,s,s),this.gridHelper.position.set(e,t,i),this.gridHelper.material.linewidth=.1,this.gridHelper.material.color.set(s),this.gridHelper.visible=a,this.scene.add(this.gridHelper)}function Rl({axesHelper:e,axesSize:t}){this.scene.remove(this.axesHelper),this.axesHelper.geometry.dispose(),this.axesHelper.material.dispose(),this.axesHelper=new X.AxesHelper(t),this.axesHelper.position.set(0,-.5,0),this.axesHelper.visible=e,this.scene.add(this.axesHelper)}var Vl={onSetModelHelper:Ml,onSetModelRotateOnAxis:_l,onResultModelRotateOnAxis:Fl,onSetModelPosition:Cl,onResultModelPosition:Sl,onResetModelCamera:Al,onGetModelCamera:El,onSetModelGridHelper:Tl,onSetModelGridHelperSize:Il,onSetModelAxesHelper:Rl};const Pl=l();function Ul(e){const t=this.scene.getObjectByProperty("uuid",e);this.modelMaterialList=this.modelMaterialList.filter((t=>t.uuid!=e)),this.glowMaterialList=this.modelMaterialList.map((e=>e.name)),t.clear(),this.geometryGroup.remove(t)}function zl(e,t){const i=Pl.selectMesh.uuid,n=this.scene.getObjectByProperty("uuid",i),o=Object.keys(e).map((t=>e[t])),s=new X[t](...o);n.geometry=s}var Hl={onDeleteGeometryMesh:Ul,onSetGeometryMesh:zl},Wl=i(813);function Ol(e){return"function"===typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,n.vv)(e)}function Dl(e){this.dragTag=e,this.dragTag.id=(0,u.Cn)(4,7)}function Gl(){const{clientHeight:e,clientWidth:t,offsetLeft:i,offsetTop:o}=this.container,{clientX:s,clientY:r,name:l}=this.dragTag;this.mouse.x=(s-i)/t*2-1,this.mouse.y=-(r-o)/e*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);const c=this.raycaster.intersectObjects(this.scene.children,!0);if(c.length>0){let e=document.createElement("div");const t="rgba(0,127,127,"+(.5*Math.random()+.25)+")",i=this.dragTagList.length+1,o=(0,a.Ef)({render(){let e;return(0,n.bF)("div",null,[(0,n.bF)("div",{className:"element-tag",style:{width:"60px",height:"40px",fontSize:"6px",color:"#ffffffbf",backgroundColor:t}},[(0,n.bF)("span",{className:"tag-txt"},[`标签-${i}`])]),(0,n.bF)("div",{className:"tag-icon"},[(0,n.bF)(Wl.tk,null,Ol(e=(0,n.h)(Nn[l]))?e:{default:()=>[e]})])])}}),s=o.mount(document.createElement("div"));e.appendChild(s.$el);let r=new Ra.on(e);const{x:d,y:u,z:p}=c[0].point;r.position.set(d,u,p),r.scale.set(.01,.01,.01);const{uuid:h,position:m,element:{innerHTML:g,innerText:f}}=r,y={uuid:h,positionX:m.x,positionY:m.y,positionZ:m.z,innerHTML:g,innerText:f,width:60,height:40,fontSize:6,backgroundColor:t,color:"#ffffffbf",iconColor:"#fff",iconSize:12,iconName:l,hover:!1};0==this.dragTagList.length&&this.container.appendChild(this.css3DRenderer.domElement),this.dragTagList.push(y),this.scene.add(r)}else p.nk.warning("当前角度无法获取鼠标位置请调整“相机角度”在添加")}function Nl(){if(0==this.dragTagList.length)return!1;this.dragTagList.forEach((e=>{const t=this.scene.getObjectByProperty("uuid",e.uuid);this.scene.remove(t);var i=t.element;i&&i.parentNode&&i.parentNode.removeChild(i)})),this.dragTagList=[],this.container.removeChild(this.css3DRenderer.domElement)}function Bl(e){const t=this.scene.getObjectByProperty("uuid",e);this.scene.remove(t);var i=t.element;if(i&&i.parentNode&&i.parentNode.removeChild(i),this.dragTagList=this.dragTagList.filter((t=>t.uuid!=e)),0==this.dragTagList.length)return this.container.removeChild(this.css3DRenderer.domElement),!1}function jl(e){const t=this.scene.getObjectByProperty("uuid",e.uuid);if(t){const i=t.element.querySelector(".element-tag"),n=t.element.querySelector(".tag-icon"),o=t.element.querySelector(".tag-txt"),{height:s,backgroundColor:a,width:r,fontSize:l,color:c,innerText:d,iconColor:u,iconSize:p,positionY:h,positionX:m,positionZ:g}=e;i.style.height=s+"px",i.style.backgroundColor=a,i.style.boxShadow=`0px 0px 4px ${a}`,i.style.width=r+"px",i.style.fontSize=l+"px",i.style.color=c,o.innerText=d,n.style.fontSize=p+"px",n.style.color=u;const f=new wr.Tween(t.position),y={x:m,y:h,z:g};f.to(y,500),f.onUpdate((e=>{t.position.set(e.x||0,e.y||0,e.z||0)})),f.start();const b=this.dragTagList.find((t=>t.uuid==e.uuid));Object.assign(b,e)}}var Xl={create3dTags:Gl,setDragTag:Dl,clearSceneTags:Nl,deleteTag:Bl,updateTagElement:jl},Yl={...Oa,...or,...rl,...ml,...xl,...Vl,...Hl,...Xl};class Ql{constructor(e){this.container=document.querySelector(e),this.camera,this.scene=null,this.renderer,this.controls,this.model,this.geometryGroup=new X.Group,this.geometryModel,this.loadingManager=new X.LoadingManager,this.fileLoaderMap={glb:new Ps.B,fbx:new Bs.w(this.loadingManager),gltf:new Ps.B,obj:new Ns.L(this.loadingManager),stl:new js.t},this.modelAnimation,this.animationMixer,this.animationColock=new X.Clock,this.animationFrame=null,this.rotationAnimationFrame=null,this.animateClipAction=null,this.loopMap={LoopOnce:X.LoopOnce,LoopRepeat:X.LoopRepeat,LoopPingPong:X.LoopPingPong},this.skeletonHelper,this.gridHelper,this.axesHelper,this.ambientLight,this.directionalLight,this.directionalLightHelper,this.pointLight,this.pointLightHelper,this.spotLight,this.spotLightHelper,this.planeGeometry,this.modelMaterialList=[],this.originalMaterials=new Map,this.effectComposer,this.outlinePass,this.renderAnimation=null,this.raycaster=new X.Raycaster,this.mouse=new X.Vector2,this.glowComposer,this.glowRenderPass,this.unrealBloomPass,this.shaderPass,this.glowMaterialList,this.materials={},this.transformControls,this.glowUnrealBloomPass=!1,this.onWindowResizesListener,this.onMouseClickListener,this.modelProgressCallback=e=>e,this.dragGeometryModel={},this.loadingStatus=!0,this.css3DRenderer=null,this.css3dControls=null,this.dragTag={},this.dragTagList=[]}init(){return new Promise((async(e,t)=>{this.initRender(),this.initCamera(),this.initScene(),this.initControls(),this.createHelper(),this.createLight(),this.addEvenListMouseLisatener();const i=await this.setModel({filePath:"threeFile/glb/glb-9.glb",fileType:"glb",decomposeName:"transformers_3"});this.createEffectComposer(),this.sceneAnimation(),e(i)}))}async initScene(){this.scene=new X.Scene;const e=(new X.TextureLoader).load(i(4518));e.mapping=X.EquirectangularReflectionMapping,this.scene.background=e,this.scene.environment=e,this.scene.backgroundIntensity=1,this.scene.backgroundBlurriness=1,e.dispose()}initCamera(){const{clientHeight:e,clientWidth:t}=this.container;this.camera=new X.PerspectiveCamera(50,t/e,1,2e3)}initRender(){this.renderer=new X.WebGLRenderer({antialias:!0,alpha:!0,preserveDrawingBuffer:!0}),this.renderer.setPixelRatio(window.devicePixelRatio);const{clientHeight:e,clientWidth:t}=this.container;this.renderer.setSize(t,e),this.renderer.toneMapping=X.ReinhardToneMapping,this.renderer.autoClear=!0,this.renderer.outputColorSpace=X.SRGBColorSpace,this.renderer.toneMappingExposure=2,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=X.PCFSoftShadowMap,this.container.appendChild(this.renderer.domElement),this.css3DRenderer=new Ra.a0,this.css3DRenderer.setSize(t,e),this.css3DRenderer.domElement.style.position="absolute",this.css3DRenderer.domElement.style.pointerEvents="none",this.css3DRenderer.domElement.style.top=0}sceneAnimation(){this.renderAnimation=requestAnimationFrame((()=>this.sceneAnimation())),this.loadingStatus&&(this.glowUnrealBloomPass?this.setMeshFlow():(this.effectComposer.render(),this.controls.update()),wr.update(),this.dragTagList.length&&(this.css3DRenderer.render(this.scene,this.camera),this.css3dControls.update()))}addEvenListMouseLisatener(){this.onWindowResizesListener=this.onWindowResizes.bind(this),window.addEventListener("resize",this.onWindowResizesListener),this.onMouseClickListener=this.onMouseClickModel.bind(this),this.container.addEventListener("click",this.onMouseClickListener)}initControls(){this.controls=new Vs.N(this.camera,this.renderer.domElement),this.controls.enablePan=!1,this.controls.enableDamping=!0,this.controls.target.set(0,0,0),this.controls.update(),this.css3dControls=new Vs.N(this.camera,this.css3DRenderer.domElement),this.css3dControls.enablePan=!1,this.css3dControls.enableDamping=!0,this.css3dControls.target.set(0,0,0),this.css3dControls.update()}setModel({filePath:e,fileType:t,decomposeName:i}){return new Promise(((n,o)=>{this.loadingStatus=!1;X.REVISION;let s;if(["glb","gltf"].includes(t)){const e=new Xs.Z;e.setDecoderPath("draco/gltf/"),e.setDecoderConfig({type:"js"}),e.preload(),s=(new Ps.B).setDRACOLoader(e)}else s=this.fileLoaderMap[t];s.load(e,(e=>{switch(t){case"glb":this.model=e.scene,this.skeletonHelper=new X.SkeletonHelper(e.scene);break;case"fbx":this.model=e,this.skeletonHelper=new X.SkeletonHelper(e);break;case"gltf":this.model=e.scene,this.skeletonHelper=new X.SkeletonHelper(e.scene);break;case"obj":this.model=e,this.skeletonHelper=new X.SkeletonHelper(e);break;case"stl":const t=new X.MeshStandardMaterial,i=new X.Mesh(e,t);this.model=i;break;default:break}this.model.decomposeName=i,this.getModelMeaterialList(),this.setModelPositionSize(),this.skeletonHelper.visible=!1,this.scene.add(this.skeletonHelper),this.glowMaterialList=this.modelMaterialList.map((e=>e.name)),this.scene.add(this.model),this.loadingStatus=!0,n(!0),this.getModelAnimaionList(e)}),(e=>{this.modelProgressCallback(e.loaded)}),(e=>{p.nk.error("文件错误"),console.log(e),n(!0)}))}))}setMeshFlow(){this.scene.traverse((e=>{e instanceof X.GridHelper&&(this.materials.gridHelper=e.material,e.material=new X.MeshStandardMaterial({color:"#000"})),e instanceof X.Scene&&(this.materials.scene=e.background,this.materials.environment=e.environment,e.background=null,e.environment=null),!this.glowMaterialList.includes(e.name)&&e.isMesh&&(this.materials[e.uuid]=e.material,e.material=new X.MeshStandardMaterial({color:"#000"}))})),this.glowComposer.render(),this.scene.traverse((e=>{this.materials[e.uuid]&&(e.material=this.materials[e.uuid],delete this.materials[e.uuid]),e instanceof X.GridHelper&&(e.material=this.materials.gridHelper,delete this.materials.gridHelper),e instanceof X.Scene&&(e.background=this.materials.scene,e.environment=this.materials.environment,delete this.materials.scene,delete this.materials.environment)})),this.effectComposer.render(),this.controls.update()}setGeometryModel(e){return new Promise(((t,i)=>{const{clientHeight:n,clientWidth:o,offsetLeft:s,offsetTop:a}=this.container;this.mouse.x=(e.clientX-s)/o*2-1,this.mouse.y=-(e.clientY-a)/n*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);const r=this.raycaster.intersectObjects(this.scene.children,!0);if(r.length>0){const{type:i}=e,n=["id","name","modelType","type"],o=Object.keys(e).filter((e=>!n.includes(e))).map((t=>e[t])),s=new X[i](...o),a=["#FF4500","#90EE90","#00CED1","#1E90FF","#C71585","#FF4500","#FAD400","#1F93FF","#90F090","#C71585"],l=a[Math.ceil(10*Math.random())],c=new X.MeshStandardMaterial({color:new X.Color(l),side:X.DoubleSide}),d=new X.Mesh(s,c),{x:p,y:h,z:m}=r[0].point;d.position.set(p,h,m);const g=d.clone();Object.assign(d.userData,{rotation:g.rotation,scale:g.scale,position:g.position}),d.name=i+"_"+(0,u.Cn)(4,5),d.userData.geometry=!0,this.geometryGroup.add(d),this.model=this.geometryGroup,this.onSetGeometryMeshList(d),this.skeletonHelper.visible=!1,this.skeletonHelper.dispose(),this.glowMaterialList=this.modelMaterialList.map((e=>e.name)),this.setModelMeshDrag({transformType:!0}),this.scene.add(this.model);const f=(new X.Box3).setFromObject(this.model),y=f.getSize(new X.Vector3);this.controls.maxDistance=10*y.length(),this.loadingStatus=!0,t(!0)}else p.nk.warning("当前角度无法获取鼠标位置请调整“相机角度”在添加")}))}onProgress(e){"function"==typeof e&&(this.modelProgressCallback=e)}createHelper(){this.gridHelper=new X.GridHelper(6,18,"#fff","rgb(193,193,193)"),this.gridHelper.position.set(0,-.59,-.1),this.gridHelper.visible=!1,this.scene.add(this.gridHelper),this.axesHelper=new X.AxesHelper(2),this.axesHelper.visible=!1,this.scene.add(this.axesHelper),this.renderer.shadowMap.enabled=!0}createLight(){this.ambientLight=new X.AmbientLight("#fff",.8),this.ambientLight.visible=!0,this.scene.add(this.ambientLight),this.directionalLight=new X.DirectionalLight("#fff",5),this.directionalLight.position.set(-1.44,2.2,1),this.directionalLight.castShadow=!0,this.directionalLight.visible=!1,this.scene.add(this.directionalLight),this.directionalLightHelper=new X.DirectionalLightHelper(this.directionalLight,.3),this.directionalLightHelper.visible=!1,this.scene.add(this.directionalLightHelper),this.pointLight=new X.PointLight(16711680,5,100),this.pointLight.visible=!1,this.scene.add(this.pointLight),this.pointLightHelper=new X.PointLightHelper(this.pointLight,.5),this.pointLightHelper.visible=!1,this.scene.add(this.pointLightHelper),this.spotLight=new X.SpotLight("#00BABD",900),this.spotLight.visible=!1,this.spotLight.map=(new X.TextureLoader).load(i(9997)),this.spotLight.decay=2,this.spotLight.shadow.mapSize.width=1920,this.spotLight.shadow.mapSize.height=1080,this.spotLight.shadow.camera.near=1,this.spotLight.shadow.camera.far=10,this.scene.add(this.spotLight),this.spotLightHelper=new X.SpotLightHelper(this.spotLight),this.spotLightHelper.visible=!1,this.scene.add(this.spotLightHelper);const e=new X.PlaneGeometry(4,4);var t=new X.MeshStandardMaterial({color:"#000000"});this.planeGeometry=new X.Mesh(e,t),this.planeGeometry.rotation.x=-Math.PI/2,this.planeGeometry.position.set(0,-1.2,0),this.planeGeometry.receiveShadow=!0,this.planeGeometry.visible=!1,this.scene.add(this.planeGeometry)}createEffectComposer(){if(!this.container)return!1;const{clientHeight:e,clientWidth:t}=this.container;this.effectComposer=new Us.s(this.renderer,new X.WebGLRenderTarget(t,e));const i=new zs.A(this.scene,this.camera);this.effectComposer.addPass(i),this.outlinePass=new Hs.G(new X.Vector2(t,e),this.model,this.camera),this.outlinePass.visibleEdgeColor=new X.Color("#FF8C00"),this.outlinePass.hiddenEdgeColor=new X.Color("#8a90f3"),this.outlinePass.edgeGlow=2,this.outlinePass.usePatternTexture=!1,this.outlinePass.edgeThickness=1,this.outlinePass.edgeStrength=4,this.outlinePass.pulsePeriod=200,this.effectComposer.addPass(this.outlinePass);let n=new Ws.X;this.effectComposer.addPass(n);let o=new Os.p(Ds.o);const s=this.renderer.getPixelRatio();o.uniforms.resolution.value.set(1/(t*s),1/(e*s)),o.renderToScreen=!0,o.needsSwap=!0,this.effectComposer.addPass(o),this.unrealBloomPass=new Gs.C(new X.Vector2(t,e),1.5,.4,.85);const a={minFilter:X.LinearFilter,format:X.RGBAFormat,stencilBuffer:!1},r=new X.WebGLRenderTarget(2*t,2*e,a);this.glowComposer=new Us.s(this.renderer,r),this.glowComposer.renderToScreen=!1,this.glowRenderPass=new zs.A(this.scene,this.camera),this.glowComposer.addPass(this.glowRenderPass),this.glowComposer.addPass(this.unrealBloomPass),this.shaderPass=new Os.p(new X.ShaderMaterial({uniforms:{baseTexture:{value:null},bloomTexture:{value:this.glowComposer.renderTarget2.texture},tDiffuse:{value:null},glowColor:{value:null}},vertexShader:c.U0,fragmentShader:c.SU,defines:{}}),"baseTexture"),this.shaderPass.material.uniforms.glowColor.value=new X.Color,this.shaderPass.renderToScreen=!0,this.shaderPass.needsSwap=!0,this.shaderPass.name="ShaderColor"}onSwitchModel(e){return new Promise((async(t,i)=>{try{if(e.modelType&&"geometry"==e.modelType){this.modelAnimation=[],this.camera.fov=80,this.camera.updateProjectionMatrix();await this.setGeometryModel(e);this.outlinePass.renderScene=this.geometryGroup,t()}else{this.clearSceneModel(),this.onResettingLight({ambientLight:!0}),this.camera.fov=50,this.geometryGroup.clear();const i=await this.setModel(e);this.outlinePass.renderScene=this.model,t({load:i,filePath:e.filePath})}}catch{i()}}))}onWindowResizes(){if(!this.container)return!1;const{clientHeight:e,clientWidth:t}=this.container;if(this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e),this.css3DRenderer.setSize(t,e),this.effectComposer){var i=this.effectComposer.passes[3];const n=this.renderer.getPixelRatio();i.uniforms.resolution.value.set(1/(t*n),1/(e*n)),this.effectComposer.setSize(t,e)}this.glowComposer&&this.glowComposer.setSize(t,e)}onDownloadScenCover(){var e=document.createElement("a"),t=this.renderer.domElement;e.href=t.toDataURL("image/png"),e.download=`${(new Date).toLocaleString()}.png`,e.click(),p.nk.success("下载成功")}onExporterModel(e){const t=new Js,i={trs:!0,animations:this.modelAnimation,binary:"glb"==e,embedImages:!0,onlyVisible:!0,includeCustomExtensions:!0};t.parse(this.scene,(function(e){function t(e,t){const i=new Blob([e],{type:"application/octet-stream"}),n=URL.createObjectURL(i),o=document.createElement("a");o.href=n,o.download=t,o.click(),URL.revokeObjectURL(n),p.nk.success("导出成功")}function i(e,t){const i=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(i),o=document.createElement("a");o.href=n,o.download=t,o.click(),URL.revokeObjectURL(n),p.nk.success("导出成功")}e instanceof ArrayBuffer?t(e,`${(new Date).toLocaleString()}.glb`):i(JSON.stringify(e),`${(new Date).toLocaleString()}.gltf`)}),(e=>{p.nk.error(e)}),i)}onClearModelData(){cancelAnimationFrame(this.rotationAnimationFrame),cancelAnimationFrame(this.renderAnimation),cancelAnimationFrame(this.animationFrame),this.container.removeEventListener("click",this.onMouseClickListener),window.removeEventListener("resize",this.onWindowResizesListener),this.scene.traverse((e=>{"Mesh"===e.type&&(e.geometry.dispose(),e.material.dispose())})),this.scene.clear(),this.renderer.dispose(),this.renderer.clear(),this.container=null,this.camera=null,this.scene=null,this.renderer=null,this.controls=null,this.model=null,this.geometryModel=null,this.fileLoaderMap=null,this.modelAnimation=null,this.animationMixer=null,this.animationColock=null,this.animationFrame=null,this.rotationAnimationFrame=null,this.animateClipAction=null,this.loopMap=null,this.skeletonHelper=null,this.gridHelper=null,this.axesHelper=null,this.ambientLight=null,this.directionalLight=null,this.directionalLightHelper=null,this.pointLight=null,this.pointLightHelper=null,this.spotLight=null,this.spotLightHelper=null,this.planeGeometry=null,this.modelMaterialList=[],this.originalMaterials.clear(),this.effectComposer=null,this.outlinePass=null,this.renderAnimation=null,this.raycaster=null,this.mouse=null,this.glowComposer&&(this.glowComposer.renderer.clear(),this.glowComposer.renderer.dispose()),this.glowComposer=null,this.unrealBloomPass=null,this.shaderPass=null,this.glowMaterialList=null,this.materials=null,this.transformControls=null,this.dragGeometryModel=null,this.glowUnrealBloomPass=!1}clearSceneModel(){this.scene.traverse((e=>{"Mesh"===e.type&&(e.geometry.dispose(),e.material.dispose())})),this.dragGeometryModel={},cancelAnimationFrame(this.animationFrame),cancelAnimationFrame(this.rotationAnimationFrame),this.scene.remove(this.model),this.model=null,this.glowUnrealBloomPass=!1,this.glowMaterialList=[],this.modelMaterialList=[],this.originalMaterials.clear(),this.materials={},this.transformControls&&(this.transformControls.detach(),this.transformControls.dispose(),this.scene.remove(this.transformControls),this.transformControls=null),this.glowComposer&&(this.glowComposer.renderer.clear(),this.glowComposer.renderer.dispose()),this.effectComposer&&this.effectComposer.removePass(this.shaderPass),this.renderer.toneMappingExposure=2,this.outlinePass.selectedObjects=[],Object.assign(this.unrealBloomPass,{threshold:0,strength:0,radius:0}),this.shaderPass.material.uniforms.glowColor.value=new X.Color,this.skeletonHelper.visible=!1;const e={gridHelper:!1,x:0,y:-.59,z:-.1,positionX:0,positionY:-1,positionZ:0,divisions:18,size:6,color:"rgb(193,193,193)",axesHelper:!1,axesSize:1.8};this.onResettingLight({ambientLight:!1}),this.onSetModelGridHelper(e),this.onSetModelGridHelperSize(e),this.onSetModelAxesHelper(e),this.clearSceneTags()}setDragGeometryModel(e){this.dragGeometryModel=e}}Object.assign(Ql.prototype,{...Yl});var Kl=Ql;const Zl=e=>((0,n.Qi)("data-v-29d11b18"),e=e(),(0,n.jt)(),e),ql={key:0,id:"loading-mark"},$l={class:"loading-box"},Jl={class:"loading"},ec=["src"],tc={class:"progress-txt"},ic=Zl((()=>(0,n.Lk)("div",{class:"loading-txt"}," 模型文件首次加载时间较长请耐心等待..... ",-1)));var nc={__name:"PageLoading",props:{percentage:{type:Number,default:0},loading:{type:Boolean,default:!1}},setup(e){const t=e;return(e,s)=>t.loading?((0,n.uX)(),(0,n.CE)("div",ql,[(0,n.Lk)("div",$l,[(0,n.Lk)("div",Jl,[(0,n.Lk)("img",{src:i(5860)},null,8,ec),(0,n.Lk)("div",tc,[(0,n.eW)(" 当前模型已加载 "),(0,n.Lk)("b",null,(0,o.v_)(t.percentage),1),(0,n.eW)(" M ")]),ic])])])):(0,n.Q3)("",!0)}};const oc=(0,N.A)(nc,[["__scopeId","data-v-29d11b18"]]);var sc=oc;const ac=e=>((0,n.Qi)("data-v-2e69c0f8"),e=e(),(0,n.jt)(),e),rc={class:"model-page"},lc={class:"model-header"},cc={class:"header-lf"},dc=ac((()=>(0,n.Lk)("span",null," 基于Three.js+Vue3+Element-Plus开发的3d模型可视化编辑系统 ",-1))),uc=ac((()=>(0,n.Lk)("span",null,"作者:answer ",-1))),pc={class:"header-lr"},hc={class:"model-container"},mc={class:"camera-icon"},gc=ac((()=>(0,n.Lk)("div",{id:"mesh-txt"},null,-1))),fc={class:"edit-panel",style:{minWidth:"380px"}};var yc={__name:"index",setup(e){const t=l(),i=(0,Is.rd)(),{$bus:r,$local:u}=(0,n.nI)().proxy,h=(0,s.KR)(!1),m=(0,s.KR)(0),g=(0,s.KR)(null),f=(0,s.KR)(null),y=(0,s.KR)(null),b=(0,s.KR)(!1),v=(0,n.EW)((()=>{if(g.value){const e=f.value.activeModel;return!!e?.filePath}return!1})),k=()=>{t.modelApi.onResetModelCamera()},w=()=>{const e=u.get(c.BR);if(!Array.isArray(e)){let e=[];d.u9.forEach((t=>{e.push({...c.lN,fileInfo:{...t}})})),u.set(c.BR,e)}},L=e=>{const{dragGeometryModel:i,dragTag:n}=t.modelApi,{clientX:o,clientY:s}=e;i.id&&"geometry"==t.dragType&&(i.clientX=o,i.clientY=s,t.modelApi.onSwitchModel(i)),n.id&&"tags"==t.dragType&&(n.clientX=o,n.clientY=s,t.modelApi.create3dTags(n))},x=()=>{const e=g.value.getPanelConfig();if(e.camera=t.modelApi.onGetModelCamera(),e.fileInfo=f.value.activeModel,e.fileInfo.filePath){u.set(c.F4,e);const{href:t}=i.resolve({path:"/preview"});window.open(t,"_blank")}else p.nk.warning("当前模型暂不支持“效果预览”")},M=()=>{const e=g.value.getPanelConfig();e.camera=t.modelApi.onGetModelCamera(),e.fileInfo=f.value.activeModel,y.value.showDialog(e)},_=()=>{const e=document.documentElement;b.value?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()},F=()=>{Rs.s.confirm(" 确认要更新当前模型数据至“模板库”?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"success"}).then((()=>{const e=g.value.getPanelConfig();if(e.camera=t.modelApi.onGetModelCamera(),e.fileInfo=f.value.activeModel,e.fileInfo.filePath){const t=u.get(c.BR)||[],{id:i}=e.fileInfo;Object.assign(t.filter((e=>i===e.fileInfo.id))[0],e),u.set(c.BR,t),p.nk.success("更新成功")}else p.nk.warning("当前模型暂不支持“数据保存”")})).catch((()=>{}))},C=()=>{t.modelApi.onDownloadScenCover()},S=e=>{t.modelApi.onExporterModel(e)},A=e=>{const t=document.fullscreenElement||document.webkitFullscreenElement;b.value=!!t};return(0,n.sV)((async()=>{h.value=!0;const e=new Kl("#model");t.setModelApi(e),r.on("page-loading",(e=>{h.value=e})),t.modelApi.onProgress((e=>{m.value=Number((e/1024/1024).toFixed(2))}));const i=await e.init();i&&(h.value=!1,m.value=0),w(),document.addEventListener("fullscreenchange",A)})),(0,n.xo)((()=>{t.modelApi.onClearModelData(),document.removeEventListener("fullscreenchange",A)})),(e,i)=>{const r=(0,n.g2)("el-button"),l=(0,n.g2)("el-icon"),c=(0,n.g2)("el-dropdown-item"),d=(0,n.g2)("el-dropdown-menu"),u=(0,n.g2)("el-dropdown"),p=(0,n.g2)("el-space"),w=(0,n.g2)("Aim"),A=(0,n.g2)("el-tooltip");return(0,n.uX)(),(0,n.CE)("div",rc,[(0,n.Lk)("header",lc,[(0,n.Lk)("div",cc,[dc,uc,(0,n.Lk)("span",null,"当前Three.js版本:"+(0,o.v_)(X.REVISION),1)]),(0,n.Lk)("div",pc,[(0,n.bF)(p,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,{type:"primary",icon:"Film",onClick:i[0]||(i[0]=t=>e.$router.push({path:"/modelBase"}))},{default:(0,n.k6)((()=>[(0,n.eW)(" 模型库 ")])),_:1}),v.value?((0,n.uX)(),(0,n.Wv)(r,{key:0,type:"primary",icon:"Document",onClick:F},{default:(0,n.k6)((()=>[(0,n.eW)("保存数据")])),_:1})):(0,n.Q3)("",!0),v.value?((0,n.uX)(),(0,n.Wv)(r,{key:1,type:"primary",icon:"View",onClick:x},{default:(0,n.k6)((()=>[(0,n.eW)("效果预览")])),_:1})):(0,n.Q3)("",!0),(0,n.bF)(u,{trigger:"click"},{dropdown:(0,n.k6)((()=>[(0,n.bF)(d,null,{default:(0,n.k6)((()=>[(0,n.bF)(c,{onClick:C},{default:(0,n.k6)((()=>[(0,n.eW)("下载封面")])),_:1}),(0,n.bF)(c,{onClick:i[1]||(i[1]=e=>S("glb"))},{default:(0,n.k6)((()=>[(0,n.eW)("导出模型(.glb)格式")])),_:1}),(0,n.bF)(c,{onClick:i[2]||(i[2]=e=>S("gltf"))},{default:(0,n.k6)((()=>[(0,n.eW)("导出模型(.gltf)格式")])),_:1})])),_:1})])),default:(0,n.k6)((()=>[(0,n.bF)(r,{type:"primary",icon:"Download"},{default:(0,n.k6)((()=>[(0,n.eW)(" 下载/导出"),(0,n.bF)(l,{class:"el-icon--right"})])),_:1})])),_:1}),v.value?((0,n.uX)(),(0,n.Wv)(r,{key:2,type:"primary",icon:"HelpFilled",onClick:M},{default:(0,n.k6)((()=>[(0,n.eW)(" 嵌入代码 ")])),_:1})):(0,n.Q3)("",!0),(0,n.bF)(r,{type:"primary",icon:"FullScreen",onClick:_},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(b.value?"取消全屏":"全屏"),1)])),_:1})])),_:1})])]),(0,n.Lk)("div",hc,[(0,n.bF)((0,s.R1)(Ms),{ref_key:"choosePanel",ref:f},null,512),(0,n.Lk)("div",{id:"model",onDrop:L,ref:"model",onDragover:i[3]||(i[3]=(0,a.D$)((()=>{}),["prevent"]))},[(0,n.Lk)("div",mc,[(0,n.bF)(A,{effect:"dark",content:"居中",placement:"top"},{default:(0,n.k6)((()=>[(0,n.bF)(l,{size:18,color:"#fff",onClick:k},{default:(0,n.k6)((()=>[(0,n.bF)(w)])),_:1})])),_:1})]),gc],544),(0,n.Lk)("div",fc,[(0,s.R1)(t).modelApi.model?((0,n.uX)(),(0,n.Wv)((0,s.R1)(Zo),{key:0,ref_key:"editPanel",ref:g},null,512)):(0,n.Q3)("",!0)])]),(0,n.bF)((0,s.R1)(sc),{loading:h.value,percentage:m.value},null,8,["loading","percentage"]),(0,n.bF)((0,s.R1)(Ts),{ref_key:"implatDialog",ref:y},null,512)])}}};const bc=(0,N.A)(yc,[["__scopeId","data-v-2e69c0f8"]]);var vc=bc}}]);